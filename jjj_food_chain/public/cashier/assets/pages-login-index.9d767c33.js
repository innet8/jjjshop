import{_ as a,H as e,a as l,M as s,c as t,o,f as u,g as i,h as n,i as d,t as r,u as c,W as p,X as f,Y as v,Z as _,B as m,j as g,a0 as h,r as y,w,a1 as b,a2 as x,a3 as k,a4 as V,s as C,$ as I,a5 as U,a6 as j,a7 as F,a8 as $,a9 as z,aa as L,O as R,ab as B,k as E,b as H,d as M}from"./index-ddc987dd.js";import{_ as O}from"./uni-data-select.36b7b7fb.js";const P=""+new URL("bg-93598f2d.png",import.meta.url).href,W=""+new URL("login_logo-83575c4a.svg",import.meta.url).href,X=a({__name:"set-language",setup(a){const h=e((()=>f[v()])),y=a=>{a&&a!==v()&&_(a)};return(a,e)=>{const f=l(t("uni-icons"),s),v=m,_=l(t("uni-data-select"),O),w=g;return o(),u(w,{class:"ti-language"},{default:i((()=>[n(f,{"custom-prefix":"iconfont",type:"icon-global",size:"16"}),n(v,{class:"ti-language-text"},{default:i((()=>[d(r(c(h)),1)])),_:1}),n(f,{type:"right",size:"16",style:{transform:"rotate(90deg)"}}),n(w,{class:"ti-language-select"},{default:i((()=>[n(_,{clear:!1,localdata:c(p)()||[],onChange:y},null,8,["localdata"])])),_:1})])),_:1})}}},[["__scopeId","data-v-6b3feecf"]]),Y=a({__name:"index",setup(a){const s=h(),p=y(!0),f=y(!1),v=y(!1),_=y({user_name:"",password:""}),m=e((()=>!_.value.user_name||!_.value.password)),O=y(!1),Y=y(!0),Z=y({ip:"",port:"",device_id:""});w((()=>Y.value),(()=>{Y.value&&q()})),b((()=>{q(),x({success:a=>{Z.value.device_id=a.deviceId}})}));const q=()=>{const a=k();Y.value=!(null==a?void 0:a.api_url),Z.value.ip=(null==a?void 0:a.ip)||V()||"127.0.0.1",Z.value.port=(null==a?void 0:a.port)||"8080"},A=async()=>{const a={...Z.value};if(!a.ip)return C({title:I("请输入地址"),icon:"none"});if(!a.port)return C({title:I("请输入端口"),icon:"none"});try{O.value=!0;await U(j(`${null==a?void 0:a.ip}:${a.port}`),a);C({title:I("绑定成功"),icon:"none"}),F(a)}catch(e){C({title:I("绑定失败"),icon:"none"})}finally{O.value=!1}},D=async()=>{if(!_.value.user_name)return C({title:I("請輸入賬號"),icon:"none"});if(!_.value.password)return C({title:I("输入登录密码"),icon:"none"});try{v.value=!0;const a=await $(_.value);a.data.token&&(z(a.data.token),s.setUserInfo(!0),L({url:"/pages/index/index"}))}catch(a){}finally{v.value=!1}},G=a=>{a&&(1==p.value&&(_.value.user_name+=a),1==f.value&&(_.value.password+=a))},J=a=>{p.value="username"===a,f.value="password"===a},K=()=>{1==p.value&&(_.value.user_name=""),1==f.value&&(_.value.password="")},N=()=>{Z.value={ip:"",port:""}},Q=()=>{Y.value=!Y.value};return(a,e)=>{const s=R,h=g,y=B,w=l(t("ti-button"),E),b=l(t("ti-input"),H),x=l(t("ti-keyboard"),M);return o(),u(h,{class:"ti-login"},{default:i((()=>[n(h,{class:"ti-login-img"},{default:i((()=>[n(s,{src:P,mode:"widthFix"})])),_:1}),n(h,{class:"ti-login-box"},{default:i((()=>[Y.value?(o(),u(h,{key:0,class:"ti-serve-box"},{default:i((()=>[n(h,{class:"ti-serve-head"},{default:i((()=>[n(h,{class:"ti-serve-logo"},{default:i((()=>[n(s,{src:W,mode:"widthFix"})])),_:1}),n(h,{class:"ti-serve-title"},{default:i((()=>[d(r(c(I)("收银机")),1)])),_:1})])),_:1}),n(h,{class:"ti-serve-label"},{default:i((()=>[d(r(c(I)("服務器連接地址")),1)])),_:1}),n(h,{class:"ti-serve-input"},{default:i((()=>[n(h,{class:"ti-serve-ip"},{default:i((()=>[n(y,{modelValue:Z.value.ip,"onUpdate:modelValue":e[0]||(e[0]=a=>Z.value.ip=a),type:"text",placeholder:c(I)("请输入地址")},null,8,["modelValue","placeholder"])])),_:1}),n(h,{class:"ti-serve-colon"},{default:i((()=>[d(":")])),_:1}),n(h,{class:"ti-serve-port"},{default:i((()=>[n(y,{modelValue:Z.value.port,"onUpdate:modelValue":e[1]||(e[1]=a=>Z.value.port=a),type:"number",placeholder:c(I)("请输入端口")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),n(h,{class:"ti-serve-btn"},{default:i((()=>[n(w,{onClick:N},{default:i((()=>[d(r(c(I)("重置")),1)])),_:1}),n(w,{loading:O.value,type:"primary",onClick:A},{default:i((()=>[d(r(c(I)("確定")),1)])),_:1},8,["loading"])])),_:1})])),_:1})):(o(),u(h,{key:1,class:"ti-login-form"},{default:i((()=>[n(h,{class:"ti-form-box"},{default:i((()=>[n(h,{class:"ti-form-head"},{default:i((()=>[n(h,{class:"ti-login-logo"},{default:i((()=>[n(s,{src:W,mode:"widthFix"})])),_:1}),n(h,{class:"ti-login-title"},{default:i((()=>[d(r(c(I)("收银机")),1)])),_:1})])),_:1}),n(h,{class:"ti-form-username"},{default:i((()=>[n(b,{modelValue:_.value.user_name,"onUpdate:modelValue":e[2]||(e[2]=a=>_.value.user_name=a),prefixIcon:"icon-user",placeholder:c(I)("請輸入用戶名"),focus:p.value,onClick:e[3]||(e[3]=a=>J("username"))},null,8,["modelValue","placeholder","focus"])])),_:1}),n(h,{class:"ti-form-password"},{default:i((()=>[n(b,{modelValue:_.value.password,"onUpdate:modelValue":e[4]||(e[4]=a=>_.value.password=a),prefixIcon:"icon-lock",placeholder:c(I)("請輸入登錄密碼"),focus:f.value,password:!0,onClick:e[5]||(e[5]=a=>J("password"))},null,8,["modelValue","placeholder","focus"])])),_:1}),n(h,{class:"ti-form-btn"},{default:i((()=>[n(w,{type:"primary",loading:v.value,disabled:c(m),onClick:D},{default:i((()=>[d(r(c(I)("登錄")),1)])),_:1},8,["loading","disabled"])])),_:1}),n(h,{class:"ti-form-link",onClick:Q},{default:i((()=>[d(r(c(I)("更换服务器")),1)])),_:1})])),_:1}),n(h,{class:"ti-form-keyboard"},{default:i((()=>[n(x,{isExit:!1,isPrimary:!1,onInput:G,onClear:K})])),_:1})])),_:1}))])),_:1}),n(h,{class:"ti-language-box"},{default:i((()=>[n(X)])),_:1})])),_:1})}}},[["__scopeId","data-v-605d66af"]]);export{Y as default};
