import{ak as e,_ as t,m as l,p as a,r as u,K as i,b as s,L as o,M as n,o as d,d as c,w as r,e as v,f as _,t as p,u as f,$ as m,y,j as h,J as b,N as g,O as w,P as k,Q as I,R as x,al as C,W as $,X as P,Z as L,i as D,a0 as N,a1 as U,a2 as S,am as V,S as O,T as j,U as B,V as T,an as K,c as H,a6 as M,a as z,a7 as A,a8 as Z,a9 as E,aa as F,n as R,ab as J,H as Q,ao as W,ae as X,af as q,ag as G,ah as Y,ai as ee,aj as te}from"./index-412ca643.js";import{f as le,a as ae,k as ue,m as ie,n as se,p as oe}from"./product.b59639e0.js";const ne=t({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const b=e,g=l(!1),w=l("");a((()=>b.show),(()=>{b.show&&(w.value="")}));const k=e=>{e&&(w.value+=e)},I=async()=>{var e;if(w.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{g.value=!0;const l=await le({order_product_id:null==(e=b.productItem)?void 0:e.order_product_id,price:w.value});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{g.value=!1}};return(l,a)=>{const y=h,x=u(s("ti-input"),i),C=u(s("ti-keyboard"),o),$=u(s("ti-modal"),n);return d(),c($,{show:b.show,title:f(m)("價格")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-modify-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-modify-input"},{default:r((()=>[v(x,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),placeholder:f(m)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(C,{primaryLoading:g.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:a[1]||(a[1]=e=>t("update:show",!1)),onClear:a[2]||(a[2]=e=>w.value=""),onInput:k,onConfirm:I},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-24206eab"]]),de=t({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const i=e,o=l(!1),w=l("");a((()=>i.show),(()=>{var e;i.show&&(w.value=(null==(e=i.productItem)?void 0:e.remark)||"")}));const k=async()=>{var e;if(!w.value)return y({title:m("请输入備註"),icon:"none"});try{o.value=!0;const l=await ae({order_product_id:null==(e=i.productItem)?void 0:e.order_product_id,remark:w.value.trim()});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{o.value=!1}};return(l,a)=>{const y=h,I=g,x=u(s("ti-button"),b),C=u(s("ti-modal"),n);return d(),c(C,{show:i.show,title:f(m)("備註")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-remark-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-remark-textarea"},{default:r((()=>[v(I,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:f(m)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),v(y,{class:"ti-remark-num"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(x,{onClick:a[1]||(a[1]=e=>t("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(x,{onClick:a[2]||(a[2]=e=>w.value="")},{default:r((()=>[_(p(f(m)("清空")),1)])),_:1}),v(x,{loading:o.value,type:"primary",onClick:k},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-500f020d"]]),ce=t({__name:"withdrawal",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(t,{emit:b}){const g=t,$=l(!1),P=l(""),L=l([m("等待時間長"),m("口味不好"),m("菜賣光了")]),D=l(0);a((()=>g.show),(()=>{var e;g.show&&(P.value=(null==(e=g.productItem)?void 0:e.total_num)||"")}));const N=e=>{e&&(P.value+=e)},U=async()=>{var t,l;if(P.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{$.value=!0;const a=await(l={table_id:C(),order_product_id:null==(t=g.productItem)?void 0:t.order_product_id,num:P.value,return_reason:L.value[D.value]},e("order.HallCart/moveProduct",l));1==a.code&&(y({title:a.msg,icon:"none"}),b("update:show",!1),b("success"))}catch(a){}finally{$.value=!1}};return(e,l)=>{const a=h,y=u(s("ti-input"),i),C=u(s("ti-keyboard"),o),S=u(s("ti-modal"),n);return d(),c(S,{show:g.show,title:f(m)("退菜")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-withdrawal-title text-ellipsis"},{default:r((()=>{var e,l,a;return[_(p((null==(e=t.productItem)?void 0:e.product_name_text)||(null==(a=null==(l=t.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(a,{class:"ti-withdrawal-list"},{default:r((()=>[(d(!0),w(k,null,I(L.value,((e,t)=>(d(),c(a,{key:t,class:x([{active:t==D.value},"ti-withdrawal-item"]),onClick:e=>(e=>{D.value=e})(t)},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(a,{class:"ti-withdrawal-input"},{default:r((()=>[v(y,{modelValue:P.value,"onUpdate:modelValue":l[0]||(l[0]=e=>P.value=e),placeholder:f(m)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(C,{primaryLoading:$.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[1]||(l[1]=e=>b("update:show",!1)),onClear:l[2]||(l[2]=e=>P.value=""),onInput:N,onConfirm:U},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-19115608"]]),re=t({__name:"preferential",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0}},emits:["update:show","success"],setup(t,{emit:g}){const V=t,O=l({type:1,money:"",rate:"",discountType:1}),j=l(!1);a((()=>V.show),(()=>{O.value={type:1,money:"",rate:"",discountType:1}})),a((()=>O.value.type),((e,t)=>{1==t?O.value.money="":2==t?O.value.rate="":3==t&&(O.value.discountType=1)}));const B=e=>{O.value.discountType=e.detail.value},T=()=>{1==O.value.type?O.value.money="":2==O.value.type&&(O.value.rate="")},K=e=>{e&&(1==O.value.type?O.value.money+=e:2==O.value.type&&(O.value.rate+=e))},H=async()=>{const t={...O.value,table_id:C()};if(!j.value){if(1==t.type){if(t.money<=0)return y({title:m("请输入實付價格"),icon:"none"})}else if(2==t.type&&t.rate<=0)return y({title:m("请输入優惠折扣"),icon:"none"});try{j.value=!0;const l=await function(t){return e("order.HallCart/changeMoney",t)}(t);y({title:l.msg,icon:"none"}),g("update:show",!1),g("success")}catch(l){}finally{j.value=!1}}};return(e,l)=>{const a=h,y=D,C=u(s("ti-input"),i),M=N,z=U,A=S,Z=u(s("ti-button"),b),E=u(s("ti-keyboard"),o),F=u(s("ti-modal"),n);return d(),c(F,{show:V.show,title:f(m)("優惠折扣")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-preferential-box"},{default:r((()=>[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("當前價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(y,{class:"ti-preferential-price"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1}),v(y,{class:"ti-preferential-subPrice"},{default:r((()=>[_(p(f(P)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠方式")),1)])),_:1}),v(a,{class:"ti-preferential-input ti-preferential-type"},{default:r((()=>[(d(!0),w(k,null,I([f(m)("改價"),f(m)("折扣"),f(m)("抹零")],((e,t)=>(d(),c(a,{key:t,class:x([{active:O.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>O.value.type=t+1},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==O.value.type?(d(),w(k,{key:0},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("實付價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(C,{modelValue:O.value.money,"onUpdate:modelValue":l[0]||(l[0]=e=>O.value.money=e),placeholder:f(m)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):L("",!0),2==O.value.type?(d(),w(k,{key:1},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(C,{modelValue:O.value.rate,"onUpdate:modelValue":l[1]||(l[1]=e=>O.value.rate=e),placeholder:f(m)("请输入優惠折扣"),focus:!0},{right:r((()=>[v(a,{class:"ti-preferential-percentage"},{default:r((()=>[_("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):L("",!0),3==O.value.type?(d(),w(k,{key:2},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("抹零方式")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(A,{class:"ti-type-radio",onChange:B},{default:r((()=>[v(z,null,{default:r((()=>[v(M,{value:"1",color:"#ffbe00",checked:"true"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹分")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"2",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"3",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"4",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到元")),1)])),_:1})])),_:1})])),_:1})])),_:1})],64)):L("",!0)])),_:1})])),_:1})])),footer:r((()=>[3==O.value.type?(d(),c(a,{key:0,class:"ti-dialog-btn"},{default:r((()=>[v(Z,{onClick:l[2]||(l[2]=e=>g("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(Z,{loading:j.value,type:"primary",onClick:H},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})):(d(),c(a,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:r((()=>[v(E,{primaryLoading:j.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[3]||(l[3]=e=>g("update:show",!1)),onClear:T,onInput:K,onConfirm:H},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},[["__scopeId","data-v-772bc286"]]),ve=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:C()},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),V(),setTimeout((()=>{a("success")}),100)}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=O,b=u(s("ti-modal"),n);return d(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.sendKitchen&&t.sendKitchen.length>0?(d(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(d(!0),w(k,null,I(i.sendKitchen,((e,t)=>(d(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(d(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-ad3b684a"]]);function _e(t){return e("store.table/table",t)}const pe=t({__name:"turntable",props:{show:{type:Boolean,default:!1},tableNo:{type:[Number,String],default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,n=l({table_status:"10"}),b=l(!1),g=l(!1),$=l([]),P=l(),L=l(!1);a((()=>o.show),(()=>{o.show&&(P.value=null,N())}));const D=async t=>{if(!L.value){if(!P.value)return y({title:m("请选择桌号"),icon:"none"});try{L.value=!0;const t=await(l={old_table_id:C(),new_table_id:P.value},e("order.order/changeTable",l));y({title:t.msg,icon:"none"}),i("update:show",!1),K(P.value),setTimeout((()=>{i("success")}),100)}catch(a){}finally{L.value=!1}var l}},N=()=>{n.value.page=1,S(!0)},U=()=>{b.value&&(n.value.page+=1,S())},S=async e=>{var t;if(!g.value)try{e&&(g.value=!0);const l=await _e(n.value);$.value=(null==(t=l.data)?void 0:t.list)||[]}catch(l){}finally{e&&(g.value=!1)}};return(e,t)=>{const l=u(s("ti-loading"),j),a=h,n=u(s("ti-empty-data"),B),y=O,C=u(s("ti-drawer"),T);return d(),c(C,{show:o.show,confirmLoading:L.value,title:`[${o.tableNo}]${f(m)("轉台")}`,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:D},{content:r((()=>[v(a,{class:"ti-turntable-box"},{default:r((()=>[v(y,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:U},{default:r((()=>[g.value?(d(),c(l,{key:0})):$.value&&$.value.length>0?(d(),w(k,{key:1},[v(a,{class:"ti-turntable-list"},{default:r((()=>[(d(!0),w(k,null,I($.value,(e=>(d(),c(a,{key:e.table_id,class:x([{active:P.value==e.table_id},"ti-turntable-item"]),onClick:t=>P.value=e.table_id},{default:r((()=>[_(p(e.table_no),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:b.value?"loading":"no-more"},null,8,["status"])],64)):(d(),c(n,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","confirmLoading","title"])}}},[["__scopeId","data-v-6a6a5b8e"]]),fe=t({__name:"open-table",props:{show:{type:Boolean,default:!1},tableNo:{type:String,default:null},tableId:{type:[Number,String],default:null},isUpdate:{type:Boolean,default:!1}},emits:["update:show","success"],setup(t,{emit:_}){const p=t,b=l(!1),g=l("");a((()=>p.show),(()=>{p.show&&(g.value="")}));const w=e=>{e&&(g.value+=e)},k=async()=>{if(g.value<=0)return y({title:m("請輸入人數"),icon:"none"});try{b.value=!0;const a=await(t={table_id:p.tableId,meal_num:g.value},l=p.isUpdate,e(l?"order.Order/updateMealNum":"order.Order/tableBuy",t));1==a.code&&(y({title:a.msg,icon:"none"}),K(p.tableId),_("update:show",!1),setTimeout((()=>{_("success")}),100))}catch(a){}finally{b.value=!1}var t,l};return(e,t)=>{const l=u(s("ti-input"),i),a=h,y=u(s("ti-keyboard"),o),I=u(s("ti-modal"),n);return d(),c(I,{show:p.show,title:`[${p.tableNo}]${f(m)("就餐人數")}`},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-modify-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:f(m)("請輸入人數"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(y,{primaryLoading:b.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:t[1]||(t[1]=e=>_("update:show",!1)),onClear:t[2]||(t[2]=e=>g.value=""),onInput:w,onConfirm:k},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-b18daf9d"]]),me=t({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},tableNo:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0}},emits:["success","change"],setup(t,{emit:a}){const i=t,o=H((()=>i.orderList&&i.orderList.length>0));H((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)>0))));const c=H((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)<=0)))),b=l(!1),g=l(!1),I=l(!1),x=l(!1),$=l(!1),P=l(!1),L=l(!1),N=l(!1),U=l(!1),S=l(!1),O=l(!1),j=()=>{V(),setTimeout((()=>{a("change")}),100)},B=async()=>{var t,l;if(!g.value)try{g.value=!0;const u=await(l={order_product_id:null==(t=i.productItem)?void 0:t.order_product_id},e("order.HallCart/delProduct",l));y({title:u.msg,icon:"none"}),a("success")}catch(u){}finally{b.value=!1,g.value=!1}},T=async()=>{var t;if(!x.value)try{x.value=!0;const l=await(t={table_id:C()},e("order.HallCart/sendKitchen",t));y({title:l.msg,icon:"none"}),a("success"),I.value=!1}catch(l){I.value=!1}finally{x.value=!1}};return(e,l)=>{const y=D,C=M,V=h,K=u(s("ti-modal"),n);return d(),w(k,null,[v(V,{class:"ti-action-box"},{default:r((()=>[v(V,{class:"ti-action-btn"},{default:r((()=>[v(V,{class:"ti-btn-box"},{default:r((()=>{var e,a,u;return[v(C,{class:"ti-btn-item",disabled:!1,onClick:j},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("返回")),1)])),_:1})])),_:1}),v(C,{class:"ti-btn-item danger",disabled:!(t.productItem&&0==(null==(e=t.productItem)?void 0:e.is_send_kitchen)),onClick:l[0]||(l[0]=e=>b.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("删除")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item",disabled:0!=(null==(a=t.productItem)?void 0:a.is_send_kitchen),onClick:l[1]||(l[1]=e=>L.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("备注")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item",disabled:!f(o),onClick:l[2]||(l[2]=e=>P.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("價格")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item",disabled:!1,onClick:l[3]||(l[3]=e=>S.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("人数")),1)])),_:1})])),_:1}),v(C,{class:"ti-btn-item",disabled:!1,onClick:l[4]||(l[4]=e=>O.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("转台")),1)])),_:1})])),_:1}),v(C,{class:"ti-btn-item",disabled:0==f(c).length,onClick:l[5]||(l[5]=e=>I.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("送廚")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item danger",disabled:!(t.productItem&&1==(null==(u=t.productItem)?void 0:u.is_send_kitchen)),onClick:l[6]||(l[6]=e=>N.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("退菜")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item danger",disabled:!f(o),onClick:l[7]||(l[7]=e=>$.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("清台")),1)])),_:1})])),_:1},8,["disabled"]),v(C,{class:"ti-btn-item",disabled:!f(o),onClick:l[8]||(l[8]=e=>U.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])]})),_:1})])),_:1})])),_:1}),v(K,{class:"ti-action-tips",show:b.value,"onUpdate:show":l[9]||(l[9]=e=>b.value=e),confirmLoading:g.value,title:f(m)("溫馨提示"),content:f(m)("是否删除此商品？"),onConfirm:B},null,8,["show","confirmLoading","title","content"]),v(K,{class:"ti-action-tips",show:I.value,"onUpdate:show":l[10]||(l[10]=e=>I.value=e),confirmLoading:x.value,title:f(m)("溫馨提示"),content:f(m)("是否将商品送廚？"),onConfirm:T},null,8,["show","confirmLoading","title","content"]),v(fe,{show:S.value,"onUpdate:show":l[11]||(l[11]=e=>S.value=e),isUpdate:!0,tableNo:i.tableNo,onSuccess:l[12]||(l[12]=e=>a("success"))},null,8,["show","tableNo"]),v(pe,{show:O.value,"onUpdate:show":l[13]||(l[13]=e=>O.value=e),tableNo:i.tableNo,onSuccess:l[14]||(l[14]=e=>a("success"))},null,8,["show","tableNo"]),v(ve,{show:$.value,"onUpdate:show":l[15]||(l[15]=e=>$.value=e),sendKitchen:i.sendKitchen,onSuccess:l[16]||(l[16]=e=>a("change"))},null,8,["show","sendKitchen"]),v(ne,{show:P.value,"onUpdate:show":l[17]||(l[17]=e=>P.value=e),productItem:i.productItem,onSuccess:l[18]||(l[18]=e=>a("success"))},null,8,["show","productItem"]),v(de,{show:L.value,"onUpdate:show":l[19]||(l[19]=e=>L.value=e),productItem:i.productItem,onSuccess:l[20]||(l[20]=e=>a("success"))},null,8,["show","productItem"]),v(ce,{show:N.value,"onUpdate:show":l[21]||(l[21]=e=>N.value=e),productItem:i.productItem,onSuccess:l[22]||(l[22]=e=>a("success"))},null,8,["show","productItem"]),v(re,{show:U.value,"onUpdate:show":l[23]||(l[23]=e=>U.value=e),productItem:i.productItem,totalPayPrice:t.totalPayPrice,onSuccess:l[24]||(l[24]=e=>a("success"))},null,8,["show","productItem","totalPayPrice"])],64)}}},[["__scopeId","data-v-f69c91e5"]]),ye=t({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const a=e,i=l(!1),o=async e=>{var l,u;const s={order_product_id:null==(l=a.productItem)?void 0:l.order_product_id,product_num:null==(u=a.productItem)?void 0:u.total_num,type:e};"up"==e?s.product_num+=1:s.product_num-=1;try{i.value=!0;1==(await ue(s)).code&&t("change")}catch(o){}finally{i.value=!1}};return(e,t)=>{const l=u(s("uni-icons"),z),n=M,f=h;return d(),c(f,{class:"ti-number-box",onClick:t[2]||(t[2]=A((()=>{}),["stop"]))},{default:r((()=>{var e,u,s,d,c,m;return[v(n,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=a.productItem)?void 0:e.total_num)<=1||i.value||(null==(u=a.productItem)?void 0:u.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>o("down"))},{default:r((()=>[v(l,{"custom-prefix":"iconfont",type:"icon-minus",size:"16"})])),_:1},8,["disabled"]),v(f,{class:"ti-number-input"},{default:r((()=>{var e;return[_(p((null==(e=a.productItem)?void 0:e.total_num)||1),1)]})),_:1}),v(n,{class:"ti-number-btn ti-number-plus",disabled:(null==(s=a.productItem)?void 0:s.total_num)>=(null==(c=null==(d=a.productItem)?void 0:d.product)?void 0:c.product_stock)||i.value||(null==(m=a.productItem)?void 0:m.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>o("up"))},{default:r((()=>[v(l,{type:"plusempty",size:"16"})])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-cdd7204f"]]);const he=t({__name:"member",props:{show:{type:Boolean,default:!1}},emits:["update:show","change"],setup(e,{emit:t}){const m=e,y=l(!1),g=l(""),w=l({}),k=l(!1);a((()=>m.show),(()=>{m.show&&(g.value="",w.value={})}));const I=()=>{t("update:show",!1),t("change",null)},x=e=>{e&&(g.value+=e)},N=async()=>{try{y.value=!0;const e=await Z({mobile:g.value,table_id:C()});w.value={...e.data.user,total_pay_price:e.data.total_pay_price}}catch(e){}finally{y.value=!1}},U=async()=>{var e;try{k.value=!0;await E({table_id:C(),user_id:(null==(e=w.value)?void 0:e.user_id)||0});t("update:show",!1),t("change",w.value)}catch(l){}finally{k.value=!1}};return(e,t)=>{const l=u(s("ti-input"),i),a=u(s("ti-button"),b),C=h,S=D,V=u(s("ti-keyboard"),o),O=u(s("ti-modal"),n);return d(),c(O,{show:m.show,title:e.$t("会员")},{content:r((()=>[v(C,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(C,{class:"ti-payment-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:e.$t("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),v(a,{loading:y.value,type:"primary",onClick:N},{default:r((()=>[_(p(e.$t("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(u=w.value)?void 0:u.user_id)?(d(),c(C,{key:0,class:"ti-payment-member"},{default:r((()=>[v(C,{class:"ti-member-list"},{default:r((()=>[v(C,{class:"ti-member-item"},{default:r((()=>[v(C,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(C,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=w.value)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(C,{class:"ti-member-item"},{default:r((()=>[v(C,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(C,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=w.value)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=w.value)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(C,{class:"ti-member-item"},{default:r((()=>[v(C,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(C,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(C,{class:"ti-member-item"},{default:r((()=>[v(C,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(C,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),v(C,{class:"ti-member-discount"},{default:r((()=>[v(S,{class:"ti-discount-title"},{default:r((()=>[_(p(e.$t("會員折扣應收金額")),1)])),_:1}),v(S,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=w.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(S,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=w.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):L("",!0)]})),_:1})])),footer:r((()=>[v(C,{class:"ti-dialog-btn"},{default:r((()=>[v(V,{primaryLoading:k.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:I,onClear:t[1]||(t[1]=e=>g.value=""),onInput:x,onConfirm:U},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-f6b3742b"]]),be=t({__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show","success","change"],setup(t,{emit:i}){const o=t,m=l(!1);l({});const g=l([]),O=l({delivery:40,pay_type:"40",user_id:null,table_id:null}),j=l(!1),T=l(!1);a((()=>o.show),(()=>{o.show&&(g.value=[],O.value.pay_type="40")})),a((()=>O.value.pay_type),(()=>{o.show&&(O.value.pay_type>0||(g.value&&g.value.length>0?O.value.pay_type=g.value[0].value:F().then((e=>{g.value=e.data||[],O.value.pay_type=g.value[0].value}))))}));const K=async()=>{try{await E({table_id:C(),user_id:0});i("success")}catch(e){}},H=e=>{O.value.pay_type=e.detail.value},M=async()=>{if(!T.value)try{T.value=!0;const e=await J({order_id:o.orderId});y({title:e.msg,icon:"none"})}catch(e){}finally{T.value=!1}},z=async()=>{var t;if(j.value)return;const l={...O.value};l.table_id=C(),l.user_id=null==(t=o.memberDetail)?void 0:t.user_id;try{j.value=!0;const t=await function(t){return e("order.order/pay",t)}(l);y({title:t.msg,icon:"none"}),i("update:show",!1),V(),setTimeout((()=>{i("change")}),100)}catch(a){}finally{j.value=!1}};return(e,l)=>{const a=D,y=h,C=N,V=U,A=S,Z=Q,E=u(s("ti-empty-data"),B),F=u(s("ti-button"),b),J=u(s("ti-modal"),n);return d(),c(J,{show:o.show,title:e.$t("結賬")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(y,{class:"ti-payment-money"},{default:r((()=>[v(a,{class:"ti-payment-label"},{default:r((()=>[_(p(e.$t("應收金額")),1)])),_:1}),v(a,{class:"ti-payment-price"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1}),v(a,{class:"ti-payment-subPrice"},{default:r((()=>[_(p(f(P)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(y,{class:"ti-payment-type"},{default:r((()=>[v(y,{class:"ti-type-label"},{default:r((()=>[_(p(e.$t("收款方式")),1)])),_:1}),v(A,{class:"ti-type-radio",onChange:H},{default:r((()=>[v(V,null,{default:r((()=>[v(C,{value:"40",color:"#ffbe00",checked:"true"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("現金")),1)])),_:1})])),_:1}),v(V,null,{default:r((()=>[v(C,{value:"10",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1})])),_:1}),v(V,null,{default:r((()=>[v(C,{value:"",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("其他方式")),1)])),_:1})])),_:1})])),_:1})])),_:1}),"40"!=O.value.pay_type&&"10"!=O.value.pay_type?(d(),c(y,{key:0,class:"ti-payment-other"},{default:r((()=>[v(y,{class:"ti-other-title"},{default:r((()=>[_(p(e.$t("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),g.value&&g.value.length>0?(d(),c(y,{key:0,class:"ti-other-list"},{default:r((()=>[(d(!0),w(k,null,I(g.value,(e=>(d(),c(y,{key:e.value,class:x([{active:e.value==O.value.pay_type},"ti-other-item"]),onClick:t=>O.value.pay_type=e.value},{default:r((()=>[v(y,{class:"ti-other-image"},{default:r((()=>{var t;return[v(Z,{src:`${(null==(t=f(R)())?void 0:t.api_url)||""}/${e.img}`,mode:"widthFix"},null,8,["src"])]})),_:2},1024),v(y,{class:"ti-other-text"},{default:r((()=>[_(p(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(d(),c(E,{key:1}))])),_:1})):L("",!0),(null==(u=o.memberDetail)?void 0:u.user_id)?(d(),c(y,{key:1,class:"ti-payment-member"},{default:r((()=>[v(y,{class:"ti-payment-top"},{default:r((()=>[v(y,{class:"ti-payment-top-name"},{default:r((()=>[_(p(e.$t("會員")),1)])),_:1}),v(y,{class:"ti-payment-top-discomfort",onClick:K},{default:r((()=>[_(p(e.$t("不使用此會員")),1)])),_:1})])),_:1}),v(y,{class:"ti-member-list"},{default:r((()=>[v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=o.memberDetail)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=o.memberDetail)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=o.memberDetail)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=o.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=o.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1})])),_:1})):L("",!0),v(he,{show:m.value,"onUpdate:show":l[0]||(l[0]=e=>m.value=e),onChange:l[1]||(l[1]=e=>i("success"))},null,8,["show"])]})),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(F,{onClick:l[2]||(l[2]=e=>i("update:show",!1))},{default:r((()=>[_(p(e.$t("退出")),1)])),_:1}),v(F,{loading:T.value,onClick:M},{default:r((()=>[_(p(e.$t("打印")),1)])),_:1},8,["loading"]),v(F,{onClick:l[3]||(l[3]=e=>m.value=!0)},{default:r((()=>[_(p(e.$t("会员")),1)])),_:1}),v(F,{loading:j.value,type:"primary",onClick:z},{default:r((()=>[_(p(e.$t("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-511df4e9"]]),ge=t({__name:"time-meter",props:{tableDetail:{type:Object,default:()=>({})}},setup(e){const t=e,u=l(),i=l(),s=l(`00 ${m("分钟")} 00 ${m("秒")}`);a((()=>{var e;return null==(e=t.tableDetail)?void 0:e.elapsed_time}),(()=>{var e;i.value=null==(e=t.tableDetail)?void 0:e.elapsed_time,i.value>0&&(u.value&&clearInterval(u.value),u.value=setInterval((()=>{i.value++,o(i.value)}),1e3))}),{deep:!0}),W((()=>{u.value&&clearInterval(u.value)}));const o=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";t>0&&(u+=`${n(t)} ${m("小时")} `),u+=`${n(l)} ${m("分钟")} ${n(a)} ${m("秒")}`,s.value=u},n=e=>e<10?`0${e}`:e;return(e,l)=>{const a=h;return d(),c(a,{class:"ti-table-info"},{default:r((()=>[v(a,{class:"ti-table-num"},{default:r((()=>{var e,l;return[_(p(`${(null==(e=t.tableDetail)?void 0:e.table_no)||""} (${(null==(l=t.tableDetail)?void 0:l.meal_num)||0})`),1)]})),_:1}),v(a,{class:"ti-table-time"},{default:r((()=>[_(p(f(m)("已就餐："))+p(s.value),1)])),_:1})])),_:1})}}},[["__scopeId","data-v-72effccd"]]),we=t({__name:"cart-list",emits:["change"],setup(t,{expose:a,emit:i}){const o=l(),n=l(!1),y=l(!1),b=l({}),g=l({}),N=l(),U=l([]),S=l({table_no:"",meal_num:"",elapsed_time:""}),V=()=>{n.value=!0},T=async t=>{var l,a,u,i,s,n,d,c,r,v,_,p,f,m,h,w,k,I;try{t&&(y.value=!0);const x=await(I={table_id:C()},e("order.HallCart/tableProductList",I,{isLoading:!1}));if(N.value=x.data.order_id,S.value={table_no:null==(u=null==(a=null==(l=x.data)?void 0:l.allProductInfo)?void 0:a.orderInfo)?void 0:u.table_no,meal_num:null==(n=null==(s=null==(i=x.data)?void 0:i.allProductInfo)?void 0:s.orderInfo)?void 0:n.meal_num,elapsed_time:null==(r=null==(c=null==(d=x.data)?void 0:d.allProductInfo)?void 0:c.orderInfo)?void 0:r.elapsed_time},g.value=null==(_=null==(v=x.data)?void 0:v.allProductInfo)?void 0:_.sumInfo,U.value=(null==(m=null==(f=null==(p=x.data)?void 0:p.allProductInfo)?void 0:f.orderInfo)?void 0:m.product)||[],U.value&&U.value.length>0){let e=0;(null==(h=b.value)?void 0:h.order_product_id)&&(e=U.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=b.value)?void 0:t.order_product_id)}))),b.value=U.value[Math.max(e,0)],o.value=null==(k=null==(w=x.data)?void 0:w.allProductInfo)?void 0:k.userInfo}else b.value=null,o.value=null}catch(x){}finally{t&&(y.value=!1)}};return T(!0),a({getCartData:T}),(e,t)=>{var l,a;const C=h,K=u(s("ti-loading"),j),H=D,z=u(s("ti-empty-data"),B),A=O,Z=M;return d(),w(k,null,[v(C,{class:"ti-cart-box"},{default:r((()=>[v(ge,{tableDetail:S.value},null,8,["tableDetail"]),v(C,{class:"ti-cart-list"},{default:r((()=>[v(C,{class:"ti-cart-shop-head"},{default:r((()=>[v(C,{class:"ti-shop-head-title"},{default:r((()=>[_(p(f(m)("商品名稱")),1)])),_:1}),v(C,{class:"ti-shop-head-money"},{default:r((()=>[_(p(f(m)("金額")),1)])),_:1}),v(C,{class:"ti-shop-head-num"},{default:r((()=>[_(p(f(m)("數量")),1)])),_:1})])),_:1}),v(C,{class:"ti-shop-list"},{default:r((()=>[v(A,{"scroll-y":""},{default:r((()=>[y.value?(d(),c(K,{key:0})):U.value&&U.value.length>0?(d(),c(C,{key:1,class:"ti-shop-box"},{default:r((()=>[(d(!0),w(k,null,I(U.value,(e=>{var l;return d(),c(C,{key:e,class:x([{active:(null==(l=b.value)?void 0:l.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:t=>(e=>{var t;(null==(t=b.value)?void 0:t.order_product_id)!=(null==e?void 0:e.order_product_id)&&(b.value=e)})(e)},{default:r((()=>[v(C,{class:"ti-shop-item-box"},{default:r((()=>[v(C,{class:"ti-shop-box"},{default:r((()=>[v(C,{class:"ti-shop-body-top"},{default:r((()=>[v(C,{class:"ti-shop-title text-ellipsis"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),e.product_attr?(d(),c(C,{key:0,class:"ti-shop-spec"},{default:r((()=>[_("( "+p(e.product_attr)+" )",1)])),_:2},1024)):L("",!0)])),_:2},1024),v(C,{class:"ti-shop-body-money"},{default:r((()=>[v(H,{class:"ti-shop-price"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(H,{class:"ti-shop-subPrice"},{default:r((()=>[_(p(f(P)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),v(ye,{productItem:e,onChange:t[0]||(t[0]=e=>T())},null,8,["productItem"])])),_:2},1024),e.remark?(d(),c(C,{key:0,class:"ti-shop-remark"},{default:r((()=>[_(p(e.remark),1)])),_:2},1024)):L("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(d(),c(z,{key:2}))])),_:1})])),_:1})])),_:1}),v(C,{class:"ti-cart-statistics"},{default:r((()=>[v(C,{class:"ti-cart-total"},{default:r((()=>[v(H,{class:"ti-total-text"},{default:r((()=>[_(p(f(m)("小計:")),1)])),_:1}),v(H,{class:"ti-total-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.subtotal)||0)),1)]})),_:1}),v(H,{class:"ti-total-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=g.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),v(C,{class:"ti-cart-discount"},{default:r((()=>[v(C,{class:"ti-discount-item"},{default:r((()=>[v(C,null,{default:r((()=>[v(H,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("服務費:")),1)])),_:1}),v(H,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.service_money)||0)),1)]})),_:1}),v(H,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=g.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),v(C,null,{default:r((()=>{var e;return[v(H,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("優惠折扣:")),1)])),_:1}),v(H,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=g.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),f(P)((null==(e=g.value)?void 0:e.special_discount)||0)?(d(),c(H,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f(P)((null==(e=g.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):L("",!0)]})),_:1})])),_:1}),v(C,{class:"ti-discount-item"},{default:r((()=>[v(C,null,{default:r((()=>[v(H,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("消費稅:")),1)])),_:1}),v(H,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),v(H,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=g.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),v(C,null,{default:r((()=>{var e;return[v(H,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("會員折扣:")),1)])),_:1}),v(H,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),f(P)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)?(d(),c(H,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f(P)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):L("",!0)]})),_:1})])),_:1})])),_:1}),v(C,{class:"ti-cart-settlement"},{default:r((()=>[v(C,{class:"ti-settlement-total"},{default:r((()=>[v(H,{class:"ti-settlement-text"},{default:r((()=>[_(p(f(m)("應收：")),1)])),_:1}),v(H,{class:"ti-settlement-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(H,{class:"ti-settlement-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=g.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),v(Z,{class:"ti-settlement-btn",disabled:U.value.length<=0,onClick:V},{default:r((()=>[v(H,null,{default:r((()=>[_(p(f(m)("結賬")),1)])),_:1}),U.value.length>0?(d(),c(H,{key:0,class:"ti-settlement-badge"},{default:r((()=>[_(p(U.value.length),1)])),_:1})):L("",!0)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),v(me,{productItem:b.value,totalPayPrice:null==(l=g.value)?void 0:l.total_pay_price,tableNo:S.value.table_no,orderList:U.value,onChange:t[1]||(t[1]=e=>i("change")),onSuccess:t[2]||(t[2]=e=>T())},null,8,["productItem","totalPayPrice","tableNo","orderList"]),v(be,{show:n.value,"onUpdate:show":t[3]||(t[3]=e=>n.value=e),totalPayPrice:null==(a=g.value)?void 0:a.total_pay_price,orderId:N.value,memberDetail:o.value,onChange:t[4]||(t[4]=e=>i("change")),onSuccess:t[5]||(t[5]=e=>T())},null,8,["show","totalPayPrice","orderId","memberDetail"])],64)}}},[["__scopeId","data-v-f5fa9f15"]]),ke=t({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(e,{emit:t}){const u=e,i=l(0),s=l(0),o=l([]);a((()=>u.list),(async e=>{if(await X(),!e||0==e.length)return;const t=q().in(this);if(e.map(((e,l)=>{t.select(`#scroll-item-${l}`).boundingClientRect((e=>{if(!e)return;const t=o.value;t[l]=e.width+10,o.value=t})).exec()})),u.menuId>0){const e=u.list.findIndex((e=>e.category_id==u.menuId));e>-1&&n(e)}}),{deep:!0,immediate:!0});const n=e=>{s.value=e,i.value=o.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(o.value[e]+100),t("update:menuId",u.list[e].category_id)};return(e,t)=>{const l=D,a=h,o=O;return d(),c(o,{class:"ti-dish-menu","scroll-left":i.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:r((()=>[v(a,{class:"ti-menu-content"},{default:r((()=>[(d(!0),w(k,null,I(u.list,((e,t)=>(d(),c(a,{key:t,class:x(["ti-menu-item",{active:t==s.value}]),id:`scroll-item-${t}`,onClick:e=>n(t)},{default:r((()=>[v(l,{class:"ti-menu-title"},{default:r((()=>[_(p(e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-384c1800"]]),Ie=t({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId"],setup(e,{emit:t}){const u=l([]),i=l(0),s=l(0),o=H((()=>{let e=(u.value.find((e=>e.category_id==i.value))||{}).child||[];return e&&e.length>0&&(e=[{name_text:m("全部"),category_id:0}].concat(e)),e}));a((()=>i.value),(()=>{t("update:categoryId",i.value),o&&o.length>0&&(s.value=o.value[0].category_id)}));return(async()=>{try{const e=await ie();e.data.list&&(u.value=[{name_text:m("全部"),category_id:0}].concat(e.data.list),i.value=u.value[0].category_id)}catch(e){}})(),(e,l)=>{const a=h;return d(),c(a,{class:"ti-category-box"},{default:r((()=>[v(ke,{list:u.value,menuId:i.value,"onUpdate:menuId":l[0]||(l[0]=e=>i.value=e)},null,8,["list","menuId"]),v(a,{class:"ti-dish-secondary"},{default:r((()=>[(d(!0),w(k,null,I(f(o),((e,l)=>(d(),c(a,{key:l,class:x([{active:e.category_id==s.value},"ti-secondary-item"]),onClick:l=>{return a=e.category_id,s.value=a,void t("update:categoryId",s.value>0?s.value:i.value);var a}},{default:r((()=>[_(p(e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-ebcc8dbd"]]),xe=t({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,b=l({}),g=l(!1),N=l(!1),U=l({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:40,describe:null});a((()=>o.show),(()=>{o.show&&S()}));const S=async()=>{var e,t,l,a,u,i,s,n,d;if(!g.value||o.productId)try{g.value=!0;const c=await se(o.productId);b.value=c.data,U.value.product_id=null==(e=b.value)?void 0:e.product_id,U.value.price=null==(t=b.value)?void 0:t.product_price,U.value.product_price=null==(l=b.value)?void 0:l.product_price,(null==(a=b.value)?void 0:a.sku)&&(null==(u=b.value)?void 0:u.sku.length)>0&&(U.value.product_sku_id=null==(i=b.value)?void 0:i.sku[0].product_sku_id),(null==(s=b.value)?void 0:s.product_attr)&&(null==(n=b.value)?void 0:n.product_attr.length)>0&&(null==(d=b.value)||d.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?U.value.attr[t]=0:U.value.attr[t]=null}))),U.value.feed&&U.value.feed.length>0&&(U.value.feed=[])}catch(c){}finally{g.value=!1}},V=async()=>{var t,l,a,u,s,o,n,d,c;if(N.value)return;const r={...U.value};r.attr=r.attr.join(","),r.feed=r.feed.join(",");let v=[];if((null==(t=b.value)?void 0:t.sku)&&(null==(l=b.value)?void 0:l.sku.length)>0){const e=null==(a=b.value)?void 0:a.sku.find((e=>e.product_sku_id==U.value.product_sku_id));r.price=(null==e?void 0:e.product_price)||0,(null==e?void 0:e.spec_name_text)&&v.push(null==e?void 0:e.spec_name_text)}(null==(u=b.value)?void 0:u.product_attr)&&(null==(s=b.value)?void 0:s.product_attr.length)&&(null==(o=b.value)||o.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0&&(null==e?void 0:e.attribute_value_text[U.value.attr[t]])&&v.push(null==e?void 0:e.attribute_value_text[U.value.attr[t]])}))),(null==(n=b.value)?void 0:n.product_feed)&&(null==(d=b.value)?void 0:d.product_feed.length)>0&&(null==(c=b.value)||c.product_feed.map(((e,t)=>{j(t)&&(v.push(e.feed_name_text),r.price=G(r.price,null==e?void 0:e.price))}))),r.describe=v.join(";"),r.table_id=C();try{N.value=!0;const t=await function(t){return e("order.HallCart/add",t)}(r);1==t.code&&(y({title:t.msg,icon:"none"}),i("update:show",!1),i("success"))}catch(_){}finally{N.value=!1}},j=e=>U.value.feed.indexOf(e)>-1,B=(e,t)=>U.value.attr[e]==t;return(e,t)=>{const l=Q,a=h,y=D,g=O,C=u(s("ti-modal"),n);return d(),c(C,{show:o.show,title:f(m)("商品详情"),confirmLoading:N.value,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:V},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-detail-box"},{default:r((()=>[v(a,{class:"ti-detail-image"},{default:r((()=>{var e,t,a,u;return[(null==(e=b.value)?void 0:e.image)&&(null==(t=b.value)?void 0:t.image[0])&&(null==(a=b.value)?void 0:a.image[0].file_path)?(d(),c(l,{key:0,src:null==(u=b.value)?void 0:u.image[0].file_path,mode:"widthFix"},null,8,["src"])):L("",!0)]})),_:1}),v(a,{class:"ti-detail-con"},{default:r((()=>[v(a,{class:"ti-detail-title text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_name_text),1)]})),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單價：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1}),v(y,{class:"ti-detail-subPrice"},{default:r((()=>{var e;return[_(p(f(P)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單位：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),v(a,{class:"ti-detail-specs"},{default:r((()=>[v(g,{"scroll-y":""},{default:r((()=>[v(a,{class:"ti-specs-box"},{default:r((()=>{var e,t,l,u,i,s,o;return[(null==(e=b.value)?void 0:e.sku)&&(null==(t=b.value)?void 0:t.sku.length)>0?(d(),c(a,{key:0,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("規格")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(d(!0),w(k,null,I(null==(e=b.value)?void 0:e.sku,(e=>(d(),c(a,{key:e.product_sku_id,class:x([{active:e.product_sku_id==U.value.product_sku_id},"ti-child-item"]),onClick:t=>{return l=e.product_sku_id,void(U.value.product_sku_id!=l&&(U.value.product_sku_id=l));var l}},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.spec_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f(P)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):L("",!0),(null==(l=b.value)?void 0:l.product_attr)&&(null==(u=b.value)?void 0:u.product_attr.length)>0?(d(!0),w(k,{key:1},I(null==(i=b.value)?void 0:i.product_attr,((e,t)=>(d(),c(a,{key:t,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(e.attribute_name_text),1)])),_:2},1024),v(a,{class:"ti-specs-child"},{default:r((()=>[(d(!0),w(k,null,I(null==e?void 0:e.attribute_value_text,((e,l)=>(d(),c(a,{key:l,class:x([{active:B(t,l)},"ti-child-item"]),onClick:e=>((e,t)=>{U.value.attr[e]=t})(t,l)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):L("",!0),(null==(s=b.value)?void 0:s.product_feed)&&(null==(o=b.value)?void 0:o.product_feed.length)>0?(d(),c(a,{key:2,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("加料")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(d(!0),w(k,null,I(null==(e=b.value)?void 0:e.product_feed,((e,t)=>(d(),c(a,{key:t,class:x([{active:j(t)},"ti-child-item"]),onClick:e=>(e=>{const t=U.value.feed.indexOf(e);t>=0?U.value.feed.splice(t,1):U.value.feed.push(e)})(t)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.feed_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f($)((null==e?void 0:e.price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f(P)((null==e?void 0:e.price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):L("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-abd800bc"]]),Ce=t({__name:"dish-list",emits:["success"],setup(e,{emit:t}){const i=l(!1),o=l({category_id:null,page:1,list_rows:20}),n=l([]),b=l(!1),g=l(),C=l(!1);a((()=>o.value.category_id),(()=>{S()}));const N=()=>{t("success")},U=()=>{C.value&&(o.value.page+=1,V())},S=()=>{o.value.page=1,V(!0)},V=async e=>{var t,l,a,u,i,s;if(b.value)return;const d={...o.value};d.category_id||(d.category_id=null);try{e&&(b.value=!0);const c=await oe(d);1==o.value.page&&(n.value=[]),n.value=n.value.concat((null==(l=null==(t=c.data)?void 0:t.list)?void 0:l.data)||[]),C.value=(null==(u=null==(a=c.data)?void 0:a.list)?void 0:u.last_page)>(null==(s=null==(i=c.data)?void 0:i.list)?void 0:s.current_page)}catch(c){}finally{e&&(b.value=!1)}};return S(),(e,t)=>{const l=u(s("ti-loading"),j),a=Q,S=D,V=h,T=u(s("ti-empty-data"),B),K=O;return d(),w(k,null,[v(V,{class:"ti-dish-box"},{default:r((()=>[v(Ie,{categoryId:o.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>o.value.category_id=e)},null,8,["categoryId"]),v(V,{class:"ti-dish-list"},{default:r((()=>[v(K,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:U},{default:r((()=>[b.value?(d(),c(l,{key:0})):n.value&&n.value.length>0?(d(),w(k,{key:1},[v(V,{class:"ti-dish-goods"},{default:r((()=>[(d(!0),w(k,null,I(n.value,((e,t)=>(d(),c(V,{key:t,class:x([{"sold-out":e.product_stock<=0},"ti-goods-item"]),onClick:t=>(e=>{if(e.product_stock<=0)return y({title:m("已售罄"),icon:"none"});i.value=!0,g.value=e.product_id})(e)},{default:r((()=>[v(V,{class:"ti-goods-image"},{default:r((()=>[e.image&&e.image[0]&&e.image[0].file_path?(d(),c(a,{key:0,src:e.image[0].file_path,mode:"widthFix"},null,8,["src"])):L("",!0),v(S,{class:"sold-out-text"},{default:r((()=>[_(p(f(m)("已售罄")),1)])),_:1})])),_:2},1024),v(V,{class:"ti-goods-content"},{default:r((()=>[v(V,{class:"ti-goods-title line-clamp-2"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),v(V,{class:"ti-price-box"},{default:r((()=>[v(S,{class:"ti-goods-price"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(S,{class:"ti-goods-subPrice"},{default:r((()=>[_(p(f(P)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:C.value?"loading":"no-more"},null,8,["status"])],64)):(d(),c(T,{key:2}))])),_:1})])),_:1})])),_:1}),v(xe,{show:i.value,"onUpdate:show":t[1]||(t[1]=e=>i.value=e),productId:g.value,onSuccess:N},null,8,["show","productId"])],64)}}},[["__scopeId","data-v-0903858b"]]),$e=t({__name:"index",emits:["change"],setup(e,{emit:t}){const a=l();Y((()=>{ee()}));const u=()=>{var e;null==(e=a.value)||e.getCartData()};return(e,l)=>{const i=h;return d(),c(i,{class:"ti-order-food"},{default:r((()=>[v(we,{ref_key:"cartRef",ref:a,onChange:l[0]||(l[0]=e=>t("change"))},null,512),v(Ce,{onSuccess:u})])),_:1})}}},[["__scopeId","data-v-a1a999ff"]]),Pe=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},list:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),a("success")}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=O,b=u(s("ti-modal"),n);return d(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.list&&t.list.length>0?(d(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(d(!0),w(k,null,I(i.list,((e,t)=>(d(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(d(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-2649cc86"]]),Le=t({__name:"index",emits:["change"],setup(t,{emit:i}){const o=l({area_id:"",type_id:"",table_status:""}),n=l(!1),y=l(!1),b=l([]),g=l(),C=l(),L=l([]),N=l([]),U=H((()=>g.value-C.value)),S=l(!1),V=l(),T=l([]),M=l(!1),Z=l(),E=l();a((()=>o.value),(()=>{Q(!0)}),{deep:!0});const F=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";return t>0&&(u+=`${R(t)} ${m("小时")} `),u+=`${R(l)} ${m("分钟")} ${R(a)} ${m("秒")}`,u},R=e=>e<10?`0${e}`:e,J=async t=>{var l,a,u;try{const i=await(u={table_id:t},e("order.HallCart/getUnSendKitchen",u));T.value=(null==(a=null==(l=i.data)?void 0:l.detail)?void 0:a.unSendKitchenProduct)||[],S.value=!0,V.value=t}catch(i){}},Q=async e=>{var t,l,a;if(!y.value)try{e&&(y.value=!0);const u=await _e(o.value);b.value=(null==(t=u.data)?void 0:t.list)||[],g.value=(null==(l=u.data)?void 0:l.total_num)||0,C.value=(null==(a=u.data)?void 0:a.available_num)||0}catch(u){}finally{e&&(y.value=!1)}};return(async()=>{var t,l;try{const a=await e("store.table/tableType");L.value=(null==(t=a.data)?void 0:t.areaList)||[],N.value=(null==(l=a.data)?void 0:l.typeList)||[]}catch(a){}})(),Q(!0),(e,t)=>{const l=h,a=O,H=u(s("ti-loading"),j),R=u(s("uni-icons"),z),W=D,X=u(s("ti-empty-data"),B);return d(),w(k,null,[v(l,{class:"ti-dining-box"},{default:r((()=>[v(l,{class:"ti-dining-category"},{default:r((()=>[v(a,{"scroll-x":""},{default:r((()=>[v(l,{class:"ti-category-list"},{default:r((()=>[v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.area_id}]),onClick:t[0]||(t[0]=e=>o.value.area_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(d(!0),w(k,null,I(L.value,(e=>(d(),c(l,{key:e.area_id,class:x([{active:o.value.area_id==e.area_id},"ti-category-childItem"]),onClick:t=>o.value.area_id=e.area_id},{default:r((()=>[_(p(e.area_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.type_id}]),onClick:t[1]||(t[1]=e=>o.value.type_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(d(!0),w(k,null,I(N.value,(e=>(d(),c(l,{key:e.type_id,class:x([{active:o.value.type_id==e.type_id},"ti-category-childItem"]),onClick:t=>o.value.type_id=e.type_id},{default:r((()=>[_(p(e.type_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.table_status}]),onClick:t[2]||(t[2]=e=>o.value.table_status="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[v(l,{class:x(["ti-category-childItem",{active:"10"==o.value.table_status}]),onClick:t[3]||(t[3]=e=>o.value.table_status="10")},{default:r((()=>[_(p(f(m)("可用"))+" ("+p(C.value||0)+") ",1)])),_:1},8,["class"]),v(l,{class:x(["ti-category-childItem",{active:"30"==o.value.table_status}]),onClick:t[4]||(t[4]=e=>o.value.table_status="30")},{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(U)||0)+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(l,{class:"ti-dining-table"},{default:r((()=>[v(a,{class:"ti-scroll","scroll-y":""},{default:r((()=>[y.value?(d(),c(H,{key:0})):b.value&&b.value.length>0?(d(),w(k,{key:1},[v(l,{class:"ti-dining-list"},{default:r((()=>[(d(!0),w(k,null,I(b.value,(e=>(d(),c(l,{key:e.table_id,class:x([{green:30!=e.status},"ti-dining-item"]),onClick:t=>(e=>{30!=e.status?(E.value=e.table_no,Z.value=e.table_id,M.value=!0):(K(e.table_id),i("change"))})(e)},{default:r((()=>[v(l,{class:"ti-dining-number"},{default:r((()=>[_(p(e.table_no),1)])),_:2},1024),30!=e.status?(d(),c(l,{key:0,class:"ti-dining-idle"},{default:r((()=>[_(p(f(m)("空闲中")),1)])),_:1})):(d(),w(k,{key:1},[v(l,{class:"ti-dining-info"},{default:r((()=>[v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-user",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p((null==(t=e.underwayOrder)?void 0:t.meal_num)||0),1)]})),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-wallet",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>[v(W,{class:"ti-dining-info-price"},{default:r((()=>{var t;return[_(p(f($)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024),v(W,{class:"ti-dining-info-subPrice"},{default:r((()=>{var t;return[_(p(f(P)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-clock",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p(F(null==(t=e.underwayOrder)?void 0:t.elapsed_time)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-close",onClick:A((t=>J(e.table_id)),["stop"])},{default:r((()=>[v(R,{type:"closeempty",size:"14",color:"#fff"})])),_:2},1032,["onClick"])],64))])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(H,{status:n.value?"loading":"no-more"},null,8,["status"])],64)):(d(),c(X,{key:2}))])),_:1})])),_:1}),v(l,{class:"ti-dining-total"},{default:r((()=>[v(l,{class:"ti-dining-total-box"},{default:r((()=>[v(l,{class:"ti-dining-total-item"},{default:r((()=>[_(p(f(m)("全部"))+" ("+p(g.value)+")",1)])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color green"}),v(l,null,{default:r((()=>[_(p(f(m)("可用"))+" ("+p(C.value||0)+")",1)])),_:1})])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color orange"}),v(l,null,{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(U)||0)+")",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(Pe,{show:S.value,"onUpdate:show":t[5]||(t[5]=e=>S.value=e),tableId:V.value,list:T.value,onSuccess:t[6]||(t[6]=e=>Q())},null,8,["show","tableId","list"]),v(fe,{show:M.value,"onUpdate:show":t[7]||(t[7]=e=>M.value=e),tableId:Z.value,tableNo:E.value,onSuccess:t[8]||(t[8]=e=>i("change"))},null,8,["show","tableId","tableNo"])],64)}}},[["__scopeId","data-v-22445472"]]),De={__name:"index",setup(e){const t=l();Y((()=>{a(),ee()}));const a=()=>{t.value=!!C()};return(e,l)=>{const u=te("ti-layout");return d(),c(u,null,{default:r((()=>[t.value?(d(),c($e,{key:0,onChange:a})):(d(),c(Le,{key:1,onChange:a}))])),_:1})}}};export{De as default};
