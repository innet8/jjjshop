import{ap as e,_ as t,r as a,a as l,b as i,o as n,d as r,w as o,e as u,f as s,t as d,Z as c,R as p,O as f,P as _,Q as h,j as m,a6 as g,aq as v,k as y,n as x,af as w,q as k,ae as b,S as C,ak as I,K as P,L as S,M as T,g as z,$ as N,W as U,X as V,y as $,ar as D,as as R,at as O,au as L,J as A,av as M,ah as j,ai as B,aw as q,ax as E,ay as F,I as W,aj as H}from"./index-8d00602e.js";import{_ as Z}from"./uni-data-select.22096aac.js";const J={en:{"uni-pagination.prevText":"prev","uni-pagination.nextText":"next","uni-pagination.piecePerPage":"piece/page"},es:{"uni-pagination.prevText":"anterior","uni-pagination.nextText":"prxima","uni-pagination.piecePerPage":"Art��culo/P��gina"},fr:{"uni-pagination.prevText":"précédente","uni-pagination.nextText":"suivante","uni-pagination.piecePerPage":"Articles/Pages"},"zh-Hans":{"uni-pagination.prevText":"上一页","uni-pagination.nextText":"下一页","uni-pagination.piecePerPage":"条/页"},"zh-Hant":{"uni-pagination.prevText":"上一頁","uni-pagination.nextText":"下一頁","uni-pagination.piecePerPage":"條/頁"}},{t:K}=e(J);const Q=t({name:"UniPagination",emits:["update:modelValue","input","change","pageSizeChange"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},prevText:{type:String},nextText:{type:String},piecePerPageText:{type:String},current:{type:[Number,String],default:1},total:{type:[Number,String],default:0},pageSize:{type:[Number,String],default:10},showIcon:{type:[Boolean,String],default:!1},showPageSize:{type:[Boolean,String],default:!1},pagerCount:{type:Number,default:7},pageSizeRange:{type:Array,default:()=>[20,50,100,500]}},data:()=>({pageSizeIndex:0,currentIndex:1,paperData:[],pickerShow:!1}),computed:{piecePerPage(){return this.piecePerPageText||K("uni-pagination.piecePerPage")},prevPageText(){return this.prevText||K("uni-pagination.prevText")},nextPageText(){return this.nextText||K("uni-pagination.nextText")},maxPage(){let e=1,t=Number(this.total),a=Number(this.pageSize);return t&&a&&(e=Math.ceil(t/a)),e},paper(){const e=this.currentIndex,t=this.pagerCount,a=this.total,l=this.pageSize;let i=[],n=[],r=Math.ceil(a/l);for(let u=0;u<r;u++)i.push(u+1);n.push(1);const o=i[i.length-(t+1)/2];return i.forEach(((a,l)=>{(t+1)/2>=e?a<t+1&&a>1&&n.push(a):e+2<=o?a>e-(t+1)/2&&a<e+(t+1)/2&&n.push(a):(a>e-(t+1)/2||r-t<a)&&a<i[i.length-1]&&n.push(a)})),r>t?((t+1)/2>=e?n[n.length-1]="...":e+2<=o?(n[1]="...",n[n.length-1]="..."):n[1]="...",n.push(i[i.length-1])):(t+1)/2>=e||e+2<=o||(n.shift(),n.push(i[i.length-1])),n}},watch:{current:{immediate:!0,handler(e,t){this.currentIndex=e<1?1:e}},value:{immediate:!0,handler(e){1===Number(this.current)&&(this.currentIndex=e<1?1:e)}},pageSizeIndex(e){this.$emit("pageSizeChange",this.pageSizeRange[e])}},methods:{pickerChange(e){this.pageSizeIndex=e.detail.value,this.pickerClick()},pickerClick(){const e=document.querySelector("body");if(!e)return;const t="uni-pagination-picker-show";this.pickerShow=!this.pickerShow,this.pickerShow?e.classList.add(t):setTimeout((()=>e.classList.remove(t)),300)},selectPage(e,t){if(parseInt(e))this.currentIndex=e,this.change("current");else{let e=Math.ceil(this.total/this.pageSize);if(t<=1)return void(this.currentIndex-5>1?this.currentIndex-=5:this.currentIndex=1);if(t>=6)return void(this.currentIndex+5>e?this.currentIndex=e:this.currentIndex+=5)}},clickLeft(){1!==Number(this.currentIndex)&&(this.currentIndex-=1,this.change("prev"))},clickRight(){Number(this.currentIndex)>=this.maxPage||(this.currentIndex+=1,this.change("next"))},change(e){this.$emit("input",this.currentIndex),this.$emit("update:modelValue",this.currentIndex),this.$emit("change",{type:e,current:this.currentIndex})}}},[["render",function(e,t,x,w,k,b){const C=m,I=a(i("uni-icons"),l),P=g,S=v,T=y;return n(),r(T,{class:"uni-pagination"},{default:o((()=>[!0===x.showPageSize||"true"===x.showPageSize?(n(),r(S,{key:0,class:"select-picker",mode:"selector",value:k.pageSizeIndex,range:x.pageSizeRange,onChange:b.pickerChange,onCancel:b.pickerClick,onClick:b.pickerClick},{default:o((()=>[u(P,{type:"default",size:"mini",plain:!0},{default:o((()=>[u(C,null,{default:o((()=>[s(d(x.pageSizeRange[k.pageSizeIndex])+" "+d(b.piecePerPage),1)])),_:1}),u(I,{class:"select-picker-icon",type:"arrowdown",size:"12",color:"#999"})])),_:1})])),_:1},8,["value","range","onChange","onCancel","onClick"])):c("",!0),u(T,{class:"uni-pagination__total is-phone-hide"},{default:o((()=>[s("共 "+d(x.total)+" 条",1)])),_:1}),u(T,{class:p(["uni-pagination__btn",1===k.currentIndex?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":1===k.currentIndex?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:b.clickLeft},{default:o((()=>[!0===x.showIcon||"true"===x.showIcon?(n(),r(I,{key:0,color:"#666",size:"16",type:"left"})):(n(),r(C,{key:1,class:"uni-pagination__child-btn"},{default:o((()=>[s(d(b.prevPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"]),u(T,{class:"uni-pagination__num uni-pagination__num-flex-none"},{default:o((()=>[u(T,{class:"uni-pagination__num-current"},{default:o((()=>[u(C,{class:"uni-pagination__num-current-text is-pc-hide current-index-text"},{default:o((()=>[s(d(k.currentIndex),1)])),_:1}),u(C,{class:"uni-pagination__num-current-text is-pc-hide"},{default:o((()=>[s("/"+d(b.maxPage||0),1)])),_:1}),(n(!0),f(_,null,h(b.paper,((e,t)=>(n(),r(T,{key:t,class:p([{"page--active":e===k.currentIndex},"uni-pagination__num-tag tag--active is-phone-hide"]),onClick:a=>b.selectPage(e,t)},{default:o((()=>[u(C,null,{default:o((()=>[s(d(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),u(T,{class:p(["uni-pagination__btn",k.currentIndex>=b.maxPage?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":k.currentIndex===b.maxPage?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:b.clickRight},{default:o((()=>[!0===x.showIcon||"true"===x.showIcon?(n(),r(I,{key:0,color:"#666",size:"16",type:"right"})):(n(),r(C,{key:1,class:"uni-pagination__child-btn"},{default:o((()=>[s(d(b.nextPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"])])),_:1})}],["__scopeId","data-v-7a02a0a9"]]),X=t({__name:"order-type-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId","menuClick"],setup(e,{emit:t}){const a=e,l=x(0),i=x(0),c=x([]),g=w().in(this);k((()=>a.list),(async e=>{if(e&&0!=e.length&&(await b(),e.map(((e,t)=>{g.select(`#scroll-item-${t}`).boundingClientRect((e=>{if(!e)return;const a=c.value;a[t]=e.width+10,c.value=a})).exec()})),a.menuId>0)){const e=a.list.findIndex((e=>e.category_id==a.menuId));e>-1&&v(e)}}),{deep:!0,immediate:!0});const v=e=>{i.value=e,l.value=c.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(c.value[e]+100),t("update:menuId",a.list[e].category_id),t("menuClick",a.list[e].category_id)};return(e,t)=>{const c=m,g=y,x=C;return n(),r(x,{class:"ti-order-menu","scroll-left":l.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:o((()=>[u(g,{class:"ti-menu-content"},{default:o((()=>[(n(!0),f(_,null,h(a.list,((e,t)=>(n(),r(g,{key:t,class:p(["ti-menu-item",{active:t==i.value}]),id:`scroll-item-${t}`,onClick:e=>v(t)},{default:o((()=>[u(g,{style:{display:"flex","flex-direction":"row","align-items":"center"}},{default:o((()=>[u(c,{class:"ti-menu-title"},{default:o((()=>[s(d(`${e.name_text}`+(e.number?`(${e.number})`:"")),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-f35e4262"]]);function G(e){return I("order.order/cancel",e)}function Y(e){return I("order.order/remove",e)}function ee(e){return I("order.order/print",e)}const te=t({__name:"dialog-refuse-payed",props:{show:{type:Boolean,default:!1},orderAmount:{type:String,default:""}},emits:["update:show"],setup(e,{expose:t,emit:l}){const c=e,p=x({refund_money:""}),f=x({}),_=x(!1),h=()=>{p.value.refund_money=""},g=e=>{p.value.refund_money+=e,v()},v=()=>{parseFloat(p.value.refund_money)>parseFloat(f.value.total_price)&&(p.value.refund_money=parseFloat(f.value.total_price)+"")},w=async()=>{const e={...p.value};e.order_id=f.value.order_id;try{_.value=!0;const t=await function(e){return I("order.order/refund",e)}(e);setTimeout((()=>{$({title:t.msg,icon:"none"})}),200),1==t.code&&k(),_.value=!1}catch(t){}finally{_.value=!1}},k=()=>{l("update:show",!1)};return t({getOrderData:e=>{f.value=e,l("update:show",!0)}}),(e,t)=>{const l=y,v=m,x=a(i("ti-input"),P),b=a(i("ti-keyboard"),S),C=a(i("ti-modal"),T);return n(),r(C,{show:c.show,title:z(N)("退款")},{content:o((()=>[u(l,{class:"ti-dialog-content"},{default:o((()=>[u(l,{class:"ti-preferential-box"},{default:o((()=>[u(l,{class:"ti-preferential-label"},{default:o((()=>[s(d(z(N)("可退款金額")),1)])),_:1}),u(l,{class:"ti-preferential-input"},{default:o((()=>[u(v,{class:"ti-preferential-price"},{default:o((()=>[s(d(z(U)(f.value.total_price)),1)])),_:1}),u(v,{class:"ti-preferential-subPrice"},{default:o((()=>[s(d(z(V)(f.value.total_price)),1)])),_:1})])),_:1}),u(l,{class:"ti-preferential-input"},{default:o((()=>[u(x,{modelValue:p.value.refund_money,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value.refund_money=e),placeholder:z(N)("請輸入退款金額，不能大於可退款金額"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),_:1})])),footer:o((()=>[u(l,{class:"ti-dialog-btn ti-preferential-keyboard"},{default:o((()=>[u(b,{primaryLoading:_.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:k,onClear:h,onInput:g,onConfirm:w},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-6a438d47"]]),ae=t({__name:"dialog-order-detail",props:{show:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup(e,{expose:t,emit:l}){const p=x(""),m=x(!1),g=x(!1),v=x(!1),w=x(!1),k=x({}),b=x(),P=x(!1);x({time_type:0,time:null,category_type:1});const S=x([]);x([]);const U=async()=>{const e={order_id:p.value};P.value=!0;try{const t=await function(e){return I("order.order/detail",e)}(e);S.value=t.data.detail.product||[],k.value=t.data.detail}catch(t){}finally{P.value=!1}},V=()=>{v.value=!0},j=()=>{g.value=!0},B=()=>{var e;null==(e=b.value)||e.getOrderData(k.value)},q=()=>{w.value=!0},E=async()=>{const e={order_id:p.value};g.value=!1;try{const t=await G(e);setTimeout((()=>{$({title:t.msg,icon:"none"}),1==t.code&&H()}),200)}catch(t){}},F=async()=>{const e={order_id:p.value};v.value=!1;try{const t=await Y(e);setTimeout((()=>{$({title:t.msg,icon:"none"}),1==t.code&&H()}),200)}catch(t){}},W=async()=>{const e={order_id:p.value};w.value=!1;try{const t=await ee(e);setTimeout((()=>{$({title:t.msg,icon:"none"}),t.code}),200)}catch(t){}},H=()=>{l("update:show",!1),g.value=!1,v.value=!1},Z=()=>{};return t({showDetailWithData:e=>{p.value=e,l("update:show",!0),U()}}),(t,l)=>{const p=y,x=a(i("uni-th"),D),I=a(i("uni-tr"),R),U=a(i("uni-td"),O),$=a(i("uni-table"),L),J=C,K=a(i("ti-button"),A),Q=a(i("ti-modal"),T),X=a(i("u-popup"),M);return n(),r(p,{class:""},{default:o((()=>[u(X,{ref:"dialogRef",round:16,show:e.show,mode:"right",onOpen:Z,onClose:H,closeOnClickOverlay:!1},{default:o((()=>[u(p,{class:"ti-order-detail-container"},{default:o((()=>[u(p,{class:"ti-order-detail-title"},{default:o((()=>[s(d(z(N)("訂單詳情")),1)])),_:1}),u(p,{class:"ti-order-detail-header"},{default:o((()=>[u(p,{class:"ti-order-detail-header-tag"}),u(p,{class:"ti-order-detail-header-title"},{default:o((()=>[s(d(z(N)("基本信息")),1)])),_:1})])),_:1}),u(p,{class:"ti-order-detail-other"},{default:o((()=>{var e,t;return[u(p,{class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("訂單類型")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(k.value.order_type_text||"-"),1)])),_:1})])),_:1}),u(p,{class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("訂單號")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(k.value.order_no||"-"),1)])),_:1})])),_:1}),k.value.user?(n(),r(p,{key:0,class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("買家")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>{var e;return[s(d((null==(e=k.value.user)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1})):c("",!0),u(p,{class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("訂單金額")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(`¥${k.value.order_price}`),1)])),_:1})])),_:1}),20==(null==(e=k.value.pay_status)?void 0:e.value)?(n(),r(p,{key:1,class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("實付款金額")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(`¥${k.value.pay_price}`),1)])),_:1})])),_:1})):c("",!0),20==(null==(t=k.value.pay_status)?void 0:t.value)?(n(),r(p,{key:2,class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("支付方式")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>{var e;return[s(d(null==(e=k.value.pay_type)?void 0:e.text),1)]})),_:1})])),_:1})):c("",!0),u(p,{class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("用餐方式")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>{var e;return[s(d(null==(e=k.value.delivery_type)?void 0:e.text),1)]})),_:1})])),_:1}),0===k.value.table_id?(n(),r(p,{key:3,class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("序號")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(k.value.callNo),1)])),_:1})])),_:1})):c("",!0),0!==k.value.table_id?(n(),r(p,{key:4,class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("桌號")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(k.value.table_no),1)])),_:1})])),_:1})):c("",!0),u(p,{class:"ti-order-detail-other-item"},{default:o((()=>[u(p,{class:"ti-order-detail-other-item-title"},{default:o((()=>[s(d(z(N)("交易狀態")),1)])),_:1}),u(p,{class:"ti-order-detail-other-item-content"},{default:o((()=>[s(d(k.value.state_text),1)])),_:1})])),_:1})]})),_:1}),u(p,{class:"ti-order-detail-header"},{default:o((()=>[u(p,{class:"ti-order-detail-header-tag"}),u(p,{class:"ti-order-detail-header-title"},{default:o((()=>[s(d(z(N)("商品信息")),1)])),_:1})])),_:1}),u(p,{class:"scroll-content"},{default:o((()=>[u(J,{"scroll-y":"true"},{default:o((()=>[u(p,{class:"scroll-view"},{default:o((()=>[u($,{ref:"table",loading:P.value,border:"",stripe:"",emptyText:z(N)("暂无更多数据")},{default:o((()=>[u(I,null,{default:o((()=>[u(x,{align:"left"},{default:o((()=>[s(d(z(N)("商品")),1)])),_:1}),u(x,{align:"right"},{default:o((()=>[s(d(z(N)("價格")),1)])),_:1}),u(x,{align:"right"},{default:o((()=>[s(d(z(N)("購買數量")),1)])),_:1}),u(x,{align:"right"},{default:o((()=>[s(d(z(N)("商品總價")),1)])),_:1})])),_:1}),(n(!0),f(_,null,h(S.value,((e,t)=>(n(),r(I,{key:t},{default:o((()=>[u(U,null,{default:o((()=>[s(d(e.product_name_text),1)])),_:2},1024),u(U,{align:"right"},{default:o((()=>[u(p,{class:"name"},{default:o((()=>[s(d(`¥ ${e.product_price}`),1)])),_:2},1024)])),_:2},1024),u(U,{align:"right"},{default:o((()=>[s(d(e.total_num),1)])),_:2},1024),u(U,{align:"right"},{default:o((()=>[s(d(`¥ ${e.total_price}`),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["loading","emptyText"])])),_:1})])),_:1})])),_:1}),u(p,{class:"ti-data-bottom"},{default:o((()=>[u(p,{class:"ti-data-bottom-grid"},{default:o((()=>{var e,t,a;return[u(K,{onClick:H},{default:o((()=>[s(d(z(N)("退出")),1)])),_:1}),30==(null==(e=k.value.order_status)?void 0:e.value)?(n(),r(K,{key:0,onClick:B,type:"primary"},{default:o((()=>[s(d(z(N)("退款")),1)])),_:1})):c("",!0),20==(null==(t=k.value.order_status)?void 0:t.value)?(n(),r(K,{key:1,onClick:V,type:"danger"},{default:o((()=>[s(d(z(N)("删除")),1)])),_:1})):c("",!0),10==(null==(a=k.value.order_status)?void 0:a.value)?(n(),r(K,{key:2,onClick:j,type:"danger"},{default:o((()=>[s(d(z(N)("取消")),1)])),_:1})):c("",!0),u(K,{type:"primary",onClick:q},{default:o((()=>[s(d(z(N)("打印")),1)])),_:1})]})),_:1})])),_:1}),u(te,{ref_key:"refuse",ref:b,show:m.value,"onUpdate:show":l[0]||(l[0]=e=>m.value=e)},null,8,["show"]),u(Q,{class:"ti-action-tips",show:g.value,"onUpdate:show":l[1]||(l[1]=e=>g.value=e),title:z(N)("溫馨提示"),content:z(N)("是否取消此訂單？"),onConfirm:E},null,8,["show","title","content"]),u(Q,{class:"ti-action-tips",show:v.value,"onUpdate:show":l[2]||(l[2]=e=>v.value=e),title:z(N)("溫馨提示"),content:z(N)("是否删除此訂單？"),onConfirm:F},null,8,["show","title","content"]),u(Q,{class:"ti-action-tips",show:w.value,"onUpdate:show":l[3]||(l[3]=e=>w.value=e),title:z(N)("溫馨提示"),content:z(N)("確定要打印小票嗎？"),onConfirm:W},null,8,["show","title","content"])])),_:1})])),_:1},8,["show"])])),_:1})}}},[["__scopeId","data-v-2aff1fdd"]]),le=t({__name:"index",setup(e){const t=x(0),l=x(),p=x(),m=x(!1),g=x(!1),v=x(!1),w=x(!1),k=x(!1),b=x(!1),C=x(""),P=x("");var S={};const U=x({eat_type:10,time_type:1,time:null,dataType:0,search:null,order_type:0,page:1,list_rows:6,search:null}),V=x([{name_text:N("全部"),number:0,category_id:0},{name_text:N("待付款"),number:2,category_id:1},{name_text:N("已取消"),number:10,category_id:3},{name_text:N("已完成"),number:99,category_id:2}]),D=x([{name:N("今天"),value:"1"},{name:N("昨天"),value:"2"},{name:N("一週"),value:"3"},{name:N("全部"),value:"0"}]),M=x([{value:20,text:N("桌台订单")},{value:10,text:N("收银订单")}]),J=x([]);var K=x("");const le=e=>{U.value.dataType=e,pe()},ie=e=>{U.value.time_type=e,pe()},ne=e=>{U.value.eat_type=e||0},re=e=>{C.value=e},oe=e=>{P.value=e},ue=e=>{pe()},se=async()=>{const e={order_id:S.order_id};try{const t=await Y(e);setTimeout((()=>{$({title:t.msg,icon:"none"})}),200),1==t.code&&(w.value=!1,pe())}catch(t){}},de=async()=>{const e={order_id:S.order_id};try{const t=await G(e);setTimeout((()=>{$({title:t.msg,icon:"none"})}),200),1==t.code&&(v.value=!1,pe())}catch(t){}},ce=async()=>{const e={order_id:S.order_id};try{const t=await ee(e);setTimeout((()=>{$({title:t.msg,icon:"none"})}),200),1==t.code&&(k.value=!1)}catch(t){}},pe=async()=>{var e={...U.value},a=[0,0];C.value&&(a[0]=C.value),P.value&&(a[1]=P.value),0===a[0]&&0===a[1]||(e.time=a),b.value=!0;try{const a=await function(e){return I("order.order/index",e)}(e);J.value=a.data.list.data,t.value=a.data.list.total,V.value[1].number=a.data.info.pendingNum,V.value[2].number=a.data.info.cancelNum,V.value[3].number=a.data.info.completeNum;const l=a.data.info.pendingNum+a.data.info.cancelNum+a.data.info.completeNum;V.value[0].number=l}catch(l){}finally{b.value=!1}};return pe(),j((()=>{B()})),(e,x)=>{const C=y,I=W,P=a(i("uni-data-select"),Z),$=a(i("ti-button"),A),j=a(i("uni-td"),O),B=a(i("uni-tr"),R),G=a(i("uni-table"),L),Y=a(i("uni-pagination"),Q),ee=a(i("ti-modal"),T),fe=H("ti-layout");return n(),r(fe,null,{default:o((()=>[u(C,{class:"ti-order-container"},{default:o((()=>[u(X,{list:V.value,"onUpdate:list":x[0]||(x[0]=e=>V.value=e),onMenuClick:le},null,8,["list"]),u(C,{class:"ti-order-container-option"},{default:o((()=>[u(q,{list:D.value,"onUpdate:list":x[1]||(x[1]=e=>D.value=e),onOutput:ie},null,8,["list"]),u(C,{class:"date-picker"},{default:o((()=>[u(E,{onStartDateChange:re,onEndDateChange:oe})])),_:1}),u(C,{class:"date-order-input-item"},{default:o((()=>[u(I,{class:"date-order-input",modelValue:U.value.search,"onUpdate:modelValue":x[2]||(x[2]=e=>U.value.search=e),placeholder:z(N)("請輸入訂單號")},null,8,["modelValue","placeholder"])])),_:1}),u(C,{class:"date-select-type"},{default:o((()=>[u(P,{modelValue:z(K),"onUpdate:modelValue":x[3]||(x[3]=e=>F(K)?K.value=e:K=e),localdata:M.value,placeholder:z(N)("所有類型"),onChange:ne,clear:!0},null,8,["modelValue","localdata","placeholder"])])),_:1}),u(C,{class:"date-search-confirm"},{default:o((()=>[u($,{class:"date-search-confirm-button",type:"primary",onClick:pe},{default:o((()=>[s(d(z(N)("查询")),1)])),_:1})])),_:1})])),_:1}),u(G,{ref:"table",loading:b.value,border:"",stripe:"",emptyText:z(N)("暂无更多数据")},{default:o((()=>[u(B,null,{default:o((()=>[u(j,{width:"130",align:"left"},{default:o((()=>[s(d(z(N)("訂單類型")),1)])),_:1}),u(j,{width:"120",align:"left"},{default:o((()=>[s(d(z(N)("桌號/序號")),1)])),_:1}),u(j,{width:"160",align:"left"},{default:o((()=>[s(d(z(N)("訂單號")),1)])),_:1}),u(j,{width:"100",align:"left"},{default:o((()=>[s(d(z(N)("狀態")),1)])),_:1}),u(j,{width:"100",align:"left"},{default:o((()=>[s(d(z(N)("支付時間")),1)])),_:1}),u(j,{width:"140",align:"left"},{default:o((()=>[s(d(z(N)("訂單金額")),1)])),_:1}),u(j,{width:"140",align:"left"},{default:o((()=>[s(d(z(N)("實付金額")),1)])),_:1}),u(j,{width:"150",align:"left"},{default:o((()=>[s(d(z(N)("支付方式")),1)])),_:1}),u(j,{width:"280",align:"left"},{default:o((()=>[s(d(""))])),_:1})])),_:1}),(n(!0),f(_,null,h(J.value,((e,t)=>(n(),r(B,{key:t},{default:o((()=>[u(j,{align:"left"},{default:o((()=>[u(C,{class:"order-table-cell"},{default:o((()=>[s(d(20==e.eat_type?z(N)("桌台订单"):z(N)("收银订单")),1)])),_:2},1024)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(e.order_id||e.table_no),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(e.order_no),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(e.order_status.text),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(e.pay_time_text),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(`¥ ${e.order_price}`),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(`¥ ${e.pay_price}`),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[s(d(e.pay_status.text),1)])),_:2},1024),u(j,{align:"left"},{default:o((()=>[u(C,{class:"edit-buttons"},{default:o((()=>{var t,a,i;return[u($,{class:"function-buttons",onClick:t=>l.value.showDetailWithData(e.order_id),type:"primary"},{default:o((()=>[s(d(z(N)("詳情")),1)])),_:2},1032,["onClick"]),u($,{class:"function-buttons margin",onClick:t=>{return a=e,k.value=!0,void(S=a);var a},type:"primary"},{default:o((()=>[s(d(z(N)("打印小票")),1)])),_:2},1032,["onClick"]),30==(null==(t=e.order_status)?void 0:t.value)?(n(),r($,{key:0,class:"function-buttons margin",onClick:t=>(e=>{var t;null==(t=p.value)||t.getOrderData(e)})(e),type:"primary"},{default:o((()=>[s(d(z(N)("退款")),1)])),_:2},1032,["onClick"])):c("",!0),20==(null==(a=e.order_status)?void 0:a.value)?(n(),r($,{key:1,class:"function-buttons margin",onClick:t=>{return a=e,w.value=!0,void(S=a);var a},type:"danger"},{default:o((()=>[s(d(z(N)("删除")),1)])),_:2},1032,["onClick"])):c("",!0),10==(null==(i=e.order_status)?void 0:i.value)?(n(),r($,{key:2,class:"function-buttons margin",onClick:t=>{return a=e,v.value=!0,void(S=a);var a},type:"danger"},{default:o((()=>[s(d(z(N)("取消")),1)])),_:2},1032,["onClick"])):c("",!0)]})),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["loading","emptyText"]),u(C,{class:"page-control"},{default:o((()=>[u(Y,{"prev-text":z(N)("上一页"),"next-text":z(N)("下一页"),modelValue:U.value.page,"onUpdate:modelValue":x[4]||(x[4]=e=>U.value.page=e),title:"标题文字","page-size":"6",total:t.value,onChange:ue},null,8,["prev-text","next-text","modelValue","total"])])),_:1}),u(ae,{ref_key:"orderDetail",ref:l,show:m.value,"onUpdate:show":x[5]||(x[5]=e=>m.value=e)},null,8,["show"]),u(te,{ref_key:"refuse",ref:p,show:g.value,"onUpdate:show":x[6]||(x[6]=e=>g.value=e)},null,8,["show"]),u(ee,{class:"ti-action-tips",show:v.value,"onUpdate:show":x[7]||(x[7]=e=>v.value=e),title:z(N)("溫馨提示"),content:z(N)("是否取消此訂單？"),onConfirm:de},null,8,["show","title","content"]),u(ee,{class:"ti-action-tips",show:w.value,"onUpdate:show":x[8]||(x[8]=e=>w.value=e),title:z(N)("溫馨提示"),content:z(N)("是否删除此訂單？"),onConfirm:se},null,8,["show","title","content"]),u(ee,{class:"ti-action-tips",show:k.value,"onUpdate:show":x[9]||(x[9]=e=>k.value=e),title:z(N)("溫馨提示"),content:z(N)("確定要打印小票嗎？"),onConfirm:ce},null,8,["show","title","content"])])),_:1})])),_:1})}}},[["__scopeId","data-v-f10cbb49"]]);export{le as default};
