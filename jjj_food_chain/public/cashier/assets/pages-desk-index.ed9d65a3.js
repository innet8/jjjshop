import{ak as e,_ as t,m as l,p as a,r as u,K as i,b as s,L as o,M as d,o as n,d as c,w as r,e as v,f as _,t as p,u as f,$ as m,y,j as h,J as b,N as g,O as w,P as k,Q as I,R as x,W as C,X as $,Z as P,i as N,a0 as L,a1 as S,a2 as D,al as U,S as V,T as O,U as j,V as B,am as T,c as K,a6 as H,a as M,a7 as z,a8 as A,a9 as Z,aa as E,n as F,ab as R,H as J,an as Q,ao as W,ae as X,af as q,ag as G,ah as Y,ai as ee,aj as te}from"./index-6c29f7e3.js";import{f as le,a as ae,k as ue,m as ie,n as se,p as oe}from"./product.edf70330.js";const de=t({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const b=e,g=l(!1),w=l("");a((()=>b.show),(()=>{b.show&&(w.value="")}));const k=e=>{e&&(w.value+=e)},I=async()=>{var e;if(w.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{g.value=!0;const l=await le({order_product_id:null==(e=b.productItem)?void 0:e.order_product_id,price:w.value});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{g.value=!1}};return(l,a)=>{const y=h,x=u(s("ti-input"),i),C=u(s("ti-keyboard"),o),$=u(s("ti-modal"),d);return n(),c($,{show:b.show,title:f(m)("價格")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-modify-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-modify-input"},{default:r((()=>[v(x,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),placeholder:f(m)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(C,{primaryLoading:g.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:a[1]||(a[1]=e=>t("update:show",!1)),onClear:a[2]||(a[2]=e=>w.value=""),onInput:k,onConfirm:I},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-24206eab"]]),ne=t({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const i=e,o=l(!1),w=l("");a((()=>i.show),(()=>{var e;i.show&&(w.value=(null==(e=i.productItem)?void 0:e.remark)||"")}));const k=async()=>{var e;if(!w.value)return y({title:m("请输入備註"),icon:"none"});try{o.value=!0;const l=await ae({order_product_id:null==(e=i.productItem)?void 0:e.order_product_id,remark:w.value.trim()});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{o.value=!1}};return(l,a)=>{const y=h,I=g,x=u(s("ti-button"),b),C=u(s("ti-modal"),d);return n(),c(C,{show:i.show,title:f(m)("備註")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-remark-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-remark-textarea"},{default:r((()=>[v(I,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:f(m)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),v(y,{class:"ti-remark-num"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(x,{onClick:a[1]||(a[1]=e=>t("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(x,{onClick:a[2]||(a[2]=e=>w.value="")},{default:r((()=>[_(p(f(m)("清空")),1)])),_:1}),v(x,{loading:o.value,type:"primary",onClick:k},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-500f020d"]]),ce=t({__name:"withdrawal",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(t,{emit:b}){const g=t,C=l(!1),$=l(""),P=l([m("等待時間長"),m("口味不好"),m("菜賣光了")]),N=l(0);a((()=>g.show),(()=>{var e;g.show&&($.value=(null==(e=g.productItem)?void 0:e.total_num)||"")}));const L=e=>{e&&($.value+=e)},S=async()=>{var t,l;if($.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{C.value=!0;const a=await(l={table_id:g.tableId,order_product_id:null==(t=g.productItem)?void 0:t.order_product_id,num:$.value,return_reason:P.value[N.value]},e("order.HallCart/moveProduct",l));1==a.code&&(y({title:a.msg,icon:"none"}),b("update:show",!1),b("success"))}catch(a){}finally{C.value=!1}};return(e,l)=>{const a=h,y=u(s("ti-input"),i),D=u(s("ti-keyboard"),o),U=u(s("ti-modal"),d);return n(),c(U,{show:g.show,title:f(m)("退菜")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-withdrawal-title text-ellipsis"},{default:r((()=>{var e,l,a;return[_(p((null==(e=t.productItem)?void 0:e.product_name_text)||(null==(a=null==(l=t.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(a,{class:"ti-withdrawal-list"},{default:r((()=>[(n(!0),w(k,null,I(P.value,((e,t)=>(n(),c(a,{key:t,class:x([{active:t==N.value},"ti-withdrawal-item"]),onClick:e=>(e=>{N.value=e})(t)},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(a,{class:"ti-withdrawal-input"},{default:r((()=>[v(y,{modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=e=>$.value=e),placeholder:f(m)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(D,{primaryLoading:C.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[1]||(l[1]=e=>b("update:show",!1)),onClear:l[2]||(l[2]=e=>$.value=""),onInput:L,onConfirm:S},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-bac324e2"]]),re=t({__name:"preferential",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},totalPayPrice:{type:[Number,String],default:0}},emits:["update:show","success"],setup(t,{emit:g}){const U=t,V=l({type:1,money:"",rate:"",discountType:1}),O=l(!1);a((()=>U.show),(()=>{V.value={type:1,money:"",rate:"",discountType:1}})),a((()=>V.value.type),((e,t)=>{1==t?V.value.money="":2==t?V.value.rate="":3==t&&(V.value.discountType=1)}));const j=e=>{V.value.discountType=e.detail.value},B=()=>{1==V.value.type?V.value.money="":2==V.value.type&&(V.value.rate="")},T=e=>{e&&(1==V.value.type?V.value.money+=e:2==V.value.type&&(V.value.rate+=e))},K=async()=>{const t={...V.value,table_id:U.tableId};if(!O.value){if(1==t.type){if(t.money<=0)return y({title:m("请输入實付價格"),icon:"none"})}else if(2==t.type&&t.rate<=0)return y({title:m("请输入優惠折扣"),icon:"none"});try{O.value=!0;const l=await function(t){return e("order.HallCart/changeMoney",t)}(t);y({title:l.msg,icon:"none"}),g("update:show",!1),g("success")}catch(l){}finally{O.value=!1}}};return(e,l)=>{const a=h,y=N,H=u(s("ti-input"),i),M=L,z=S,A=D,Z=u(s("ti-button"),b),E=u(s("ti-keyboard"),o),F=u(s("ti-modal"),d);return n(),c(F,{show:U.show,title:f(m)("優惠折扣")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-preferential-box"},{default:r((()=>[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("當前價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(y,{class:"ti-preferential-price"},{default:r((()=>[_(p(f(C)(t.totalPayPrice)),1)])),_:1}),v(y,{class:"ti-preferential-subPrice"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠方式")),1)])),_:1}),v(a,{class:"ti-preferential-input ti-preferential-type"},{default:r((()=>[(n(!0),w(k,null,I([f(m)("改價"),f(m)("折扣"),f(m)("抹零")],((e,t)=>(n(),c(a,{key:t,class:x([{active:V.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>V.value.type=t+1},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==V.value.type?(n(),w(k,{key:0},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("實付價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(H,{modelValue:V.value.money,"onUpdate:modelValue":l[0]||(l[0]=e=>V.value.money=e),placeholder:f(m)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):P("",!0),2==V.value.type?(n(),w(k,{key:1},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(H,{modelValue:V.value.rate,"onUpdate:modelValue":l[1]||(l[1]=e=>V.value.rate=e),placeholder:f(m)("请输入優惠折扣"),focus:!0},{right:r((()=>[v(a,{class:"ti-preferential-percentage"},{default:r((()=>[_("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):P("",!0),3==V.value.type?(n(),w(k,{key:2},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("抹零方式")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(A,{class:"ti-type-radio",onChange:j},{default:r((()=>[v(z,null,{default:r((()=>[v(M,{value:"1",color:"#ffbe00",checked:"true"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹分")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"2",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"3",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"4",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到元")),1)])),_:1})])),_:1})])),_:1})])),_:1})],64)):P("",!0)])),_:1})])),_:1})])),footer:r((()=>[3==V.value.type?(n(),c(a,{key:0,class:"ti-dialog-btn"},{default:r((()=>[v(Z,{onClick:l[2]||(l[2]=e=>g("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(Z,{loading:O.value,type:"primary",onClick:K},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})):(n(),c(a,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:r((()=>[v(E,{primaryLoading:O.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[3]||(l[3]=e=>g("update:show",!1)),onClear:B,onInput:T,onConfirm:K},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},[["__scopeId","data-v-c0e692fb"]]),ve=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),U(),setTimeout((()=>{a("success")}),100)}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=V,b=u(s("ti-modal"),d);return n(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.sendKitchen&&t.sendKitchen.length>0?(n(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(n(!0),w(k,null,I(i.sendKitchen,((e,t)=>(n(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(n(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-53674ff5"]]);function _e(t){return e("store.table/table",t)}const pe=t({__name:"turntable",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},tableNo:{type:[Number,String],default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,d=l({table_status:"10"}),b=l(!1),g=l(!1),C=l([]),$=l(),P=l(!1);a((()=>o.show),(()=>{o.show&&($.value=null,L())}));const N=async t=>{if(!P.value){if(!$.value)return y({title:m("请选择桌号"),icon:"none"});try{P.value=!0;const t=await(l={old_table_id:o.tableId,new_table_id:$.value},e("order.order/changeTable",l));y({title:t.msg,icon:"none"}),i("update:show",!1),T($.value),setTimeout((()=>{i("success")}),100)}catch(a){}finally{P.value=!1}var l}},L=()=>{d.value.page=1,D(!0)},S=()=>{b.value&&(d.value.page+=1,D())},D=async e=>{var t;if(!g.value)try{e&&(g.value=!0);const l=await _e(d.value);C.value=(null==(t=l.data)?void 0:t.list)||[]}catch(l){}finally{e&&(g.value=!1)}};return(e,t)=>{const l=u(s("ti-loading"),O),a=h,d=u(s("ti-empty-data"),j),y=V,L=u(s("ti-drawer"),B);return n(),c(L,{show:o.show,confirmLoading:P.value,title:`[${o.tableNo}]${f(m)("轉台")}`,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:N},{content:r((()=>[v(a,{class:"ti-turntable-box"},{default:r((()=>[v(y,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:S},{default:r((()=>[g.value?(n(),c(l,{key:0})):C.value&&C.value.length>0?(n(),w(k,{key:1},[v(a,{class:"ti-turntable-list"},{default:r((()=>[(n(!0),w(k,null,I(C.value,(e=>(n(),c(a,{key:e.table_id,class:x([{active:$.value==e.table_id},"ti-turntable-item"]),onClick:t=>$.value=e.table_id},{default:r((()=>[_(p(e.table_no),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:b.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(d,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","confirmLoading","title"])}}},[["__scopeId","data-v-1e54f37e"]]),fe=t({__name:"open-table",props:{show:{type:Boolean,default:!1},tableNo:{type:String,default:null},tableId:{type:[Number,String],default:null},isUpdate:{type:Boolean,default:!1}},emits:["update:show","success"],setup(t,{emit:_}){const p=t,b=l(!1),g=l("");a((()=>p.show),(()=>{p.show&&(g.value="")}));const w=e=>{e&&(g.value+=e)},k=async()=>{if(g.value<=0)return y({title:m("請輸入人數"),icon:"none"});try{b.value=!0;const a=await(t={table_id:p.tableId,meal_num:g.value},l=p.isUpdate,e(l?"order.Order/updateMealNum":"order.Order/tableBuy",t));1==a.code&&(y({title:a.msg,icon:"none"}),T(p.tableId),_("update:show",!1),setTimeout((()=>{_("success")}),100))}catch(a){}finally{b.value=!1}var t,l};return(e,t)=>{const l=u(s("ti-input"),i),a=h,y=u(s("ti-keyboard"),o),I=u(s("ti-modal"),d);return n(),c(I,{show:p.show,title:`[${p.tableNo}]${f(m)("就餐人數")}`},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-modify-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:f(m)("請輸入人數"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(y,{primaryLoading:b.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:t[1]||(t[1]=e=>_("update:show",!1)),onClear:t[2]||(t[2]=e=>g.value=""),onInput:w,onConfirm:k},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-b18daf9d"]]),me=t({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},tableNo:{type:[Number,String],default:null},tableId:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0}},emits:["success","change"],setup(t,{emit:a}){const i=t,o=K((()=>i.orderList&&i.orderList.length>0));K((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)>0))));const c=K((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)<=0)))),b=l(!1),g=l(!1),I=l(!1),x=l(!1),C=l(!1),$=l(!1),P=l(!1),L=l(!1),S=l(!1),D=l(!1),V=l(!1),O=()=>{U(),setTimeout((()=>{a("change")}),100)},j=async()=>{var t,l;if(!g.value)try{g.value=!0;const u=await(l={order_product_id:null==(t=i.productItem)?void 0:t.order_product_id},e("order.HallCart/delProduct",l));y({title:u.msg,icon:"none"}),a("success")}catch(u){}finally{b.value=!1,g.value=!1}},B=async()=>{var t;if(!x.value)try{x.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/sendKitchen",t,{isLoading:!1}));y({title:l.msg,icon:"none"}),a("success"),I.value=!1}catch(l){I.value=!1}finally{x.value=!1}};return(e,l)=>{const y=N,U=H,T=h,K=u(s("ti-modal"),d);return n(),w(k,null,[v(T,{class:"ti-action-box"},{default:r((()=>[v(T,{class:"ti-action-btn"},{default:r((()=>[v(T,{class:"ti-btn-box"},{default:r((()=>{var e,a,u;return[v(U,{class:"ti-btn-item",disabled:!1,onClick:O},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("返回")),1)])),_:1})])),_:1}),v(U,{class:"ti-btn-item danger",disabled:!(t.productItem&&0==(null==(e=t.productItem)?void 0:e.is_send_kitchen)),onClick:l[0]||(l[0]=e=>b.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("删除")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item",disabled:0!=(null==(a=t.productItem)?void 0:a.is_send_kitchen),onClick:l[1]||(l[1]=e=>P.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("备注")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item",disabled:!f(o),onClick:l[2]||(l[2]=e=>$.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("價格")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item",disabled:!1,onClick:l[3]||(l[3]=e=>D.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("人数")),1)])),_:1})])),_:1}),v(U,{class:"ti-btn-item",disabled:!1,onClick:l[4]||(l[4]=e=>V.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("转台")),1)])),_:1})])),_:1}),v(U,{class:"ti-btn-item",disabled:0==f(c).length,onClick:l[5]||(l[5]=e=>I.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("送廚")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item danger",disabled:!(t.productItem&&1==(null==(u=t.productItem)?void 0:u.is_send_kitchen)),onClick:l[6]||(l[6]=e=>L.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("退菜")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item danger",disabled:!f(o),onClick:l[7]||(l[7]=e=>C.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("清台")),1)])),_:1})])),_:1},8,["disabled"]),v(U,{class:"ti-btn-item",disabled:!f(o),onClick:l[8]||(l[8]=e=>S.value=!0)},{default:r((()=>[v(y,{class:"text-ellipsis"},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])]})),_:1})])),_:1})])),_:1}),v(K,{class:"ti-action-tips",show:b.value,"onUpdate:show":l[9]||(l[9]=e=>b.value=e),confirmLoading:g.value,title:f(m)("溫馨提示"),content:f(m)("是否删除此商品？"),onConfirm:j},null,8,["show","confirmLoading","title","content"]),v(K,{class:"ti-action-tips",show:I.value,"onUpdate:show":l[10]||(l[10]=e=>I.value=e),confirmLoading:x.value,title:f(m)("溫馨提示"),content:f(m)("是否将商品送廚？"),onConfirm:B},null,8,["show","confirmLoading","title","content"]),v(fe,{show:D.value,"onUpdate:show":l[11]||(l[11]=e=>D.value=e),isUpdate:!0,tableId:i.tableId,tableNo:i.tableNo,onSuccess:l[12]||(l[12]=e=>a("success"))},null,8,["show","tableId","tableNo"]),v(pe,{show:V.value,"onUpdate:show":l[13]||(l[13]=e=>V.value=e),tableId:i.tableId,tableNo:i.tableNo,onSuccess:l[14]||(l[14]=e=>a("success"))},null,8,["show","tableId","tableNo"]),v(ve,{show:C.value,"onUpdate:show":l[15]||(l[15]=e=>C.value=e),sendKitchen:i.sendKitchen,tableId:i.tableId,onSuccess:l[16]||(l[16]=e=>a("change"))},null,8,["show","sendKitchen","tableId"]),v(de,{show:$.value,"onUpdate:show":l[17]||(l[17]=e=>$.value=e),productItem:i.productItem,onSuccess:l[18]||(l[18]=e=>a("success"))},null,8,["show","productItem"]),v(ne,{show:P.value,"onUpdate:show":l[19]||(l[19]=e=>P.value=e),productItem:i.productItem,onSuccess:l[20]||(l[20]=e=>a("success"))},null,8,["show","productItem"]),v(ce,{show:L.value,"onUpdate:show":l[21]||(l[21]=e=>L.value=e),tableId:i.tableId,productItem:i.productItem,onSuccess:l[22]||(l[22]=e=>a("success"))},null,8,["show","tableId","productItem"]),v(re,{show:S.value,"onUpdate:show":l[23]||(l[23]=e=>S.value=e),tableId:i.tableId,productItem:i.productItem,totalPayPrice:t.totalPayPrice,onSuccess:l[24]||(l[24]=e=>a("success"))},null,8,["show","tableId","productItem","totalPayPrice"])],64)}}},[["__scopeId","data-v-4dbecd7b"]]),ye=t({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const a=e,i=l(!1),o=async e=>{var l,u;const s={order_product_id:null==(l=a.productItem)?void 0:l.order_product_id,product_num:null==(u=a.productItem)?void 0:u.total_num,type:e};"up"==e?s.product_num+=1:s.product_num-=1;try{i.value=!0;1==(await ue(s)).code&&t("change")}catch(o){}finally{i.value=!1}};return(e,t)=>{const l=u(s("uni-icons"),M),d=H,f=h;return n(),c(f,{class:"ti-number-box",onClick:t[2]||(t[2]=z((()=>{}),["stop"]))},{default:r((()=>{var e,u,s,n,c,m;return[v(d,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=a.productItem)?void 0:e.total_num)<=1||i.value||(null==(u=a.productItem)?void 0:u.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>o("down"))},{default:r((()=>[v(l,{"custom-prefix":"iconfont",type:"icon-minus",size:"16"})])),_:1},8,["disabled"]),v(f,{class:"ti-number-input"},{default:r((()=>{var e;return[_(p((null==(e=a.productItem)?void 0:e.total_num)||1),1)]})),_:1}),v(d,{class:"ti-number-btn ti-number-plus",disabled:(null==(s=a.productItem)?void 0:s.total_num)>=(null==(c=null==(n=a.productItem)?void 0:n.product)?void 0:c.product_stock)||i.value||(null==(m=a.productItem)?void 0:m.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>o("up"))},{default:r((()=>[v(l,{type:"plusempty",size:"16"})])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-cdd7204f"]]);const he=t({__name:"member",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null}},emits:["update:show","change"],setup(e,{emit:t}){const m=e,y=l(!1),g=l(""),w=l({}),k=l(!1);a((()=>m.show),(()=>{m.show&&(g.value="",w.value={})}));const I=()=>{t("update:show",!1),t("change",null)},x=e=>{e&&(g.value+=e)},L=async()=>{try{y.value=!0;const e=await A({mobile:g.value,table_id:m.tableId});w.value={...e.data.user,pay_price:e.data.total_product_pay_price}}catch(e){}finally{y.value=!1}},S=async()=>{var e;try{k.value=!0;await Z({order_id:m.orderId,user_id:(null==(e=w.value)?void 0:e.user_id)||0});t("update:show",!1),t("change",w.value)}catch(l){}finally{k.value=!1}};return(e,t)=>{const l=u(s("ti-input"),i),a=u(s("ti-button"),b),D=h,U=N,V=u(s("ti-keyboard"),o),O=u(s("ti-modal"),d);return n(),c(O,{show:m.show,title:e.$t("会员")},{content:r((()=>[v(D,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(D,{class:"ti-payment-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:e.$t("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),v(a,{loading:y.value,type:"primary",onClick:L},{default:r((()=>[_(p(e.$t("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(u=w.value)?void 0:u.user_id)?(n(),c(D,{key:0,class:"ti-payment-member"},{default:r((()=>[v(D,{class:"ti-member-list"},{default:r((()=>[v(D,{class:"ti-member-item"},{default:r((()=>[v(D,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(D,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=w.value)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(D,{class:"ti-member-item"},{default:r((()=>[v(D,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(D,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=w.value)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=w.value)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(D,{class:"ti-member-item"},{default:r((()=>[v(D,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(D,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(D,{class:"ti-member-item"},{default:r((()=>[v(D,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(D,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),v(D,{class:"ti-member-discount"},{default:r((()=>[v(U,{class:"ti-discount-title"},{default:r((()=>[_(p(e.$t("會員折扣應收金額")),1)])),_:1}),v(U,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=w.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(U,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=w.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):P("",!0)]})),_:1})])),footer:r((()=>[v(D,{class:"ti-dialog-btn"},{default:r((()=>[v(V,{primaryLoading:k.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:I,onClear:t[1]||(t[1]=e=>g.value=""),onInput:x,onConfirm:S},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-5abdb3a0"]]),be=t({__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},tableId:{type:[Number,String],default:null},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show","success","change"],setup(t,{emit:i}){const o=t,m=l(!1);l({});const g=l([]),V=l({delivery:40,pay_type:"40",user_id:null,table_id:null}),O=l(!1),B=l(!1);a((()=>o.show),(()=>{o.show&&(g.value=[],V.value.pay_type="40")})),a((()=>V.value.pay_type),(()=>{o.show&&(V.value.pay_type>0||(g.value&&g.value.length>0?V.value.pay_type=g.value[0].value:E().then((e=>{g.value=e.data||[],V.value.pay_type=g.value[0].value}))))}));const T=async()=>{try{await Z({order_id:o.orderId,user_id:0});i("success")}catch(e){}},K=e=>{V.value.pay_type=e.detail.value},H=async()=>{if(!B.value)try{B.value=!0;const e=await R({order_id:o.orderId});y({title:e.msg,icon:"none"})}catch(e){}finally{B.value=!1}},M=async()=>{var t;if(O.value)return;const l={...V.value};l.table_id=o.tableId,l.user_id=null==(t=o.memberDetail)?void 0:t.user_id;try{O.value=!0;const t=await function(t){return e("order.order/pay",t)}(l);y({title:t.msg,icon:"none"}),i("update:show",!1),U(),setTimeout((()=>{i("change")}),100)}catch(a){}finally{O.value=!1}};return(e,l)=>{const a=N,y=h,U=L,z=S,A=D,Z=J,E=u(s("ti-empty-data"),j),R=u(s("ti-button"),b),Q=u(s("ti-modal"),d);return n(),c(Q,{show:o.show,title:e.$t("結賬")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(y,{class:"ti-payment-money"},{default:r((()=>[v(a,{class:"ti-payment-label"},{default:r((()=>[_(p(e.$t("應收金額")),1)])),_:1}),v(a,{class:"ti-payment-price"},{default:r((()=>[_(p(f(C)(t.totalPayPrice)),1)])),_:1}),v(a,{class:"ti-payment-subPrice"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(y,{class:"ti-payment-type"},{default:r((()=>[v(y,{class:"ti-type-label"},{default:r((()=>[_(p(e.$t("收款方式")),1)])),_:1}),v(A,{class:"ti-type-radio",onChange:K},{default:r((()=>[v(z,null,{default:r((()=>[v(U,{value:"40",color:"#ffbe00",checked:"true"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("現金")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(U,{value:"10",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(U,{value:"",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("其他方式")),1)])),_:1})])),_:1})])),_:1})])),_:1}),"40"!=V.value.pay_type&&"10"!=V.value.pay_type?(n(),c(y,{key:0,class:"ti-payment-other"},{default:r((()=>[v(y,{class:"ti-other-title"},{default:r((()=>[_(p(e.$t("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),g.value&&g.value.length>0?(n(),c(y,{key:0,class:"ti-other-list"},{default:r((()=>[(n(!0),w(k,null,I(g.value,(e=>(n(),c(y,{key:e.value,class:x([{active:e.value==V.value.pay_type},"ti-other-item"]),onClick:t=>V.value.pay_type=e.value},{default:r((()=>[v(y,{class:"ti-other-image"},{default:r((()=>{var t;return[v(Z,{src:`${(null==(t=f(F)())?void 0:t.api_url)||""}/${e.img}`,mode:"widthFix"},null,8,["src"])]})),_:2},1024),v(y,{class:"ti-other-text"},{default:r((()=>[_(p(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(n(),c(E,{key:1}))])),_:1})):P("",!0),(null==(u=o.memberDetail)?void 0:u.user_id)?(n(),c(y,{key:1,class:"ti-payment-member"},{default:r((()=>[v(y,{class:"ti-payment-top"},{default:r((()=>[v(y,{class:"ti-payment-top-name"},{default:r((()=>[_(p(e.$t("會員")),1)])),_:1}),v(y,{class:"ti-payment-top-discomfort",onClick:T},{default:r((()=>[_(p(e.$t("不使用此會員")),1)])),_:1})])),_:1}),v(y,{class:"ti-member-list"},{default:r((()=>[v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=o.memberDetail)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=o.memberDetail)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=o.memberDetail)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=o.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(y,{class:"ti-member-name text-ellipsis"},{default:r((()=>{var e;return[_(p((null==(e=o.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),v(y,{class:"ti-member-discount"},{default:r((()=>[v(a,{class:"ti-discount-title"},{default:r((()=>[_(p(e.$t("會員折扣應收金額")),1)])),_:1}),v(a,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=o.memberDetail)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(a,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=o.memberDetail)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):P("",!0),v(he,{show:m.value,"onUpdate:show":l[0]||(l[0]=e=>m.value=e),tableId:o.tableId,onChange:l[1]||(l[1]=e=>i("success"))},null,8,["show","tableId"])]})),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(R,{onClick:l[2]||(l[2]=e=>i("update:show",!1))},{default:r((()=>[_(p(e.$t("退出")),1)])),_:1}),v(R,{loading:B.value,onClick:H},{default:r((()=>[_(p(e.$t("打印")),1)])),_:1},8,["loading"]),v(R,{onClick:l[3]||(l[3]=e=>m.value=!0)},{default:r((()=>[_(p(e.$t("会员")),1)])),_:1}),v(R,{loading:O.value,type:"primary",onClick:M},{default:r((()=>[_(p(e.$t("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-7592d95c"]]),ge=t({__name:"time-meter",props:{tableDetail:{type:Object,default:()=>({})}},setup(e){const t=e,u=l(),i=l(),s=l(`00 ${m("分钟")} 00 ${m("秒")}`);a((()=>{var e;return null==(e=t.tableDetail)?void 0:e.elapsed_time}),(()=>{var e;i.value=null==(e=t.tableDetail)?void 0:e.elapsed_time,i.value>0&&(u.value&&clearInterval(u.value),u.value=setInterval((()=>{i.value++,o(i.value)}),1e3))}),{deep:!0}),Q((()=>{u.value&&clearInterval(u.value)}));const o=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";t>0&&(u+=`${d(t)} ${m("小时")} `),u+=`${d(l)} ${m("分钟")} ${d(a)} ${m("秒")}`,s.value=u},d=e=>e<10?`0${e}`:e;return(e,l)=>{const a=h;return n(),c(a,{class:"ti-table-info"},{default:r((()=>[v(a,{class:"ti-table-num"},{default:r((()=>{var e,l;return[_(p(`${(null==(e=t.tableDetail)?void 0:e.table_no)||""} (${(null==(l=t.tableDetail)?void 0:l.meal_num)||0})`),1)]})),_:1}),v(a,{class:"ti-table-time"},{default:r((()=>[_(p(f(m)("已就餐："))+p(s.value),1)])),_:1})])),_:1})}}},[["__scopeId","data-v-72effccd"]]),we=t({__name:"cart-list",emits:["change"],setup(t,{expose:a,emit:i}){const o=l(),d=l(!1),y=l(!1),b=l({}),g=l({}),L=l(),S=l([]),D=l(),U=l({table_no:"",meal_num:"",elapsed_time:""}),B=()=>{d.value=!0},T=async t=>{var l,a,u,i,s,d,n,c,r,v,_,p,f,m,h,w,k,I;try{t&&(y.value=!0);const x=await(I={table_id:W()},e("order.HallCart/tableProductList",I,{isLoading:!1}));if(D.value=W(),L.value=x.data.order_id,U.value={table_no:null==(u=null==(a=null==(l=x.data)?void 0:l.allProductInfo)?void 0:a.orderInfo)?void 0:u.table_no,meal_num:null==(d=null==(s=null==(i=x.data)?void 0:i.allProductInfo)?void 0:s.orderInfo)?void 0:d.meal_num,elapsed_time:null==(r=null==(c=null==(n=x.data)?void 0:n.allProductInfo)?void 0:c.orderInfo)?void 0:r.elapsed_time},g.value=null==(_=null==(v=x.data)?void 0:v.allProductInfo)?void 0:_.sumInfo,S.value=(null==(m=null==(f=null==(p=x.data)?void 0:p.allProductInfo)?void 0:f.orderInfo)?void 0:m.product)||[],S.value&&S.value.length>0){let e=0;(null==(h=b.value)?void 0:h.order_product_id)&&(e=S.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=b.value)?void 0:t.order_product_id)}))),b.value=S.value[Math.max(e,0)],o.value=null==(k=null==(w=x.data)?void 0:w.allProductInfo)?void 0:k.userInfo}else b.value=null,o.value=null}catch(x){}finally{t&&(y.value=!1)}};return T(!0),a({getCartData:T}),(e,t)=>{var l,a;const K=h,M=u(s("ti-loading"),O),z=N,A=u(s("ti-empty-data"),j),Z=V,E=H;return n(),w(k,null,[v(K,{class:"ti-cart-box"},{default:r((()=>[v(ge,{tableDetail:U.value},null,8,["tableDetail"]),v(K,{class:"ti-cart-list"},{default:r((()=>[v(K,{class:"ti-cart-shop-head"},{default:r((()=>[v(K,{class:"ti-shop-head-title"},{default:r((()=>[_(p(f(m)("商品名稱")),1)])),_:1}),v(K,{class:"ti-shop-head-money"},{default:r((()=>[_(p(f(m)("金額")),1)])),_:1}),v(K,{class:"ti-shop-head-num"},{default:r((()=>[_(p(f(m)("數量")),1)])),_:1})])),_:1}),v(K,{class:"ti-shop-list"},{default:r((()=>[v(Z,{"scroll-y":""},{default:r((()=>[y.value?(n(),c(M,{key:0})):S.value&&S.value.length>0?(n(),c(K,{key:1,class:"ti-shop-box"},{default:r((()=>[(n(!0),w(k,null,I(S.value,(e=>{var l;return n(),c(K,{key:e,class:x([{active:(null==(l=b.value)?void 0:l.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:t=>(e=>{var t;(null==(t=b.value)?void 0:t.order_product_id)!=(null==e?void 0:e.order_product_id)&&(b.value=e)})(e)},{default:r((()=>[v(K,{class:"ti-shop-item-box"},{default:r((()=>[v(K,{class:"ti-shop-box"},{default:r((()=>[v(K,{class:"ti-shop-body-top"},{default:r((()=>[v(K,{class:"ti-shop-title text-ellipsis"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),e.product_attr?(n(),c(K,{key:0,class:"ti-shop-spec"},{default:r((()=>[_("( "+p(e.product_attr)+" )",1)])),_:2},1024)):P("",!0)])),_:2},1024),v(K,{class:"ti-shop-body-money"},{default:r((()=>[v(z,{class:"ti-shop-price"},{default:r((()=>[_(p(f(C)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(z,{class:"ti-shop-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),v(ye,{productItem:e,onChange:t[0]||(t[0]=e=>T())},null,8,["productItem"])])),_:2},1024),e.remark?(n(),c(K,{key:0,class:"ti-shop-remark"},{default:r((()=>[_(p(e.remark),1)])),_:2},1024)):P("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(n(),c(A,{key:2}))])),_:1})])),_:1})])),_:1}),v(K,{class:"ti-cart-statistics"},{default:r((()=>[v(K,{class:"ti-cart-total"},{default:r((()=>[v(z,{class:"ti-total-text"},{default:r((()=>[_(p(f(m)("小計:")),1)])),_:1}),v(z,{class:"ti-total-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=g.value)?void 0:e.subtotal)||0)),1)]})),_:1}),v(z,{class:"ti-total-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),v(K,{class:"ti-cart-discount"},{default:r((()=>[v(K,{class:"ti-discount-item"},{default:r((()=>[v(K,null,{default:r((()=>[v(z,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("服務費:")),1)])),_:1}),v(z,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=g.value)?void 0:e.service_money)||0)),1)]})),_:1}),v(z,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),v(K,null,{default:r((()=>{var e;return[v(z,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("優惠折扣:")),1)])),_:1}),v(z,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f(C)((null==(e=g.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),f($)((null==(e=g.value)?void 0:e.special_discount)||0)?(n(),c(z,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=g.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):P("",!0)]})),_:1})])),_:1}),v(K,{class:"ti-discount-item"},{default:r((()=>[v(K,null,{default:r((()=>[v(z,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("消費稅:")),1)])),_:1}),v(z,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=g.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),v(z,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),v(K,null,{default:r((()=>{var e;return[v(z,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("會員折扣:")),1)])),_:1}),v(z,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f(C)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),f($)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)?(n(),c(z,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=g.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):P("",!0)]})),_:1})])),_:1})])),_:1}),v(K,{class:"ti-cart-settlement"},{default:r((()=>[v(K,{class:"ti-settlement-total"},{default:r((()=>[v(z,{class:"ti-settlement-text"},{default:r((()=>[_(p(f(m)("應收：")),1)])),_:1}),v(z,{class:"ti-settlement-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=g.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(z,{class:"ti-settlement-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),v(E,{class:"ti-settlement-btn",disabled:S.value.length<=0,onClick:B},{default:r((()=>[v(z,null,{default:r((()=>[_(p(f(m)("結賬")),1)])),_:1}),S.value.length>0?(n(),c(z,{key:0,class:"ti-settlement-badge"},{default:r((()=>[_(p(S.value.length),1)])),_:1})):P("",!0)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),v(me,{productItem:b.value,totalPayPrice:null==(l=g.value)?void 0:l.total_pay_price,tableId:D.value,tableNo:U.value.table_no,orderList:S.value,onChange:t[1]||(t[1]=e=>i("change")),onSuccess:t[2]||(t[2]=e=>T())},null,8,["productItem","totalPayPrice","tableId","tableNo","orderList"]),v(be,{show:d.value,"onUpdate:show":t[3]||(t[3]=e=>d.value=e),totalPayPrice:null==(a=g.value)?void 0:a.total_pay_price,orderId:L.value,tableId:D.value,memberDetail:o.value,onChange:t[4]||(t[4]=e=>i("change")),onSuccess:t[5]||(t[5]=e=>T())},null,8,["show","totalPayPrice","orderId","tableId","memberDetail"])],64)}}},[["__scopeId","data-v-be3c0a38"]]),ke=t({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(e,{emit:t}){const u=e,i=l(0),s=l(0),o=l([]);a((()=>u.list),(async e=>{if(await X(),!e||0==e.length)return;const t=q().in(this);if(e.map(((e,l)=>{t.select(`#scroll-item-${l}`).boundingClientRect((e=>{if(!e)return;const t=o.value;t[l]=e.width+10,o.value=t})).exec()})),u.menuId>0){const e=u.list.findIndex((e=>e.category_id==u.menuId));e>-1&&d(e)}}),{deep:!0,immediate:!0});const d=e=>{s.value=e,i.value=o.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(o.value[e]+100),t("update:menuId",u.list[e].category_id)};return(e,t)=>{const l=N,a=h,o=V;return n(),c(o,{class:"ti-dish-menu","scroll-left":i.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:r((()=>[v(a,{class:"ti-menu-content"},{default:r((()=>[(n(!0),w(k,null,I(u.list,((e,t)=>(n(),c(a,{key:t,class:x(["ti-menu-item",{active:t==s.value}]),id:`scroll-item-${t}`,onClick:e=>d(t)},{default:r((()=>[v(l,{class:"ti-menu-title"},{default:r((()=>[_(p(e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-384c1800"]]),Ie=t({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId"],setup(e,{emit:t}){const u=l([]),i=l(0),s=l(0),o=K((()=>{let e=(u.value.find((e=>e.category_id==i.value))||{}).child||[];return e&&e.length>0&&(e=[{name_text:m("全部"),category_id:0}].concat(e)),e}));a((()=>i.value),(()=>{t("update:categoryId",i.value),o&&o.length>0&&(s.value=o.value[0].category_id)}));return(async()=>{try{const e=await ie();e.data.list&&(u.value=[{name_text:m("全部"),category_id:0}].concat(e.data.list),i.value=u.value[0].category_id)}catch(e){}})(),(e,l)=>{const a=h;return n(),c(a,{class:"ti-category-box"},{default:r((()=>[v(ke,{list:u.value,menuId:i.value,"onUpdate:menuId":l[0]||(l[0]=e=>i.value=e)},null,8,["list","menuId"]),v(a,{class:"ti-dish-secondary"},{default:r((()=>[(n(!0),w(k,null,I(f(o),((e,l)=>(n(),c(a,{key:l,class:x([{active:e.category_id==s.value},"ti-secondary-item"]),onClick:l=>{return a=e.category_id,s.value=a,void t("update:categoryId",s.value>0?s.value:i.value);var a}},{default:r((()=>[_(p(e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-ebcc8dbd"]]),xe=t({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,b=l({}),g=l(!1),L=l(!1),S=l({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:40,describe:null});a((()=>o.show),(()=>{o.show&&D()}));const D=async()=>{var e,t,l,a,u,i,s,d,n;if(!g.value||o.productId)try{g.value=!0;const c=await se(o.productId);b.value=c.data,S.value.product_id=null==(e=b.value)?void 0:e.product_id,S.value.price=null==(t=b.value)?void 0:t.product_price,S.value.product_price=null==(l=b.value)?void 0:l.product_price,(null==(a=b.value)?void 0:a.sku)&&(null==(u=b.value)?void 0:u.sku.length)>0&&(S.value.product_sku_id=null==(i=b.value)?void 0:i.sku[0].product_sku_id),(null==(s=b.value)?void 0:s.product_attr)&&(null==(d=b.value)?void 0:d.product_attr.length)>0&&(null==(n=b.value)||n.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?S.value.attr[t]=0:S.value.attr[t]=null}))),S.value.feed&&S.value.feed.length>0&&(S.value.feed=[])}catch(c){}finally{g.value=!1}},U=async()=>{var t,l,a,u,s,o,d,n,c;if(L.value)return;const r={...S.value};r.attr=r.attr.join(","),r.feed=r.feed.join(",");let v=[];if((null==(t=b.value)?void 0:t.sku)&&(null==(l=b.value)?void 0:l.sku.length)>0){const e=null==(a=b.value)?void 0:a.sku.find((e=>e.product_sku_id==S.value.product_sku_id));r.price=(null==e?void 0:e.product_price)||0,(null==e?void 0:e.spec_name_text)&&v.push(null==e?void 0:e.spec_name_text)}(null==(u=b.value)?void 0:u.product_attr)&&(null==(s=b.value)?void 0:s.product_attr.length)&&(null==(o=b.value)||o.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0&&(null==e?void 0:e.attribute_value_text[S.value.attr[t]])&&v.push(null==e?void 0:e.attribute_value_text[S.value.attr[t]])}))),(null==(d=b.value)?void 0:d.product_feed)&&(null==(n=b.value)?void 0:n.product_feed.length)>0&&(null==(c=b.value)||c.product_feed.map(((e,t)=>{O(t)&&(v.push(e.feed_name_text),r.price=G(r.price,null==e?void 0:e.price))}))),r.describe=v.join(";"),r.table_id=W();try{L.value=!0;const t=await function(t){return e("order.HallCart/add",t)}(r);1==t.code&&(y({title:t.msg,icon:"none"}),i("update:show",!1),i("success"))}catch(_){}finally{L.value=!1}},O=e=>S.value.feed.indexOf(e)>-1,j=(e,t)=>S.value.attr[e]==t;return(e,t)=>{const l=J,a=h,y=N,g=V,D=u(s("ti-modal"),d);return n(),c(D,{show:o.show,title:f(m)("商品详情"),confirmLoading:L.value,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:U},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-detail-box"},{default:r((()=>[v(a,{class:"ti-detail-image"},{default:r((()=>{var e,t,a,u;return[(null==(e=b.value)?void 0:e.image)&&(null==(t=b.value)?void 0:t.image[0])&&(null==(a=b.value)?void 0:a.image[0].file_path)?(n(),c(l,{key:0,src:null==(u=b.value)?void 0:u.image[0].file_path,mode:"widthFix"},null,8,["src"])):P("",!0)]})),_:1}),v(a,{class:"ti-detail-con"},{default:r((()=>[v(a,{class:"ti-detail-title text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_name_text),1)]})),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單價：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(f(C)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1}),v(y,{class:"ti-detail-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單位：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),v(a,{class:"ti-detail-specs"},{default:r((()=>[v(g,{"scroll-y":""},{default:r((()=>[v(a,{class:"ti-specs-box"},{default:r((()=>{var e,t,l,u,i,s,o;return[(null==(e=b.value)?void 0:e.sku)&&(null==(t=b.value)?void 0:t.sku.length)>0?(n(),c(a,{key:0,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("規格")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(n(!0),w(k,null,I(null==(e=b.value)?void 0:e.sku,(e=>(n(),c(a,{key:e.product_sku_id,class:x([{active:e.product_sku_id==S.value.product_sku_id},"ti-child-item"]),onClick:t=>{return l=e.product_sku_id,void(S.value.product_sku_id!=l&&(S.value.product_sku_id=l));var l}},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.spec_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f(C)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):P("",!0),(null==(l=b.value)?void 0:l.product_attr)&&(null==(u=b.value)?void 0:u.product_attr.length)>0?(n(!0),w(k,{key:1},I(null==(i=b.value)?void 0:i.product_attr,((e,t)=>(n(),c(a,{key:t,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(e.attribute_name_text),1)])),_:2},1024),v(a,{class:"ti-specs-child"},{default:r((()=>[(n(!0),w(k,null,I(null==e?void 0:e.attribute_value_text,((e,l)=>(n(),c(a,{key:l,class:x([{active:j(t,l)},"ti-child-item"]),onClick:e=>((e,t)=>{S.value.attr[e]=t})(t,l)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):P("",!0),(null==(s=b.value)?void 0:s.product_feed)&&(null==(o=b.value)?void 0:o.product_feed.length)>0?(n(),c(a,{key:2,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("加料")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(n(!0),w(k,null,I(null==(e=b.value)?void 0:e.product_feed,((e,t)=>(n(),c(a,{key:t,class:x([{active:O(t)},"ti-child-item"]),onClick:e=>(e=>{const t=S.value.feed.indexOf(e);t>=0?S.value.feed.splice(t,1):S.value.feed.push(e)})(t)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.feed_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f(C)((null==e?void 0:e.price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):P("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-abd800bc"]]),Ce=t({__name:"dish-list",emits:["success"],setup(e,{emit:t}){const i=l(!1),o=l({category_id:null,page:1,list_rows:20}),d=l([]),b=l(!1),g=l(),L=l(!1);a((()=>o.value.category_id),(()=>{U()}));const S=()=>{t("success")},D=()=>{L.value&&(o.value.page+=1,B())},U=()=>{o.value.page=1,B(!0)},B=async e=>{var t,l,a,u,i,s;if(b.value)return;const n={...o.value};n.category_id||(n.category_id=null);try{e&&(b.value=!0);const c=await oe(n);1==o.value.page&&(d.value=[]),d.value=d.value.concat((null==(l=null==(t=c.data)?void 0:t.list)?void 0:l.data)||[]),L.value=(null==(u=null==(a=c.data)?void 0:a.list)?void 0:u.last_page)>(null==(s=null==(i=c.data)?void 0:i.list)?void 0:s.current_page)}catch(c){}finally{e&&(b.value=!1)}};return U(),(e,t)=>{const l=u(s("ti-loading"),O),a=J,U=N,B=h,T=u(s("ti-empty-data"),j),K=V;return n(),w(k,null,[v(B,{class:"ti-dish-box"},{default:r((()=>[v(Ie,{categoryId:o.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>o.value.category_id=e)},null,8,["categoryId"]),v(B,{class:"ti-dish-list"},{default:r((()=>[v(K,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:D},{default:r((()=>[b.value?(n(),c(l,{key:0})):d.value&&d.value.length>0?(n(),w(k,{key:1},[v(B,{class:"ti-dish-goods"},{default:r((()=>[(n(!0),w(k,null,I(d.value,((e,t)=>(n(),c(B,{key:t,class:x([{"sold-out":e.product_stock<=0},"ti-goods-item"]),onClick:t=>(e=>{if(e.product_stock<=0)return y({title:m("已售罄"),icon:"none"});i.value=!0,g.value=e.product_id})(e)},{default:r((()=>[v(B,{class:"ti-goods-image"},{default:r((()=>[e.image&&e.image[0]&&e.image[0].file_path?(n(),c(a,{key:0,src:e.image[0].file_path,mode:"widthFix"},null,8,["src"])):P("",!0),v(U,{class:"sold-out-text"},{default:r((()=>[_(p(f(m)("已售罄")),1)])),_:1})])),_:2},1024),v(B,{class:"ti-goods-content"},{default:r((()=>[v(B,{class:"ti-goods-title"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),v(B,{class:"ti-price-box"},{default:r((()=>[v(U,{class:"ti-goods-price"},{default:r((()=>[_(p(f(C)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(U,{class:"ti-goods-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:L.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(T,{key:2}))])),_:1})])),_:1})])),_:1}),v(xe,{show:i.value,"onUpdate:show":t[1]||(t[1]=e=>i.value=e),productId:g.value,onSuccess:S},null,8,["show","productId"])],64)}}},[["__scopeId","data-v-a87260b5"]]),$e=t({__name:"index",emits:["change"],setup(e,{emit:t}){const a=l();Y((()=>{ee()}));const u=()=>{var e;null==(e=a.value)||e.getCartData()};return(e,l)=>{const i=h;return n(),c(i,{class:"ti-order-food"},{default:r((()=>[v(we,{ref_key:"cartRef",ref:a,onChange:l[0]||(l[0]=e=>t("change"))},null,512),v(Ce,{onSuccess:u})])),_:1})}}},[["__scopeId","data-v-a1a999ff"]]),Pe=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},list:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),a("success")}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=V,b=u(s("ti-modal"),d);return n(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.list&&t.list.length>0?(n(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(n(!0),w(k,null,I(i.list,((e,t)=>(n(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(n(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-2649cc86"]]),Ne=t({__name:"index",emits:["change"],setup(t,{emit:i}){const o=l({area_id:"",type_id:"",table_status:""}),d=l(!1),y=l(!1),b=l([]),g=l(),P=l(),L=l([]),S=l([]),D=K((()=>g.value-P.value)),U=l(!1),B=l(),H=l([]),A=l(!1),Z=l(),E=l();a((()=>o.value),(()=>{Q(!0)}),{deep:!0});const F=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";return t>0&&(u+=`${R(t)} ${m("小时")} `),u+=`${R(l)} ${m("分钟")} ${R(a)} ${m("秒")}`,u},R=e=>e<10?`0${e}`:e,J=async t=>{var l,a,u;try{const i=await(u={table_id:t},e("order.HallCart/getUnSendKitchen",u));H.value=(null==(a=null==(l=i.data)?void 0:l.detail)?void 0:a.unSendKitchenProduct)||[],U.value=!0,B.value=t}catch(i){}},Q=async e=>{var t,l,a;if(!y.value)try{e&&(y.value=!0);const u=await _e(o.value);b.value=(null==(t=u.data)?void 0:t.list)||[],g.value=(null==(l=u.data)?void 0:l.total_num)||0,P.value=(null==(a=u.data)?void 0:a.available_num)||0}catch(u){}finally{e&&(y.value=!1)}};return(async()=>{var t,l;try{const a=await e("store.table/tableType");L.value=(null==(t=a.data)?void 0:t.areaList)||[],S.value=(null==(l=a.data)?void 0:l.typeList)||[]}catch(a){}})(),Q(!0),(e,t)=>{const l=h,a=V,K=u(s("ti-loading"),O),R=u(s("uni-icons"),M),W=N,X=u(s("ti-empty-data"),j);return n(),w(k,null,[v(l,{class:"ti-dining-box"},{default:r((()=>[v(l,{class:"ti-dining-category"},{default:r((()=>[v(a,{"scroll-x":""},{default:r((()=>[v(l,{class:"ti-category-list"},{default:r((()=>[v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.area_id}]),onClick:t[0]||(t[0]=e=>o.value.area_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(n(!0),w(k,null,I(L.value,(e=>(n(),c(l,{key:e.area_id,class:x([{active:o.value.area_id==e.area_id},"ti-category-childItem"]),onClick:t=>o.value.area_id=e.area_id},{default:r((()=>[_(p(e.area_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.type_id}]),onClick:t[1]||(t[1]=e=>o.value.type_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(n(!0),w(k,null,I(S.value,(e=>(n(),c(l,{key:e.type_id,class:x([{active:o.value.type_id==e.type_id},"ti-category-childItem"]),onClick:t=>o.value.type_id=e.type_id},{default:r((()=>[_(p(e.type_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:x(["ti-category-all",{active:""==o.value.table_status}]),onClick:t[2]||(t[2]=e=>o.value.table_status="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[v(l,{class:x(["ti-category-childItem",{active:"10"==o.value.table_status}]),onClick:t[3]||(t[3]=e=>o.value.table_status="10")},{default:r((()=>[_(p(f(m)("可用"))+" ("+p(P.value||0)+") ",1)])),_:1},8,["class"]),v(l,{class:x(["ti-category-childItem",{active:"30"==o.value.table_status}]),onClick:t[4]||(t[4]=e=>o.value.table_status="30")},{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(D)||0)+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(l,{class:"ti-dining-table"},{default:r((()=>[v(a,{class:"ti-scroll","scroll-y":""},{default:r((()=>[y.value?(n(),c(K,{key:0})):b.value&&b.value.length>0?(n(),w(k,{key:1},[v(l,{class:"ti-dining-list"},{default:r((()=>[(n(!0),w(k,null,I(b.value,(e=>(n(),c(l,{key:e.table_id,class:x([{green:30!=e.status},"ti-dining-item"]),onClick:t=>(e=>{30!=e.status?(E.value=e.table_no,Z.value=e.table_id,A.value=!0):(T(e.table_id),i("change"))})(e)},{default:r((()=>[v(l,{class:"ti-dining-number"},{default:r((()=>[_(p(e.table_no),1)])),_:2},1024),30!=e.status?(n(),c(l,{key:0,class:"ti-dining-idle"},{default:r((()=>[_(p(f(m)("空闲中")),1)])),_:1})):(n(),w(k,{key:1},[v(l,{class:"ti-dining-info"},{default:r((()=>[v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-user",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p((null==(t=e.underwayOrder)?void 0:t.meal_num)||0),1)]})),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-wallet",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>[v(W,{class:"ti-dining-info-price"},{default:r((()=>{var t;return[_(p(f(C)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024),v(W,{class:"ti-dining-info-subPrice"},{default:r((()=>{var t;return[_(p(f($)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-clock",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p(F(null==(t=e.underwayOrder)?void 0:t.elapsed_time)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-close",onClick:z((t=>J(e.table_id)),["stop"])},{default:r((()=>[v(R,{type:"closeempty",size:"14",color:"#fff"})])),_:2},1032,["onClick"])],64))])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(K,{status:d.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(X,{key:2}))])),_:1})])),_:1}),v(l,{class:"ti-dining-total"},{default:r((()=>[v(l,{class:"ti-dining-total-box"},{default:r((()=>[v(l,{class:"ti-dining-total-item"},{default:r((()=>[_(p(f(m)("全部"))+" ("+p(g.value)+")",1)])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color green"}),v(l,null,{default:r((()=>[_(p(f(m)("可用"))+" ("+p(P.value||0)+")",1)])),_:1})])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color orange"}),v(l,null,{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(D)||0)+")",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(Pe,{show:U.value,"onUpdate:show":t[5]||(t[5]=e=>U.value=e),tableId:B.value,list:H.value,onSuccess:t[6]||(t[6]=e=>Q())},null,8,["show","tableId","list"]),v(fe,{show:A.value,"onUpdate:show":t[7]||(t[7]=e=>A.value=e),tableId:Z.value,tableNo:E.value,onSuccess:t[8]||(t[8]=e=>i("change"))},null,8,["show","tableId","tableNo"])],64)}}},[["__scopeId","data-v-22445472"]]),Le={__name:"index",setup(e){const t=l();Y((()=>{a(),ee()}));const a=()=>{t.value=!!W()};return(e,l)=>{const u=te("ti-layout");return n(),c(u,null,{default:r((()=>[t.value?(n(),c($e,{key:0,onChange:a})):(n(),c(Ne,{key:1,onChange:a}))])),_:1})}}};export{Le as default};
