var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,o=(e,t)=>{for(var l in t||(t={}))u.call(t,l)&&s(e,l,t[l]);if(a)for(var l of a(t))i.call(t,l)&&s(e,l,t[l]);return e},n=(e,a)=>t(e,l(a)),d=(e,t,l)=>new Promise(((a,u)=>{var i=e=>{try{o(l.next(e))}catch(t){u(t)}},s=e=>{try{o(l.throw(e))}catch(t){u(t)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,s);o((l=l.apply(e,t)).next())}));import{ak as c,_ as r,n as v,q as _,r as p,K as f,b as m,L as y,M as h,o as b,d as g,w,e as k,f as I,t as x,g as C,$ as P,y as $,k as D,J as S,N as L,O as N,P as O,Q as U,R as j,al as V,W as B,X as M,Z as T,j as H,a0 as K,a1 as A,a2 as z,am as E,S as Z,T as R,U as F,V as q,an as J,c as Q,a6 as W,a as X,a7 as G,a8 as Y,a9 as ee,aa as te,p as le,ab as ae,H as ue,ao as ie,af as se,ag as oe,ah as ne,ai as de,aj as ce}from"./index-716044ad.js";import{f as re,a as ve,k as _e,m as pe,n as fe,o as me,q as ye}from"./pureFunctionsAny.generated.26e3825f.js";const he=r({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=v("");_((()=>l.show),(()=>{l.show&&(u.value="")}));const i=e=>{e&&(u.value+=e)},s=()=>d(this,null,(function*(){var e,i;if(!u.value)return $({title:P("請輸入價格"),icon:"none"});if(!((i=u.value)>=0&&i<=1e6))return $({title:P("请输入0-1000000间的價格"),icon:"none"});try{a.value=!0;const i=yield re({order_product_id:null==(e=l.productItem)?void 0:e.order_product_id,price:u.value});1==i.code&&($({title:i.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(s){}finally{a.value=!1}}));return(o,n)=>{const d=D,c=p(m("ti-input"),f),r=p(m("ti-keyboard"),y),v=p(m("ti-modal"),h);return b(),g(v,{show:l.show,title:C(P)("價格")},{content:w((()=>[k(d,{class:"ti-dialog-content"},{default:w((()=>[k(d,{class:"ti-modify-title text-ellipsis"},{default:w((()=>{var t,l,a;return[I(x((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),k(d,{class:"ti-modify-input"},{default:w((()=>[k(c,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=e=>u.value=e),placeholder:C(P)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:w((()=>[k(d,{class:"ti-dialog-btn"},{default:w((()=>[k(r,{primaryLoading:a.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:n[1]||(n[1]=e=>t("update:show",!1)),onClear:n[2]||(n[2]=e=>u.value=""),onInput:i,onConfirm:s},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-74e8d450"]]),be=r({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=v("");_((()=>l.show),(()=>{var e;l.show&&(u.value=(null==(e=l.productItem)?void 0:e.remark)||"")}));const i=()=>d(this,null,(function*(){var e;try{a.value=!0;const i=yield ve({order_product_id:null==(e=l.productItem)?void 0:e.order_product_id,remark:u.value.trim()});1==i.code&&($({title:i.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(i){}finally{a.value=!1}}));return(s,o)=>{const n=D,d=L,c=p(m("ti-button"),S),r=p(m("ti-modal"),h);return b(),g(r,{show:l.show,title:C(P)("備註")},{content:w((()=>[k(n,{class:"ti-dialog-content"},{default:w((()=>[k(n,{class:"ti-remark-title text-ellipsis"},{default:w((()=>{var t,l,a;return[I(x((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),k(n,{class:"ti-remark-textarea"},{default:w((()=>[k(d,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),maxlength:50,"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:C(P)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),k(n,{class:"ti-remark-num"},{default:w((()=>{var e;return[I(x((null==(e=u.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:w((()=>[k(n,{class:"ti-dialog-btn"},{default:w((()=>[k(c,{onClick:o[1]||(o[1]=e=>t("update:show",!1))},{default:w((()=>[I(x(C(P)("退出")),1)])),_:1}),k(c,{onClick:o[2]||(o[2]=e=>u.value="")},{default:w((()=>[I(x(C(P)("清空")),1)])),_:1}),k(c,{loading:a.value,type:"primary",onClick:i},{default:w((()=>[I(x(C(P)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-664e04c7"]]),ge=r({__name:"withdrawal",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=v(""),i=v([P("等待時間長"),P("口味不好"),P("菜賣光了")]),s=v(0);_((()=>l.show),(()=>{var e;l.show&&(u.value=(null==(e=l.productItem)?void 0:e.total_num)||"")}));const o=e=>{e&&(u.value+=e)},n=()=>d(this,null,(function*(){var e,o;if(!u.value)return $({title:P("请输入退菜數量"),icon:"none"});try{a.value=!0;const n=yield(o={table_id:V(),order_product_id:null==(e=l.productItem)?void 0:e.order_product_id,num:u.value,return_reason:i.value[s.value]},c("order.HallCart/moveProduct",o));1==n.code&&($({title:n.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(n){}finally{a.value=!1}}));return(d,c)=>{const r=D,v=p(m("ti-input"),f),_=p(m("ti-keyboard"),y),$=p(m("ti-modal"),h);return b(),g($,{show:l.show,title:C(P)("退菜")},{content:w((()=>[k(r,{class:"ti-dialog-content"},{default:w((()=>[k(r,{class:"ti-withdrawal-title text-ellipsis"},{default:w((()=>{var t,l,a;return[I(x((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),k(r,{class:"ti-withdrawal-list"},{default:w((()=>[(b(!0),N(O,null,U(i.value,((e,t)=>(b(),g(r,{key:t,class:j([{active:t==s.value},"ti-withdrawal-item"]),onClick:e=>(e=>{s.value=e})(t)},{default:w((()=>[I(x(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),k(r,{class:"ti-withdrawal-input"},{default:w((()=>[k(v,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=e=>u.value=e),placeholder:C(P)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:w((()=>[k(r,{class:"ti-dialog-btn"},{default:w((()=>[k(_,{primaryLoading:a.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[1]||(c[1]=e=>t("update:show",!1)),onClear:c[2]||(c[2]=e=>u.value=""),onInput:o,onConfirm:n},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-a3c5b8d8"]]),we=r({__name:"preferential",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v({type:1,money:"",rate:"",discountType:1}),u=v(!1);_((()=>l.show),(()=>{var e,t;if(l.show){const u={type:1,money:"",rate:"",discountType:1};(null==(e=l.preferentialData)?void 0:e.discount_ratio)&&(u.type=2,u.rate=Math.max(null==(t=l.preferentialData)?void 0:t.discount_ratio,0)),a.value=u}})),_((()=>a.value.type),((e,t)=>{var u,i;1==t?a.value.money="":2==t?(null==(u=l.preferentialData)?void 0:u.discount_ratio)?a.value.rate=Math.max(null==(i=l.preferentialData)?void 0:i.discount_ratio,0):a.value.rate="":3==t&&(a.value.discountType=1)}));const i=e=>{a.value.discountType=e.detail.value},s=()=>{1==a.value.type?a.value.money="":2==a.value.type&&(a.value.rate="")},r=e=>{e&&(1==a.value.type?a.value.money+=e:2==a.value.type&&(a.value.rate+=e))},L=()=>d(this,null,(function*(){const e=n(o({},a.value),{table_id:V()});if(!u.value){if(1==e.type){if(e.money<=0)return $({title:P("请输入實付價格"),icon:"none"});if(!((l=e.money)>=0&&l<=999999999))return $({title:P("请输入0-999999999间的價格"),icon:"none"})}else if(2==e.type){if(!e.rate)return $({title:P("请输入折扣"),icon:"none"});if(!/^(?:[1-9][0-9]?|100|0)$/.test(e.rate))return $({title:P("请输入0-100间的正整数"),icon:"none"})}var l;try{u.value=!0;const l=yield function(e){return c("order.HallCart/changeMoney",e)}(e);$({title:l.msg,icon:"none"}),t("update:show",!1),t("success")}catch(i){}finally{u.value=!1}}}));return(o,n)=>{const d=D,c=H,v=p(m("ti-input"),f),_=K,$=A,V=z,E=p(m("ti-button"),S),Z=p(m("ti-keyboard"),y),R=p(m("ti-modal"),h);return b(),g(R,{show:l.show,title:C(P)("優惠折扣")},{content:w((()=>[k(d,{class:"ti-dialog-content"},{default:w((()=>[k(d,{class:"ti-preferential-box"},{default:w((()=>[k(d,{class:"ti-preferential-label"},{default:w((()=>[I(x(C(P)("當前價格")),1)])),_:1}),k(d,{class:"ti-preferential-input"},{default:w((()=>[k(c,{class:"ti-preferential-price"},{default:w((()=>[I(x(C(B)(e.totalPayPrice)),1)])),_:1}),k(c,{class:"ti-preferential-subPrice"},{default:w((()=>[I(x(C(M)(e.totalPayPrice)),1)])),_:1})])),_:1}),k(d,{class:"ti-preferential-label"},{default:w((()=>[I(x(C(P)("優惠方式")),1)])),_:1}),k(d,{class:"ti-preferential-input ti-preferential-type"},{default:w((()=>[(b(!0),N(O,null,U([C(P)("改價"),C(P)("折扣"),C(P)("抹零")],((e,t)=>(b(),g(d,{key:t,class:j([{active:a.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>a.value.type=t+1},{default:w((()=>[I(x(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==a.value.type?(b(),N(O,{key:0},[k(d,{class:"ti-preferential-label"},{default:w((()=>[I(x(C(P)("實付價格")),1)])),_:1}),k(d,{class:"ti-preferential-input"},{default:w((()=>[k(v,{modelValue:a.value.money,"onUpdate:modelValue":n[0]||(n[0]=e=>a.value.money=e),placeholder:C(P)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):T("",!0),2==a.value.type?(b(),N(O,{key:1},[k(d,{class:"ti-preferential-label"},{default:w((()=>[I(x(C(P)("折扣")),1)])),_:1}),k(d,{class:"ti-preferential-input"},{default:w((()=>[k(v,{modelValue:a.value.rate,"onUpdate:modelValue":n[1]||(n[1]=e=>a.value.rate=e),placeholder:C(P)("请输入折扣"),focus:!0},{right:w((()=>[k(d,{class:"ti-preferential-percentage"},{default:w((()=>[I("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):T("",!0),3==a.value.type?(b(),N(O,{key:2},[k(d,{class:"ti-preferential-label"},{default:w((()=>[I(x(C(P)("抹零方式")),1)])),_:1}),k(d,{class:"ti-preferential-input"},{default:w((()=>[k(V,{class:"ti-type-radio",onChange:i},{default:w((()=>[k($,null,{default:w((()=>[k(_,{value:"1",color:"#ffbe00",checked:"true"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("抹分")),1)])),_:1})])),_:1}),k($,null,{default:w((()=>[k(_,{value:"2",color:"#ffbe00"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("抹角")),1)])),_:1})])),_:1}),k($,null,{default:w((()=>[k(_,{value:"3",color:"#ffbe00"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("四捨五入到角")),1)])),_:1})])),_:1}),k($,null,{default:w((()=>[k(_,{value:"4",color:"#ffbe00"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("四捨五入到元")),1)])),_:1})])),_:1})])),_:1})])),_:1})],64)):T("",!0)])),_:1})])),_:1})])),footer:w((()=>[3==a.value.type?(b(),g(d,{key:0,class:"ti-dialog-btn"},{default:w((()=>[k(E,{onClick:n[2]||(n[2]=e=>t("update:show",!1))},{default:w((()=>[I(x(C(P)("退出")),1)])),_:1}),k(E,{loading:u.value,type:"primary",onClick:L},{default:w((()=>[I(x(C(P)("确定")),1)])),_:1},8,["loading"])])),_:1})):(b(),g(d,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:w((()=>[k(Z,{primaryLoading:u.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:n[3]||(n[3]=e=>t("update:show",!1)),onClear:s,onInput:r,onConfirm:L},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},[["__scopeId","data-v-53f4b331"]]),ke=r({__name:"cancel-all",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=()=>d(this,null,(function*(){var e;if(!a.value)try{a.value=!0;const l=yield(e={table_id:V()},c("order.HallCart/cancel",e));$({title:l.msg,icon:"none"}),t("update:show",!1),E(),setTimeout((()=>{t("success")}),100)}catch(l){}finally{a.value=!1}}));return(i,s)=>{const o=D,n=Z,d=p(m("ti-modal"),h);return b(),g(d,{class:"ti-action-tips",title:i.$t("溫馨提示"),show:l.show,confirmLoading:a.value,onCancel:s[0]||(s[0]=e=>t("update:show",!1)),onConfirm:u},{content:w((()=>[k(o,{class:"ti-dialog-content"},{default:w((()=>[l.sendKitchen&&e.sendKitchen.length>0?(b(),N(O,{key:0},[k(o,{class:"ti-cancel-title"},{default:w((()=>[I(x(i.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),k(o,{class:"ti-cancel-all"},{default:w((()=>[k(n,{"scroll-y":""},{default:w((()=>[k(o,{class:"ti-cancel-list"},{default:w((()=>[(b(!0),N(O,null,U(l.sendKitchen,((e,t)=>(b(),g(o,{key:t,class:"ti-cancel-item"},{default:w((()=>[I(x(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(b(),N(O,{key:1},[I(x(i.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-ad3b684a"]]);function Ie(e){return c("store.table/table",e)}const xe=r({__name:"turntable",props:{show:{type:Boolean,default:!1},tableNo:{type:[Number,String],default:null}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v({table_status:"10"}),u=v(!1),i=v(!1),s=v([]),o=v(),n=v(!1);_((()=>l.show),(()=>{l.show&&(o.value=null,f())}));const r=e=>d(this,null,(function*(){if(!n.value){if(!o.value)return $({title:P("请选择桌号"),icon:"none"});try{n.value=!0;const l=yield(e={old_table_id:V(),new_table_id:o.value},c("order.order/changeTable",e));$({title:l.msg,icon:"none"}),t("update:show",!1),J(o.value),setTimeout((()=>{t("success")}),100)}catch(l){}finally{n.value=!1}var e}})),f=()=>{a.value.page=1,h(!0)},y=()=>{u.value&&(a.value.page+=1,h())},h=e=>d(this,null,(function*(){var t;if(!i.value)try{e&&(i.value=!0);const l=yield Ie(a.value);s.value=(null==(t=l.data)?void 0:t.list)||[]}catch(l){}finally{e&&(i.value=!1)}}));return(e,a)=>{const d=p(m("ti-loading"),R),c=D,v=p(m("ti-empty-data"),F),_=Z,f=p(m("ti-drawer"),q);return b(),g(f,{show:l.show,confirmLoading:n.value,title:`[${l.tableNo}]${C(P)("轉台")}`,onCancel:a[0]||(a[0]=e=>t("update:show",!1)),onConfirm:r},{content:w((()=>[k(c,{class:"ti-turntable-box"},{default:w((()=>[k(_,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:y},{default:w((()=>[i.value?(b(),g(d,{key:0})):s.value&&s.value.length>0?(b(),N(O,{key:1},[k(c,{class:"ti-turntable-list"},{default:w((()=>[(b(!0),N(O,null,U(s.value,(e=>(b(),g(c,{key:e.table_id,class:j([{active:o.value==e.table_id},"ti-turntable-item"]),onClick:t=>o.value=e.table_id},{default:w((()=>[I(x(e.table_no),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),k(d,{status:u.value?"loading":"no-more"},null,8,["status"])],64)):(b(),g(v,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","confirmLoading","title"])}}},[["__scopeId","data-v-6a6a5b8e"]]),Ce=r({__name:"open-table",props:{show:{type:Boolean,default:!1},tableNo:{type:String,default:null},tableId:{type:[Number,String],default:null},isUpdate:{type:Boolean,default:!1}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=v("");_((()=>l.show),(()=>{l.show&&(u.value="")}));const i=e=>{e&&(u.value+=e)},s=()=>d(this,null,(function*(){if(!u.value)return $({title:P("請輸入人數"),icon:"none"});if(!/^(?!0+$)\d{1,3}$/.test(u.value))return $({title:P("请输入1-999的人数"),icon:"none"});try{a.value=!0;const s=yield(e={table_id:l.tableId,meal_num:u.value},i=l.isUpdate,c(i?"order.Order/updateMealNum":"order.Order/tableBuy",e));1==s.code&&($({title:s.msg,icon:"none"}),J(l.tableId),t("update:show",!1),setTimeout((()=>{t("success")}),100))}catch(s){}finally{a.value=!1}var e,i}));return(e,o)=>{const n=p(m("ti-input"),f),d=D,c=p(m("ti-keyboard"),y),r=p(m("ti-modal"),h);return b(),g(r,{show:l.show,title:`[${l.tableNo}]${C(P)("就餐人數")}`},{content:w((()=>[k(d,{class:"ti-dialog-content"},{default:w((()=>[k(d,{class:"ti-modify-input"},{default:w((()=>[k(n,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=e=>u.value=e),placeholder:C(P)("請輸入人數"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:w((()=>[k(d,{class:"ti-dialog-btn"},{default:w((()=>[k(c,{primaryLoading:a.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:o[1]||(o[1]=e=>t("update:show",!1)),onClear:o[2]||(o[2]=e=>u.value=""),onInput:i,onConfirm:s},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-90517ad9"]]),Pe=r({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},tableId:{type:[Number,String],default:null},tableNo:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["success","change"],setup(e,{emit:t}){const l=e,a=Q((()=>l.orderList&&l.orderList.length>0)),u=Q((()=>l.orderList.filter((e=>0!=(null==e?void 0:e.is_send_kitchen))))),i=Q((()=>l.orderList.filter((e=>0==(null==e?void 0:e.is_send_kitchen))))),s=v(!1),o=v(!1),n=v(!1),r=v(!1),_=v(!1),f=v(!1),y=v(!1),g=v(!1),S=v(!1),L=v(!1),U=v(!1),j=()=>{E(),setTimeout((()=>{t("change")}),100)},B=()=>d(this,null,(function*(){var e,a;if(!o.value)try{o.value=!0;const u=yield(a={order_product_id:null==(e=l.productItem)?void 0:e.order_product_id},c("order.HallCart/delProduct",a));$({title:u.msg,icon:"none"}),t("success")}catch(u){}finally{s.value=!1,o.value=!1}})),M=()=>d(this,null,(function*(){var e;if(!r.value)try{r.value=!0;const l=yield(e={table_id:V()},c("order.HallCart/sendKitchen",e));$({title:l.msg,icon:"none"}),t("success"),n.value=!1}catch(l){n.value=!1}finally{r.value=!1}}));return(d,c)=>{const v=H,$=W,V=D,T=p(m("ti-modal"),h);return b(),N(O,null,[k(V,{class:"ti-action-box"},{default:w((()=>[k(V,{class:"ti-action-btn"},{default:w((()=>[k(V,{class:"ti-btn-box"},{default:w((()=>{var t,l,u;return[k($,{class:"ti-btn-item",disabled:!1,onClick:j},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("返回")),1)])),_:1})])),_:1}),k($,{class:"ti-btn-item danger",disabled:!(e.productItem&&0==(null==(t=e.productItem)?void 0:t.is_send_kitchen)),onClick:c[0]||(c[0]=e=>s.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("删除")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item",disabled:0!=(null==(l=e.productItem)?void 0:l.is_send_kitchen),onClick:c[1]||(c[1]=e=>y.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("备注")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item",disabled:!C(a),onClick:c[2]||(c[2]=e=>f.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("價格")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item",disabled:!1,onClick:c[3]||(c[3]=e=>L.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("人数")),1)])),_:1})])),_:1}),k($,{class:"ti-btn-item",disabled:!1,onClick:c[4]||(c[4]=e=>U.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("转台")),1)])),_:1})])),_:1}),k($,{class:"ti-btn-item",disabled:0==C(i).length,onClick:c[5]||(c[5]=e=>n.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("送廚")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item danger",disabled:!(e.productItem&&1==(null==(u=e.productItem)?void 0:u.is_send_kitchen)),onClick:c[6]||(c[6]=e=>g.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("退菜")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item danger",disabled:!C(a),onClick:c[7]||(c[7]=e=>_.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("清台")),1)])),_:1})])),_:1},8,["disabled"]),k($,{class:"ti-btn-item",disabled:!C(a),onClick:c[8]||(c[8]=e=>S.value=!0)},{default:w((()=>[k(v,{class:"ti-btn-item-text"},{default:w((()=>[I(x(C(P)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])]})),_:1})])),_:1})])),_:1}),k(T,{class:"ti-action-tips",show:s.value,"onUpdate:show":c[9]||(c[9]=e=>s.value=e),confirmLoading:o.value,title:C(P)("溫馨提示"),content:C(P)("是否删除此商品？"),onConfirm:B},null,8,["show","confirmLoading","title","content"]),k(T,{class:"ti-action-tips",show:n.value,"onUpdate:show":c[10]||(c[10]=e=>n.value=e),confirmLoading:r.value,title:C(P)("溫馨提示"),content:C(P)("是否将商品送廚？"),onConfirm:M},null,8,["show","confirmLoading","title","content"]),k(Ce,{show:L.value,"onUpdate:show":c[11]||(c[11]=e=>L.value=e),isUpdate:!0,tableId:l.tableId,tableNo:l.tableNo,onSuccess:c[12]||(c[12]=e=>t("success"))},null,8,["show","tableId","tableNo"]),k(xe,{show:U.value,"onUpdate:show":c[13]||(c[13]=e=>U.value=e),tableNo:l.tableNo,onSuccess:c[14]||(c[14]=e=>t("success"))},null,8,["show","tableNo"]),k(ke,{show:_.value,"onUpdate:show":c[15]||(c[15]=e=>_.value=e),sendKitchen:C(u),onSuccess:c[16]||(c[16]=e=>t("change"))},null,8,["show","sendKitchen"]),k(he,{show:f.value,"onUpdate:show":c[17]||(c[17]=e=>f.value=e),productItem:l.productItem,onSuccess:c[18]||(c[18]=e=>t("success"))},null,8,["show","productItem"]),k(be,{show:y.value,"onUpdate:show":c[19]||(c[19]=e=>y.value=e),productItem:l.productItem,onSuccess:c[20]||(c[20]=e=>t("success"))},null,8,["show","productItem"]),k(ge,{show:g.value,"onUpdate:show":c[21]||(c[21]=e=>g.value=e),productItem:l.productItem,onSuccess:c[22]||(c[22]=e=>t("success"))},null,8,["show","productItem"]),k(we,{show:S.value,"onUpdate:show":c[23]||(c[23]=e=>S.value=e),preferentialData:e.preferentialData,productItem:l.productItem,totalPayPrice:e.totalPayPrice,onSuccess:c[24]||(c[24]=e=>t("success"))},null,8,["show","preferentialData","productItem","totalPayPrice"])],64)}}},[["__scopeId","data-v-05f3e38a"]]),$e=r({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const l=e,a=v(!1),u=e=>d(this,null,(function*(){var u,i;const s={order_product_id:null==(u=l.productItem)?void 0:u.order_product_id,product_num:null==(i=l.productItem)?void 0:i.total_num,type:e};"up"==e?s.product_num+=1:s.product_num-=1;try{a.value=!0;1==(yield _e(s)).code&&t("change")}catch(o){}finally{a.value=!1}}));return(e,t)=>{const i=p(m("uni-icons"),X),s=W,o=D;return b(),g(o,{class:"ti-number-box",onClick:t[2]||(t[2]=G((()=>{}),["stop"]))},{default:w((()=>{var e,n,d,c,r,v;return[k(s,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=l.productItem)?void 0:e.total_num)<=1||a.value||(null==(n=l.productItem)?void 0:n.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>u("down"))},{default:w((()=>[k(i,{"custom-prefix":"iconfont",type:"icon-minus",size:"16"})])),_:1},8,["disabled"]),k(o,{class:"ti-number-input"},{default:w((()=>{var e;return[I(x((null==(e=l.productItem)?void 0:e.total_num)||1),1)]})),_:1}),k(s,{class:"ti-number-btn ti-number-plus",disabled:(null==(d=l.productItem)?void 0:d.total_num)>=(null==(r=null==(c=l.productItem)?void 0:c.product)?void 0:r.product_stock)||a.value||(null==(v=l.productItem)?void 0:v.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>u("up"))},{default:w((()=>[k(i,{type:"plusempty",size:"16"})])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-cdd7204f"]]);const De=r({__name:"member",props:{show:{type:Boolean,default:!1}},emits:["update:show","change"],setup(e,{emit:t}){const l=e,a=v(!1),u=v(""),i=v({}),s=v(!1);_((()=>l.show),(()=>{l.show&&(u.value="",i.value={})}));const c=()=>{t("update:show",!1),t("change",null)},r=e=>{e&&(u.value+=e)},P=()=>d(this,null,(function*(){if(!u.value)return $({title:$t("请输入会员手机号/ID"),icon:"none"});try{a.value=!0;const e=yield Y({mobile:u.value,table_id:V()});i.value=n(o({},e.data.user),{total_pay_price:e.data.total_pay_price})}catch(e){}finally{a.value=!1}})),L=()=>d(this,null,(function*(){var e;try{s.value=!0;yield ee({table_id:V(),user_id:(null==(e=i.value)?void 0:e.user_id)||0});t("update:show",!1),t("change",i.value)}catch(l){}finally{s.value=!1}}));return(e,t)=>{const o=p(m("ti-input"),f),n=p(m("ti-button"),S),d=D,v=H,_=p(m("ti-keyboard"),y),$=p(m("ti-modal"),h);return b(),g($,{show:l.show,title:e.$t("会员")},{content:w((()=>[k(d,{class:"ti-dialog-content"},{default:w((()=>{var l;return[k(d,{class:"ti-payment-input"},{default:w((()=>[k(o,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),placeholder:e.$t("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),k(n,{loading:a.value,type:"primary",onClick:P},{default:w((()=>[I(x(e.$t("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(l=i.value)?void 0:l.user_id)?(b(),g(d,{key:0,class:"ti-payment-member"},{default:w((()=>[k(d,{class:"ti-member-list"},{default:w((()=>[k(d,{class:"ti-member-item"},{default:w((()=>[k(d,{class:"ti-member-head"},{default:w((()=>[I(x(e.$t("暱稱")),1)])),_:1}),k(d,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=i.value)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),k(d,{class:"ti-member-item"},{default:w((()=>[k(d,{class:"ti-member-head"},{default:w((()=>[I(x(e.$t("會員卡/等級")),1)])),_:1}),k(d,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e,t,l,a,u,s,o,n,d;return[I(x(`${1!=(null==(l=null==(t=null==(e=i.value)?void 0:e.card)?void 0:t.cardRecord)?void 0:l.disabled)&&(null==(u=null==(a=i.value)?void 0:a.card)?void 0:u.card_name)?null==(o=null==(s=i.value)?void 0:s.card)?void 0:o.card_name:"-"}/${(null==(d=null==(n=i.value)?void 0:n.grade)?void 0:d.name)||"-"}`),1)]})),_:1})])),_:1}),k(d,{class:"ti-member-item"},{default:w((()=>[k(d,{class:"ti-member-head"},{default:w((()=>[I(x(e.$t("餘額")),1)])),_:1}),k(d,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=i.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),k(d,{class:"ti-member-item"},{default:w((()=>[k(d,{class:"ti-member-head"},{default:w((()=>[I(x(e.$t("積分")),1)])),_:1}),k(d,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=i.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),k(d,{class:"ti-member-discount"},{default:w((()=>[k(v,{class:"ti-discount-title"},{default:w((()=>[I(x(e.$t("會員折扣應收金額")),1)])),_:1}),k(v,{class:"ti-discount-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=i.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),k(v,{class:"ti-discount-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=i.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):T("",!0)]})),_:1})])),footer:w((()=>[k(d,{class:"ti-dialog-btn"},{default:w((()=>[k(_,{primaryLoading:s.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:c,onClear:t[1]||(t[1]=e=>u.value=""),onInput:r,onConfirm:L},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-3054e99b"]]),Se=r({__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show","success","change"],setup(e,{emit:t}){const l=e,a=v(!1),u=v([]),i=v({delivery:40,pay_type:"40",user_id:null,table_id:null}),s=v(!1),n=v(!1);_((()=>l.show),(()=>{l.show&&(u.value=[],i.value.pay_type="40")})),_((()=>i.value.pay_type),(()=>{l.show&&(i.value.pay_type>0||(u.value&&u.value.length>0?i.value.pay_type=u.value[0].value:te().then((e=>{u.value=e.data||[],i.value.pay_type=u.value[0].value}))))}));const r=e=>{var a;(null==e?void 0:e.user_id)!=(null==(a=l.memberDetail)?void 0:a.user_id)&&t("success")},f=()=>d(this,null,(function*(){try{yield ee({table_id:V(),user_id:0});t("success")}catch(e){}})),y=e=>{i.value.pay_type=e.detail.value},L=()=>d(this,null,(function*(){if(!n.value)try{n.value=!0;const e=yield ae({order_id:l.orderId});$({title:e.msg,icon:"none"})}catch(e){}finally{n.value=!1}})),Z=()=>d(this,null,(function*(){var e;if(s.value)return;const a=o({},i.value);if(a.table_id=V(),a.user_id=null==(e=l.memberDetail)?void 0:e.user_id,"10"==a.pay_type&&!a.user_id)return $({title:P("请选择会员身份以享受更多优惠，再进行余额支付"),icon:"none"});try{s.value=!0;const e=yield function(e){return c("order.order/pay",e)}(a);$({title:e.msg,icon:"none"}),t("update:show",!1),E(),setTimeout((()=>{t("change")}),100)}catch(u){}finally{s.value=!1}}));return(o,d)=>{const c=H,v=D,_=K,$=A,V=z,E=ue,R=p(m("ti-empty-data"),F),q=p(m("ti-button"),S),J=p(m("ti-modal"),h);return b(),g(J,{show:l.show,title:C(P)("結賬")},{content:w((()=>[k(v,{class:"ti-dialog-content"},{default:w((()=>{var t;return[k(v,{class:"ti-payment-money"},{default:w((()=>[k(c,{class:"ti-payment-label"},{default:w((()=>[I(x(C(P)("應收金額")),1)])),_:1}),k(c,{class:"ti-payment-price"},{default:w((()=>[I(x(C(B)(e.totalPayPrice)),1)])),_:1}),k(c,{class:"ti-payment-subPrice"},{default:w((()=>[I(x(C(M)(e.totalPayPrice)),1)])),_:1})])),_:1}),k(v,{class:"ti-payment-type"},{default:w((()=>[k(v,{class:"ti-type-label"},{default:w((()=>[I(x(C(P)("收款方式")),1)])),_:1}),k(V,{class:"ti-type-radio",onChange:y},{default:w((()=>[k($,null,{default:w((()=>[k(_,{value:"40",color:"#ffbe00",checked:"true"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("現金")),1)])),_:1})])),_:1}),k($,null,{default:w((()=>[k(_,{value:"10",color:"#ffbe00"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("餘額")),1)])),_:1})])),_:1}),k($,null,{default:w((()=>[k(_,{value:"",color:"#ffbe00"}),k(c,{class:"ti-radio-text"},{default:w((()=>[I(x(C(P)("其他方式")),1)])),_:1})])),_:1})])),_:1})])),_:1}),"40"!=i.value.pay_type&&"10"!=i.value.pay_type?(b(),g(v,{key:0,class:"ti-payment-other"},{default:w((()=>[k(v,{class:"ti-other-title"},{default:w((()=>[I(x(C(P)("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),u.value&&u.value.length>0?(b(),g(v,{key:0,class:"ti-other-list"},{default:w((()=>[(b(!0),N(O,null,U(u.value,(e=>(b(),g(v,{key:e.value,class:j([{active:e.value==i.value.pay_type},"ti-other-item"]),onClick:t=>i.value.pay_type=e.value},{default:w((()=>[k(v,{class:"ti-other-image"},{default:w((()=>{var t;return[k(E,{src:`${(null==(t=C(le)())?void 0:t.api_url)||""}/${e.img}`,mode:"widthFix"},null,8,["src"])]})),_:2},1024),k(v,{class:"ti-other-text"},{default:w((()=>[I(x(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(b(),g(R,{key:1}))])),_:1})):T("",!0),(null==(t=l.memberDetail)?void 0:t.user_id)?(b(),g(v,{key:1,class:"ti-payment-member"},{default:w((()=>[k(v,{class:"ti-payment-top"},{default:w((()=>[k(v,{class:"ti-payment-top-name"},{default:w((()=>[I(x(C(P)("會員")),1)])),_:1}),k(v,{class:"ti-payment-top-discomfort",onClick:f},{default:w((()=>[I(x(C(P)("不使用此會員")),1)])),_:1})])),_:1}),k(v,{class:"ti-member-list"},{default:w((()=>[k(v,{class:"ti-member-item"},{default:w((()=>[k(v,{class:"ti-member-head"},{default:w((()=>[I(x(C(P)("暱稱")),1)])),_:1}),k(v,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=l.memberDetail)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),k(v,{class:"ti-member-item"},{default:w((()=>[k(v,{class:"ti-member-head"},{default:w((()=>[I(x(C(P)("會員卡/等級")),1)])),_:1}),k(v,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e,t,a,u,i,s,o,n,d;return[I(x(`${1!=(null==(a=null==(t=null==(e=l.memberDetail)?void 0:e.card)?void 0:t.cardRecord)?void 0:a.disabled)&&(null==(i=null==(u=l.memberDetail)?void 0:u.card)?void 0:i.card_name)?null==(o=null==(s=l.memberDetail)?void 0:s.card)?void 0:o.card_name:"-"}/${(null==(d=null==(n=l.memberDetail)?void 0:n.grade)?void 0:d.name)||"-"}`),1)]})),_:1})])),_:1}),k(v,{class:"ti-member-item"},{default:w((()=>[k(v,{class:"ti-member-head"},{default:w((()=>[I(x(C(P)("餘額")),1)])),_:1}),k(v,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=l.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),k(v,{class:"ti-member-item"},{default:w((()=>[k(v,{class:"ti-member-head"},{default:w((()=>[I(x(C(P)("積分")),1)])),_:1}),k(v,{class:"ti-member-name text-ellipsis"},{default:w((()=>{var e;return[I(x((null==(e=l.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1})])),_:1})):T("",!0),k(De,{show:a.value,"onUpdate:show":d[0]||(d[0]=e=>a.value=e),onChange:r},null,8,["show"])]})),_:1})])),footer:w((()=>[k(v,{class:"ti-dialog-btn"},{default:w((()=>[k(q,{onClick:d[1]||(d[1]=e=>t("update:show",!1))},{default:w((()=>[I(x(C(P)("退出")),1)])),_:1}),k(q,{loading:n.value,onClick:L},{default:w((()=>[I(x(C(P)("打印")),1)])),_:1},8,["loading"]),k(q,{onClick:d[2]||(d[2]=e=>a.value=!0)},{default:w((()=>[I(x(C(P)("会员")),1)])),_:1}),k(q,{loading:s.value,type:"primary",onClick:Z},{default:w((()=>[I(x(C(P)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-7e0aa8f9"]]),Le=r({__name:"time-meter",props:{tableDetail:{type:Object,default:()=>({})}},setup(e){const t=e,l=v(),a=v(),u=v(`00 ${P("分钟")} 00 ${P("秒")}`);_((()=>{var e;return null==(e=t.tableDetail)?void 0:e.elapsed_time}),(()=>{var e;a.value=null==(e=t.tableDetail)?void 0:e.elapsed_time,l.value&&clearInterval(l.value),a.value>0&&(l.value=setInterval((()=>{a.value++,i(a.value)}),1e3))}),{deep:!0}),ie((()=>{l.value&&clearInterval(l.value)}));const i=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let i="";t>0&&(i+=`${s(t)} ${P("小时")} `),i+=`${s(l)} ${P("分钟")} ${s(a)} ${P("秒")}`,u.value=i},s=e=>e<10?`0${e}`:e;return(e,l)=>{const a=D;return b(),g(a,{class:"ti-table-info"},{default:w((()=>[k(a,{class:"ti-table-num"},{default:w((()=>{var e,l;return[I(x(`${(null==(e=t.tableDetail)?void 0:e.table_no)||""} (${(null==(l=t.tableDetail)?void 0:l.meal_num)||0})`),1)]})),_:1}),k(a,{class:"ti-table-time"},{default:w((()=>[I(x(C(P)("已就餐："))+x(u.value),1)])),_:1})])),_:1})}}},[["__scopeId","data-v-fffc540a"]]),Ne=r({__name:"cart-list",emits:["change"],setup(e,{expose:t,emit:l}){const a=v(),u=v(!1),i=v(!1),s=v({}),o=v({}),n=v(),r=v(),_=v([]),f=v({table_no:"",meal_num:"",elapsed_time:""}),y=v({}),h=()=>{u.value=!0},$=e=>d(this,null,(function*(){var t,l,u,d,v,p,m,h,b,g,w,k,I,x,C,P,$,D,S,L,N;try{e&&(i.value=!0);const O=yield(N={table_id:V()},c("order.HallCart/tableProductList",N,{isLoading:!1}));if(y.value={discount_ratio:null==(u=null==(l=null==(t=O.data)?void 0:t.allProductInfo)?void 0:l.orderInfo)?void 0:u.discount_ratio},n.value=V(),r.value=O.data.order_id,f.value={table_no:null==(p=null==(v=null==(d=O.data)?void 0:d.allProductInfo)?void 0:v.orderInfo)?void 0:p.table_no,meal_num:null==(b=null==(h=null==(m=O.data)?void 0:m.allProductInfo)?void 0:h.orderInfo)?void 0:b.meal_num,elapsed_time:null==(k=null==(w=null==(g=O.data)?void 0:g.allProductInfo)?void 0:w.orderInfo)?void 0:k.elapsed_time},o.value=null==(x=null==(I=O.data)?void 0:I.allProductInfo)?void 0:x.sumInfo,_.value=(null==($=null==(P=null==(C=O.data)?void 0:C.allProductInfo)?void 0:P.orderInfo)?void 0:$.product)||[],_.value&&_.value.length>0){let e=0;(null==(D=s.value)?void 0:D.order_product_id)&&(e=_.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=s.value)?void 0:t.order_product_id)}))),s.value=_.value[Math.max(e,0)],a.value=null==(L=null==(S=O.data)?void 0:S.allProductInfo)?void 0:L.userInfo}else s.value=null,a.value=null}catch(O){}finally{e&&(i.value=!1)}}));return $(!0),t({getCartData:$}),(e,t)=>{var d,c;const v=D,S=p(m("ti-loading"),R),L=H,V=p(m("ti-empty-data"),F),K=Z,A=W;return b(),N(O,null,[k(v,{class:"ti-cart-box"},{default:w((()=>[k(Le,{tableDetail:f.value},null,8,["tableDetail"]),k(v,{class:"ti-cart-list"},{default:w((()=>[k(v,{class:"ti-cart-head"},{default:w((()=>[k(v,{class:"ti-cart-shop-head"},{default:w((()=>[k(v,{class:"ti-shop-head-title"},{default:w((()=>[I(x(C(P)("商品名稱")),1)])),_:1}),k(v,{class:"ti-shop-head-money"},{default:w((()=>[I(x(C(P)("金額")),1)])),_:1}),k(v,{class:"ti-shop-head-num"},{default:w((()=>[I(x(C(P)("數量")),1)])),_:1})])),_:1})])),_:1}),k(v,{class:"ti-shop-list"},{default:w((()=>[k(K,{"scroll-y":""},{default:w((()=>[i.value?(b(),g(S,{key:0})):_.value&&_.value.length>0?(b(),g(v,{key:1,class:"ti-shop-box"},{default:w((()=>[(b(!0),N(O,null,U(_.value,(e=>{var l;return b(),g(v,{key:e,class:j([{active:(null==(l=s.value)?void 0:l.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:t=>(e=>{var t;(null==(t=s.value)?void 0:t.order_product_id)!=(null==e?void 0:e.order_product_id)&&(s.value=e)})(e)},{default:w((()=>[k(v,{class:"ti-shop-item-box"},{default:w((()=>[k(v,{class:"ti-shop-body"},{default:w((()=>[k(v,{class:"ti-shop-body-top"},{default:w((()=>[k(v,{class:"ti-shop-title text-ellipsis"},{default:w((()=>[I(x(e.product_name_text),1)])),_:2},1024),e.product_attr?(b(),g(v,{key:0,class:"ti-shop-spec"},{default:w((()=>[I("( "+x(e.product_attr)+" )",1)])),_:2},1024)):T("",!0)])),_:2},1024),k(v,{class:"ti-shop-body-money"},{default:w((()=>[k(L,{class:"ti-shop-price"},{default:w((()=>[I(x(C(B)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),k(L,{class:"ti-shop-subPrice"},{default:w((()=>[I(x(C(M)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),k($e,{productItem:e,onChange:t[0]||(t[0]=e=>$())},null,8,["productItem"])])),_:2},1024),e.remark?(b(),g(v,{key:0,class:"ti-shop-remark"},{default:w((()=>[I(x(e.remark),1)])),_:2},1024)):T("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(b(),g(V,{key:2}))])),_:1})])),_:1})])),_:1}),k(v,{class:"ti-cart-statistics"},{default:w((()=>[k(v,{class:"ti-cart-total"},{default:w((()=>[k(L,{class:"ti-total-text"},{default:w((()=>[I(x(C(P)("小計:")),1)])),_:1}),k(L,{class:"ti-total-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=o.value)?void 0:e.subtotal)||0)),1)]})),_:1}),k(L,{class:"ti-total-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=o.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),k(v,{class:"ti-cart-discount"},{default:w((()=>[k(v,{class:"ti-discount-item"},{default:w((()=>[k(v,null,{default:w((()=>[k(L,{class:"ti-discount-text"},{default:w((()=>[I(x(C(P)("服務費:")),1)])),_:1}),k(L,{class:"ti-discount-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=o.value)?void 0:e.service_money)||0)),1)]})),_:1}),k(L,{class:"ti-discount-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=o.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),k(v,null,{default:w((()=>{var e;return[k(L,{class:"ti-discount-text"},{default:w((()=>[I(x(C(P)("優惠折扣:")),1)])),_:1}),k(L,{class:"ti-discount-price"},{default:w((()=>{var e;return[I(x(`-${C(B)((null==(e=o.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),C(M)((null==(e=o.value)?void 0:e.special_discount)||0)?(b(),g(L,{key:0,class:"ti-discount-subPrice"},{default:w((()=>{var e;return[I(x(`-${C(M)((null==(e=o.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):T("",!0)]})),_:1})])),_:1}),k(v,{class:"ti-discount-item"},{default:w((()=>[k(v,null,{default:w((()=>[k(L,{class:"ti-discount-text"},{default:w((()=>[I(x(C(P)("消費稅:")),1)])),_:1}),k(L,{class:"ti-discount-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=o.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),k(L,{class:"ti-discount-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=o.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),k(v,null,{default:w((()=>{var e;return[k(L,{class:"ti-discount-text"},{default:w((()=>[I(x(C(P)("會員折扣:")),1)])),_:1}),k(L,{class:"ti-discount-price"},{default:w((()=>{var e;return[I(x(`-${C(B)((null==(e=o.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),C(M)((null==(e=o.value)?void 0:e.total_user_discount_money)||0)?(b(),g(L,{key:0,class:"ti-discount-subPrice"},{default:w((()=>{var e;return[I(x(`-${C(M)((null==(e=o.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):T("",!0)]})),_:1})])),_:1})])),_:1}),k(v,{class:"ti-cart-settlement"},{default:w((()=>[k(v,{class:"ti-settlement-total"},{default:w((()=>[k(L,{class:"ti-settlement-text"},{default:w((()=>[I(x(C(P)("應收：")),1)])),_:1}),k(L,{class:"ti-settlement-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=o.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),k(L,{class:"ti-settlement-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=o.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),k(A,{class:"ti-settlement-btn",disabled:_.value.length<=0,onClick:h},{default:w((()=>[k(L,null,{default:w((()=>[I(x(C(P)("結賬")),1)])),_:1}),_.value.length>0?(b(),g(L,{key:0,class:"ti-settlement-badge"},{default:w((()=>[I(x(_.value.length),1)])),_:1})):T("",!0)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),k(Pe,{productItem:s.value,totalPayPrice:null==(d=o.value)?void 0:d.total_pay_price,tableNo:f.value.table_no,orderList:_.value,tableId:n.value,preferentialData:y.value,onChange:t[1]||(t[1]=e=>l("change")),onSuccess:t[2]||(t[2]=e=>$())},null,8,["productItem","totalPayPrice","tableNo","orderList","tableId","preferentialData"]),k(Se,{show:u.value,"onUpdate:show":t[3]||(t[3]=e=>u.value=e),totalPayPrice:null==(c=o.value)?void 0:c.total_pay_price,orderId:r.value,memberDetail:a.value,onChange:t[4]||(t[4]=e=>l("change")),onSuccess:t[5]||(t[5]=e=>$())},null,8,["show","totalPayPrice","orderId","memberDetail"])],64)}}},[["__scopeId","data-v-2f30084d"]]),Oe=r({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(e,{emit:t}){const l=e,a=v(0),u=v(0),i=v([]);_((()=>l.list),(e=>d(this,null,(function*(){if(yield se(),!e||0==e.length)return;const t=oe().in(this);if(e.map(((e,l)=>{t.select(`#scroll-item-${l}`).boundingClientRect((e=>{if(!e)return;const t=i.value;t[l]=e.width+10,i.value=t})).exec()})),l.menuId>0){const e=l.list.findIndex((e=>e.category_id==l.menuId));e>-1&&s(e)}}))),{deep:!0,immediate:!0});const s=e=>{u.value=e,a.value=i.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(i.value[e]+100),t("update:menuId",l.list[e].category_id)};return(e,t)=>{const i=H,o=D,n=Z;return b(),g(n,{class:"ti-dish-menu","scroll-left":a.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:w((()=>[k(o,{class:"ti-menu-content"},{default:w((()=>[(b(!0),N(O,null,U(l.list,((e,t)=>(b(),g(o,{key:t,class:j(["ti-menu-item",{active:t==u.value}]),id:`scroll-item-${t}`,onClick:e=>s(t)},{default:w((()=>[k(i,{class:"ti-menu-title"},{default:w((()=>[I(x(e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-384c1800"]]),Ue=r({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId","update:isSpecial"],setup(e,{emit:t}){const l=v([]),a=v(0),u=v(0),i=Q((()=>{let e=(l.value.find((e=>e.category_id==a.value))||{}).child||[];return e&&e.length>0&&(e=[{name_text:P("全部"),category_id:0}].concat(e)),e})),s=Q((()=>l.value.find((e=>e.category_id==a.value)))),o=Q((()=>i.value.find((e=>e.category_id==u.value))));_((()=>a.value),(()=>{var e;i&&i.length>0&&(u.value=i.value[0].category_id),t("update:isSpecial",null==(e=s.value)?void 0:e.is_special),t("update:categoryId",a.value)}));return(()=>{d(this,null,(function*(){try{const e=yield pe();e.data.list&&(l.value=[{name_text:P("全部"),category_id:0}].concat(e.data.list),a.value=l.value[0].category_id)}catch(e){}}))})(),(e,s)=>{const n=D;return b(),g(n,{class:"ti-category-box"},{default:w((()=>[k(Oe,{list:l.value,menuId:a.value,"onUpdate:menuId":s[0]||(s[0]=e=>a.value=e)},null,8,["list","menuId"]),k(n,{class:"ti-dish-secondary"},{default:w((()=>[(b(!0),N(O,null,U(C(i),((e,l)=>(b(),g(n,{key:l,class:j([{active:e.category_id==u.value},"ti-secondary-item"]),onClick:l=>{return i=e.category_id,u.value=i,t("update:isSpecial",null==(s=o.value)?void 0:s.is_special),void t("update:categoryId",u.value>0?u.value:a.value);var i,s}},{default:w((()=>[I(x(e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-dd3799bd"]]),je=r({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v({}),u=v(!1),i=v(!1),s=v({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:40,describe:null});_((()=>l.show),(()=>{l.show&&n()}));const n=()=>d(this,null,(function*(){var e,t,i,o,n,d,c,r,v;if(!u.value||l.productId)try{u.value=!0;const _=yield fe(l.productId);a.value=_.data,s.value.product_id=null==(e=a.value)?void 0:e.product_id,s.value.price=null==(t=a.value)?void 0:t.product_price,s.value.product_price=null==(i=a.value)?void 0:i.product_price,(null==(o=a.value)?void 0:o.sku)&&(null==(n=a.value)?void 0:n.sku.length)>0&&(s.value.product_sku_id=null==(d=a.value)?void 0:d.sku[0].product_sku_id),(null==(c=a.value)?void 0:c.product_attr)&&(null==(r=a.value)?void 0:r.product_attr.length)>0&&(null==(v=a.value)||v.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?s.value.attr[t]=0:s.value.attr[t]=null}))),s.value.feed&&s.value.feed.length>0&&(s.value.feed=[])}catch(_){}finally{u.value=!1}})),r=()=>d(this,null,(function*(){var e,l,u,n,d,r,v,_,p;if(i.value)return;const m=o({},s.value);m.attr=m.attr.join(","),m.feed=m.feed.join(",");let y=[];if((null==(e=a.value)?void 0:e.sku)&&(null==(l=a.value)?void 0:l.sku.length)>0){const e=null==(u=a.value)?void 0:u.sku.find((e=>e.product_sku_id==s.value.product_sku_id));m.price=(null==e?void 0:e.product_price)||0,(null==e?void 0:e.spec_name)&&y.push(null==e?void 0:e.spec_name)}(null==(n=a.value)?void 0:n.product_attr)&&(null==(d=a.value)?void 0:d.product_attr.length)&&(null==(r=a.value)||r.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value)&&(null==e?void 0:e.attribute_value.length)>0&&(null==e?void 0:e.attribute_value[s.value.attr[t]])&&y.push(null==e?void 0:e.attribute_value[s.value.attr[t]])}))),(null==(v=a.value)?void 0:v.product_feed)&&(null==(_=a.value)?void 0:_.product_feed.length)>0&&(null==(p=a.value)||p.product_feed.map(((e,t)=>{f(t)&&(y.push(e.feed_name),m.price=me(m.price,null==e?void 0:e.price))}))),m.describe=y.join(";"),m.table_id=V();try{i.value=!0;const e=yield function(e){return c("order.HallCart/add",e)}(m);1==e.code&&($({title:e.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(h){}finally{i.value=!1}})),f=e=>s.value.feed.indexOf(e)>-1,y=(e,t)=>s.value.attr[e]==t;return(e,u)=>{const o=ue,n=D,d=H,c=Z,v=p(m("ti-modal"),h);return b(),g(v,{show:l.show,title:C(P)("商品详情"),confirmLoading:i.value,onCancel:u[0]||(u[0]=e=>t("update:show",!1)),onConfirm:r},{content:w((()=>[k(n,{class:"ti-dialog-content"},{default:w((()=>[k(n,{class:"ti-detail-box"},{default:w((()=>[k(n,{class:"ti-detail-image"},{default:w((()=>{var e,t,l,u;return[(null==(e=a.value)?void 0:e.image)&&(null==(t=a.value)?void 0:t.image[0])&&(null==(l=a.value)?void 0:l.image[0].file_path)?(b(),g(o,{key:0,src:null==(u=a.value)?void 0:u.image[0].file_path,mode:"widthFix"},null,8,["src"])):T("",!0)]})),_:1}),k(n,{class:"ti-detail-con"},{default:w((()=>[k(n,{class:"ti-detail-title text-ellipsis"},{default:w((()=>{var e;return[I(x(null==(e=a.value)?void 0:e.product_name_text),1)]})),_:1}),k(n,{class:"ti-price-box"},{default:w((()=>[k(d,{class:"ti-detail-unit"},{default:w((()=>[I(x(C(P)("單價：")),1)])),_:1}),k(d,{class:"ti-detail-price"},{default:w((()=>{var e;return[I(x(C(B)((null==(e=a.value)?void 0:e.product_price)||0)),1)]})),_:1}),k(d,{class:"ti-detail-subPrice"},{default:w((()=>{var e;return[I(x(C(M)((null==(e=a.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),k(n,{class:"ti-price-box"},{default:w((()=>[k(d,{class:"ti-detail-unit"},{default:w((()=>[I(x(C(P)("單位：")),1)])),_:1}),k(d,{class:"ti-detail-price"},{default:w((()=>{var e;return[I(x(null==(e=a.value)?void 0:e.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),k(n,{class:"ti-detail-specs"},{default:w((()=>[k(c,{"scroll-y":""},{default:w((()=>[k(n,{class:"ti-specs-box"},{default:w((()=>{var e,t,l,u,i,o,c;return[(null==(e=a.value)?void 0:e.sku)&&(null==(t=a.value)?void 0:t.sku.length)>0?(b(),g(n,{key:0,class:"ti-specs-item"},{default:w((()=>[k(n,{class:"ti-specs-title"},{default:w((()=>[I(x(C(P)("規格")),1)])),_:1}),k(n,{class:"ti-specs-child"},{default:w((()=>{var e;return[(b(!0),N(O,null,U(null==(e=a.value)?void 0:e.sku,(e=>(b(),g(n,{key:e.product_sku_id,class:j([{active:e.product_sku_id==s.value.product_sku_id},"ti-child-item"]),onClick:t=>{return l=e.product_sku_id,void(s.value.product_sku_id!=l&&(s.value.product_sku_id=l));var l}},{default:w((()=>[k(d,{class:"ti-child-name"},{default:w((()=>[I(x(e.spec_name_text),1)])),_:2},1024),k(d,{class:"ti-child-price"},{default:w((()=>[I(x(C(B)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024),k(d,{class:"ti-child-subPrice"},{default:w((()=>[I(x(C(M)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):T("",!0),(null==(l=a.value)?void 0:l.product_attr)&&(null==(u=a.value)?void 0:u.product_attr.length)>0?(b(!0),N(O,{key:1},U(null==(i=a.value)?void 0:i.product_attr,((e,t)=>(b(),g(n,{key:t,class:"ti-specs-item"},{default:w((()=>[k(n,{class:"ti-specs-title"},{default:w((()=>[I(x(e.attribute_name_text),1)])),_:2},1024),k(n,{class:"ti-specs-child"},{default:w((()=>[(b(!0),N(O,null,U(null==e?void 0:e.attribute_value_text,((e,l)=>(b(),g(n,{key:l,class:j([{active:y(t,l)},"ti-child-item"]),onClick:e=>((e,t)=>{s.value.attr[e]=t})(t,l)},{default:w((()=>[k(d,{class:"ti-child-name"},{default:w((()=>[I(x(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):T("",!0),(null==(o=a.value)?void 0:o.product_feed)&&(null==(c=a.value)?void 0:c.product_feed.length)>0?(b(),g(n,{key:2,class:"ti-specs-item"},{default:w((()=>[k(n,{class:"ti-specs-title"},{default:w((()=>[I(x(C(P)("加料")),1)])),_:1}),k(n,{class:"ti-specs-child"},{default:w((()=>{var e;return[(b(!0),N(O,null,U(null==(e=a.value)?void 0:e.product_feed,((e,t)=>(b(),g(n,{key:t,class:j([{active:f(t)},"ti-child-item"]),onClick:e=>(e=>{const t=s.value.feed.indexOf(e);t>=0?s.value.feed.splice(t,1):s.value.feed.push(e)})(t)},{default:w((()=>[k(d,{class:"ti-child-name"},{default:w((()=>[I(x(e.feed_name_text),1)])),_:2},1024),k(d,{class:"ti-child-price"},{default:w((()=>[I(x(C(B)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024),k(d,{class:"ti-child-subPrice"},{default:w((()=>[I(x(C(M)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):T("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-40c705b2"]]),Ve=r({__name:"dish-list",emits:["success"],setup(e,{emit:t}){const l=v(!1),a=v({category_id:null,page:1,list_rows:20}),u=v([]),i=v(!1),s=v(),n=v(!1),c=v(0);_((()=>a.value.category_id),(()=>{y()}));const r=()=>{t("success")},f=()=>{n.value&&(a.value.page+=1,h())},y=()=>{a.value.page=1,h(!0)},h=e=>d(this,null,(function*(){var t,l,s,d,r,v;if(i.value)return;const _=o({},a.value);_.category_id||(_.category_id=null),1==c.value&&(_.is_special=1);try{e&&(i.value=!0);const o=yield ye(_);1==a.value.page&&(u.value=[]),u.value=u.value.concat((null==(l=null==(t=o.data)?void 0:t.list)?void 0:l.data)||[]),n.value=(null==(d=null==(s=o.data)?void 0:s.list)?void 0:d.last_page)>(null==(v=null==(r=o.data)?void 0:r.list)?void 0:v.current_page)}catch(p){}finally{e&&(i.value=!1)}}));return y(),(e,t)=>{const o=p(m("ti-loading"),R),d=ue,v=H,_=D,y=p(m("ti-empty-data"),F),h=Z;return b(),N(O,null,[k(_,{class:"ti-dish-box"},{default:w((()=>[k(Ue,{categoryId:a.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>a.value.category_id=e),isSpecial:c.value,"onUpdate:isSpecial":t[1]||(t[1]=e=>c.value=e)},null,8,["categoryId","isSpecial"]),k(_,{class:"ti-dish-list"},{default:w((()=>[k(h,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:f},{default:w((()=>[i.value?(b(),g(o,{key:0})):u.value&&u.value.length>0?(b(),N(O,{key:1},[k(_,{class:"ti-dish-goods"},{default:w((()=>[(b(!0),N(O,null,U(u.value,((e,t)=>(b(),g(_,{key:t,class:j([{"sold-out":e.product_stock<=0},"ti-goods-item"]),onClick:t=>(e=>{if(e.product_stock<=0)return $({title:P("已售罄"),icon:"none"});l.value=!0,s.value=e.product_id})(e)},{default:w((()=>[k(_,{class:"ti-goods-image"},{default:w((()=>[e.image&&e.image[0]&&e.image[0].file_path?(b(),g(d,{key:0,src:e.image[0].file_path,mode:"widthFix"},null,8,["src"])):T("",!0),k(v,{class:"sold-out-text"},{default:w((()=>[I(x(C(P)("已售罄")),1)])),_:1})])),_:2},1024),k(_,{class:"ti-goods-content"},{default:w((()=>[k(_,{class:"ti-goods-title line-clamp-2"},{default:w((()=>[I(x(e.product_name_text),1)])),_:2},1024),k(_,{class:"ti-price-box"},{default:w((()=>[k(v,{class:"ti-goods-price"},{default:w((()=>[I(x(C(B)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),k(v,{class:"ti-goods-subPrice"},{default:w((()=>[I(x(C(M)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),k(o,{status:n.value?"loading":"no-more"},null,8,["status"])],64)):(b(),g(y,{key:2}))])),_:1})])),_:1})])),_:1}),k(je,{show:l.value,"onUpdate:show":t[2]||(t[2]=e=>l.value=e),productId:s.value,onSuccess:r},null,8,["show","productId"])],64)}}},[["__scopeId","data-v-8b18118c"]]),Be=r({__name:"index",emits:["change"],setup(e,{emit:t}){const l=v();ne((()=>{de()}));const a=()=>{var e;null==(e=l.value)||e.getCartData()};return(e,u)=>{const i=D;return b(),g(i,{class:"ti-order-food"},{default:w((()=>[k(Ne,{ref_key:"cartRef",ref:l,onChange:u[0]||(u[0]=e=>t("change"))},null,512),k(Ve,{onSuccess:a})])),_:1})}}},[["__scopeId","data-v-a1a999ff"]]),Me=r({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},list:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=v(!1),u=()=>d(this,null,(function*(){var e;if(!a.value)try{a.value=!0;const u=yield(e={table_id:l.tableId},c("order.HallCart/cancel",e));$({title:u.msg,icon:"none"}),t("update:show",!1),t("success")}catch(u){}finally{a.value=!1}}));return(i,s)=>{const o=D,n=Z,d=p(m("ti-modal"),h);return b(),g(d,{class:"ti-action-tips",title:i.$t("溫馨提示"),show:l.show,confirmLoading:a.value,onCancel:s[0]||(s[0]=e=>t("update:show",!1)),onConfirm:u},{content:w((()=>[k(o,{class:"ti-dialog-content"},{default:w((()=>[l.list&&e.list.length>0?(b(),N(O,{key:0},[k(o,{class:"ti-cancel-title"},{default:w((()=>[I(x(i.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),k(o,{class:"ti-cancel-all"},{default:w((()=>[k(n,{"scroll-y":""},{default:w((()=>[k(o,{class:"ti-cancel-list"},{default:w((()=>[(b(!0),N(O,null,U(l.list,((e,t)=>(b(),g(o,{key:t,class:"ti-cancel-item"},{default:w((()=>[I(x(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(b(),N(O,{key:1},[I(x(i.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-2649cc86"]]),Te={__name:"count-down",props:{time:{type:[Number,String],default:null}},setup(e){const t=e,l=v(),a=v(0),u=v(`00 ${P("分钟")} 00 ${P("秒")}`);_((()=>t.time),(()=>{l.value&&clearInterval(l.value),t.time>0&&(a.value=t.time,l.value=setInterval((()=>{a.value++,i(a.value)}),1e3))}),{immediate:!0}),ie((()=>{l.value&&clearInterval(l.value)}));const i=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let i="";t>0&&(i+=`${s(t)} ${P("小时")} `),i+=`${s(l)} ${P("分钟")} ${s(a)} ${P("秒")}`,u.value=i},s=e=>e<10?`0${e}`:e;return(e,t)=>{const l=D;return b(),g(l,{class:"ti-dining-info-text"},{default:w((()=>[I(x(u.value),1)])),_:1})}}},He=r({__name:"index",emits:["change"],setup(e,{emit:t}){const l=v({area_id:"",type_id:"",table_status:""}),a=v(!1),u=v(!1),i=v([]),s=v(),o=v(),n=v([]),r=v([]),f=Q((()=>s.value-o.value)),y=v(!1),h=v(),$=v([]),S=v(!1),L=v(),V=v();_((()=>l.value),(()=>{K(!0)}),{deep:!0});const T=e=>d(this,null,(function*(){var t,l,a;try{const u=yield(a={table_id:e},c("order.HallCart/getSendKitchen",a));$.value=(null==(l=null==(t=u.data)?void 0:t.detail)?void 0:l.sendKitchenProduct)||[],y.value=!0,h.value=e}catch(u){}})),K=e=>d(this,null,(function*(){var t,a,n;if(!u.value)try{e&&(u.value=!0);const d=yield Ie(l.value);i.value=(null==(t=d.data)?void 0:t.list)||[],s.value=(null==(a=d.data)?void 0:a.total_num)||0,o.value=(null==(n=d.data)?void 0:n.available_num)||0}catch(d){}finally{e&&(u.value=!1)}}));return(()=>{d(this,null,(function*(){var e,t;try{const l=yield c("store.table/tableType");n.value=(null==(e=l.data)?void 0:e.areaList)||[],r.value=(null==(t=l.data)?void 0:t.typeList)||[]}catch(l){}}))})(),K(!0),(e,d)=>{const c=D,v=Z,_=p(m("ti-loading"),R),A=p(m("uni-icons"),X),z=H,E=p(m("ti-empty-data"),F);return b(),N(O,null,[k(c,{class:"ti-dining-box"},{default:w((()=>[k(c,{class:"ti-dining-category"},{default:w((()=>[k(v,{"scroll-x":""},{default:w((()=>[k(c,{class:"ti-category-list"},{default:w((()=>[k(c,{class:"ti-category-item"},{default:w((()=>[k(c,{class:j(["ti-category-all",{active:""==l.value.area_id}]),onClick:d[0]||(d[0]=e=>l.value.area_id="")},{default:w((()=>[I(x(C(P)("全部")),1)])),_:1},8,["class"]),k(c,{class:"ti-category-child"},{default:w((()=>[(b(!0),N(O,null,U(n.value,(e=>(b(),g(c,{key:e.area_id,class:j([{active:l.value.area_id==e.area_id},"ti-category-childItem"]),onClick:t=>l.value.area_id=e.area_id},{default:w((()=>[I(x(e.area_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),k(c,{class:"ti-category-item"},{default:w((()=>[k(c,{class:j(["ti-category-all",{active:""==l.value.type_id}]),onClick:d[1]||(d[1]=e=>l.value.type_id="")},{default:w((()=>[I(x(C(P)("全部")),1)])),_:1},8,["class"]),k(c,{class:"ti-category-child"},{default:w((()=>[(b(!0),N(O,null,U(r.value,(e=>(b(),g(c,{key:e.type_id,class:j([{active:l.value.type_id==e.type_id},"ti-category-childItem"]),onClick:t=>l.value.type_id=e.type_id},{default:w((()=>[I(x(e.type_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),k(c,{class:"ti-category-item"},{default:w((()=>[k(c,{class:j(["ti-category-all",{active:""==l.value.table_status}]),onClick:d[2]||(d[2]=e=>l.value.table_status="")},{default:w((()=>[I(x(C(P)("全部")),1)])),_:1},8,["class"]),k(c,{class:"ti-category-child"},{default:w((()=>[k(c,{class:j(["ti-category-childItem",{active:"10"==l.value.table_status}]),onClick:d[3]||(d[3]=e=>l.value.table_status="10")},{default:w((()=>[I(x(C(P)("可用"))+" ("+x(o.value||0)+") ",1)])),_:1},8,["class"]),k(c,{class:j(["ti-category-childItem",{active:"30"==l.value.table_status}]),onClick:d[4]||(d[4]=e=>l.value.table_status="30")},{default:w((()=>[I(x(C(P)("佔用"))+" ("+x(C(f)||0)+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),k(c,{class:"ti-dining-table"},{default:w((()=>[k(v,{class:"ti-scroll","scroll-y":""},{default:w((()=>[u.value?(b(),g(_,{key:0})):i.value&&i.value.length>0?(b(),N(O,{key:1},[k(c,{class:"ti-dining-list"},{default:w((()=>[(b(!0),N(O,null,U(i.value,(e=>(b(),g(c,{key:e.table_id,class:j([{green:30!=e.status},"ti-dining-item"]),onClick:l=>(e=>{30!=e.status?(V.value=e.table_no,L.value=e.table_id,S.value=!0):(J(e.table_id),t("change"))})(e)},{default:w((()=>[k(c,{class:"ti-dining-number"},{default:w((()=>[I(x(e.table_no),1)])),_:2},1024),30!=e.status?(b(),g(c,{key:0,class:"ti-dining-idle"},{default:w((()=>[I(x(C(P)("空闲中")),1)])),_:1})):(b(),N(O,{key:1},[k(c,{class:"ti-dining-info"},{default:w((()=>[k(c,{class:"ti-dining-info-item"},{default:w((()=>[k(c,{class:"ti-dining-info-icon"},{default:w((()=>[k(A,{"custom-prefix":"iconfont",type:"icon-user",size:"18",color:"#100A05"})])),_:1}),k(c,{class:"ti-dining-info-text"},{default:w((()=>{var t;return[I(x((null==(t=e.underwayOrder)?void 0:t.meal_num)||0),1)]})),_:2},1024)])),_:2},1024),k(c,{class:"ti-dining-info-item"},{default:w((()=>[k(c,{class:"ti-dining-info-icon"},{default:w((()=>[k(A,{"custom-prefix":"iconfont",type:"icon-wallet",size:"18",color:"#100A05"})])),_:1}),k(c,{class:"ti-dining-info-text"},{default:w((()=>[k(z,{class:"ti-dining-info-price"},{default:w((()=>{var t;return[I(x(C(B)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024),k(z,{class:"ti-dining-info-subPrice"},{default:w((()=>{var t;return[I(x(C(M)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),k(c,{class:"ti-dining-info-item"},{default:w((()=>{var t;return[k(c,{class:"ti-dining-info-icon"},{default:w((()=>[k(A,{"custom-prefix":"iconfont",type:"icon-clock",size:"18",color:"#100A05"})])),_:1}),k(Te,{time:null==(t=e.underwayOrder)?void 0:t.elapsed_time},null,8,["time"])]})),_:2},1024)])),_:2},1024),k(c,{class:"ti-dining-close",onClick:G((t=>T(e.table_id)),["stop"])},{default:w((()=>[k(A,{type:"closeempty",size:"14",color:"#fff"})])),_:2},1032,["onClick"])],64))])),_:2},1032,["class","onClick"])))),128))])),_:1}),k(_,{status:a.value?"loading":"no-more"},null,8,["status"])],64)):(b(),g(E,{key:2}))])),_:1})])),_:1}),k(c,{class:"ti-dining-total"},{default:w((()=>[k(c,{class:"ti-dining-total-box"},{default:w((()=>[k(c,{class:"ti-dining-total-item"},{default:w((()=>[I(x(C(P)("全部"))+" ("+x(s.value)+")",1)])),_:1}),k(c,{class:"ti-dining-total-item"},{default:w((()=>[k(c,{class:"ti-dining-total-color green"}),k(c,null,{default:w((()=>[I(x(C(P)("可用"))+" ("+x(o.value||0)+")",1)])),_:1})])),_:1}),k(c,{class:"ti-dining-total-item"},{default:w((()=>[k(c,{class:"ti-dining-total-color orange"}),k(c,null,{default:w((()=>[I(x(C(P)("佔用"))+" ("+x(C(f)||0)+")",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),k(Me,{show:y.value,"onUpdate:show":d[5]||(d[5]=e=>y.value=e),tableId:h.value,list:$.value,onSuccess:d[6]||(d[6]=e=>K())},null,8,["show","tableId","list"]),k(Ce,{show:S.value,"onUpdate:show":d[7]||(d[7]=e=>S.value=e),tableId:L.value,tableNo:V.value,onSuccess:d[8]||(d[8]=e=>t("change"))},null,8,["show","tableId","tableNo"])],64)}}},[["__scopeId","data-v-bae30165"]]),Ke={__name:"index",setup(e){const t=v();ne((()=>{l(),de()}));const l=()=>{t.value=!!V()};return(e,a)=>{const u=ce("ti-layout");return b(),g(u,null,{default:w((()=>[t.value?(b(),g(Be,{key:0,onChange:l})):(b(),g(He,{key:1,onChange:l}))])),_:1})}}};export{Ke as default};
