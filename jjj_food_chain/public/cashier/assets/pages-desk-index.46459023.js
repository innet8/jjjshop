import{ad as e,_ as t,r as l,w as a,a as u,b as i,c as s,d as o,e as d,o as n,f as c,g as r,h as v,i as _,t as p,u as f,$ as m,s as y,j as h,k as b,l as g,m as w,F as k,n as I,p as C,y as x,z as $,C as P,B as N,D as S,E as L,G as U,ae as V,S as D,q as O,v as j,x as B,af as T,H,L as K,M,N as z,O as A,P as E,ag as Z,ah as F,R,T as q,U as G,V as W,W as J}from"./index-d722f725.js";import{f as Q,a as X,k as Y,m as ee,n as te,p as le}from"./product.171dbc60.js";import{f as ae,g as ue,a as ie}from"./payment.96254b17.js";const se=t({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const b=e,g=l(!1),w=l("");a((()=>b.show),(()=>{b.show&&(w.value="")}));const k=e=>{e&&(w.value+=e)},I=async()=>{var e;if(w.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{g.value=!0;const l=await Q({order_product_id:null==(e=b.productItem)?void 0:e.order_product_id,price:w.value});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{g.value=!1}};return(l,a)=>{const y=h,C=u(s("ti-input"),i),x=u(s("ti-keyboard"),o),$=u(s("ti-modal"),d);return n(),c($,{show:b.show,title:f(m)("價格")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-modify-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-modify-input"},{default:r((()=>[v(C,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),placeholder:f(m)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(x,{primaryLoading:g.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:a[1]||(a[1]=e=>t("update:show",!1)),onClear:a[2]||(a[2]=e=>w.value=""),onInput:k,onConfirm:I},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-24206eab"]]),oe=t({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const i=e,o=l(!1),w=l("");a((()=>i.show),(()=>{var e;i.show&&(w.value=(null==(e=i.productItem)?void 0:e.remark)||"")}));const k=async()=>{var e;if(!w.value)return y({title:m("请输入備註"),icon:"none"});try{o.value=!0;const l=await X({order_product_id:null==(e=i.productItem)?void 0:e.order_product_id,remark:w.value.trim()});1==l.code&&(y({title:l.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(l){}finally{o.value=!1}};return(l,a)=>{const y=h,I=g,C=u(s("ti-button"),b),x=u(s("ti-modal"),d);return n(),c(x,{show:i.show,title:f(m)("備註")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>[v(y,{class:"ti-remark-title text-ellipsis"},{default:r((()=>{var t,l,a;return[_(p((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(y,{class:"ti-remark-textarea"},{default:r((()=>[v(I,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:f(m)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),v(y,{class:"ti-remark-num"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(C,{onClick:a[1]||(a[1]=e=>t("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(C,{onClick:a[2]||(a[2]=e=>w.value="")},{default:r((()=>[_(p(f(m)("清空")),1)])),_:1}),v(C,{loading:o.value,type:"primary",onClick:k},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-500f020d"]]),de=t({__name:"withdrawal",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(t,{emit:b}){const g=t,x=l(!1),$=l(""),P=l([m("等待時間長"),m("口味不好"),m("菜賣光了")]),N=l(0);a((()=>g.show),(()=>{g.show&&($.value="")}));const S=e=>{e&&($.value+=e)},L=async()=>{var t,l;if($.value<=0)return y({title:m("請輸入價格"),icon:"none"});try{x.value=!0;const a=await(l={table_id:g.tableId,order_product_id:null==(t=g.productItem)?void 0:t.order_product_id,num:$.value,return_reason:P.value[N.value]},e("order.HallCart/moveProduct",l));1==a.code&&(y({title:a.msg,icon:"none"}),b("update:show",!1),b("success"))}catch(a){}finally{x.value=!1}};return(e,l)=>{const a=h,y=u(s("ti-input"),i),U=u(s("ti-keyboard"),o),V=u(s("ti-modal"),d);return n(),c(V,{show:g.show,title:f(m)("退菜")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-withdrawal-title text-ellipsis"},{default:r((()=>{var e,l,a;return[_(p((null==(e=t.productItem)?void 0:e.product_name_text)||(null==(a=null==(l=t.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),v(a,{class:"ti-withdrawal-list"},{default:r((()=>[(n(!0),w(k,null,I(P.value,((e,t)=>(n(),c(a,{key:t,class:C([{active:t==N.value},"ti-withdrawal-item"]),onClick:e=>(e=>{N.value=e})(t)},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(a,{class:"ti-withdrawal-input"},{default:r((()=>[v(y,{modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=e=>$.value=e),placeholder:f(m)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(U,{primaryLoading:x.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[1]||(l[1]=e=>b("update:show",!1)),onClear:l[2]||(l[2]=e=>$.value=""),onInput:S,onConfirm:L},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-9c9982b2"]]),ne=t({__name:"preferential",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},totalPayPrice:{type:[Number,String],default:0}},emits:["update:show","success"],setup(t,{emit:g}){const V=t,D=l({type:1,money:"",rate:"",discountType:1}),O=l(!1);a((()=>V.show),(()=>{D.value={type:1,money:"",rate:"",discountType:1}})),a((()=>D.value.type),((e,t)=>{1==t?D.value.money="":2==t?D.value.rate="":3==t&&(D.value.discountType=1)}));const j=e=>{D.value.discountType=e.detail.value},B=()=>{1==D.value.type?D.value.money="":2==D.value.type&&(D.value.rate="")},T=e=>{e&&(1==D.value.type?D.value.money+=e:2==D.value.type&&(D.value.rate+=e))},H=async()=>{const t={...D.value,table_id:V.tableId};if(!O.value){if(1==t.type){if(t.money<=0)return y({title:m("请输入實付價格"),icon:"none"})}else if(2==t.type&&t.rate<=0)return y({title:m("请输入優惠折扣"),icon:"none"});try{O.value=!0;const l=await function(t){return e("order.HallCart/changeMoney",t)}(t);y({title:l.msg,icon:"none"}),g("update:show",!1),g("success")}catch(l){}finally{O.value=!1}}};return(e,l)=>{const a=h,y=N,K=u(s("ti-input"),i),M=S,z=L,A=U,E=u(s("ti-button"),b),Z=u(s("ti-keyboard"),o),F=u(s("ti-modal"),d);return n(),c(F,{show:V.show,title:f(m)("優惠折扣")},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-preferential-box"},{default:r((()=>[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("當前價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(y,{class:"ti-preferential-price"},{default:r((()=>[_(p(f(x)(t.totalPayPrice)),1)])),_:1}),v(y,{class:"ti-preferential-subPrice"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠方式")),1)])),_:1}),v(a,{class:"ti-preferential-input ti-preferential-type"},{default:r((()=>[(n(!0),w(k,null,I([f(m)("改價"),f(m)("折扣"),f(m)("抹零")],((e,t)=>(n(),c(a,{key:t,class:C([{active:D.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>D.value.type=t+1},{default:r((()=>[_(p(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==D.value.type?(n(),w(k,{key:0},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("實付價格")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(K,{modelValue:D.value.money,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value.money=e),placeholder:f(m)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):P("",!0),2==D.value.type?(n(),w(k,{key:1},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(K,{modelValue:D.value.rate,"onUpdate:modelValue":l[1]||(l[1]=e=>D.value.rate=e),placeholder:f(m)("请输入優惠折扣"),focus:!0},{right:r((()=>[v(a,{class:"ti-preferential-percentage"},{default:r((()=>[_("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):P("",!0),3==D.value.type?(n(),w(k,{key:2},[v(a,{class:"ti-preferential-label"},{default:r((()=>[_(p(f(m)("抹零方式")),1)])),_:1}),v(a,{class:"ti-preferential-input"},{default:r((()=>[v(A,{class:"ti-type-radio",onChange:j},{default:r((()=>[v(z,null,{default:r((()=>[v(M,{value:"1",color:"#ffbe00",checked:"true"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹分")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"2",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("抹角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"3",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到角")),1)])),_:1})])),_:1}),v(z,null,{default:r((()=>[v(M,{value:"4",color:"#ffbe00"}),v(y,{class:"ti-radio-text"},{default:r((()=>[_(p(f(m)("四捨五入到元")),1)])),_:1})])),_:1})])),_:1})])),_:1})],64)):P("",!0)])),_:1})])),_:1})])),footer:r((()=>[3==D.value.type?(n(),c(a,{key:0,class:"ti-dialog-btn"},{default:r((()=>[v(E,{onClick:l[2]||(l[2]=e=>g("update:show",!1))},{default:r((()=>[_(p(f(m)("退出")),1)])),_:1}),v(E,{loading:O.value,type:"primary",onClick:H},{default:r((()=>[_(p(f(m)("确定")),1)])),_:1},8,["loading"])])),_:1})):(n(),c(a,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:r((()=>[v(Z,{primaryLoading:O.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:l[3]||(l[3]=e=>g("update:show",!1)),onClear:B,onInput:T,onConfirm:H},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},[["__scopeId","data-v-c0e692fb"]]),ce=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),V(),setTimeout((()=>{a("success")}),100)}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=D,b=u(s("ti-modal"),d);return n(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.sendKitchen&&t.sendKitchen.length>0?(n(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(n(!0),w(k,null,I(i.sendKitchen,((e,t)=>(n(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(n(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-53674ff5"]]);function re(t){return e("store.table/table",t)}const ve=t({__name:"turntable",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},tableNo:{type:[Number,String],default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,d=l({table_status:"10"}),b=l(!1),g=l(!1),x=l([]),$=l(),P=l(!1);a((()=>o.show),(()=>{o.show&&($.value=null,S())}));const N=async t=>{if(!P.value){if(!$.value)return y({title:m("请选择桌号"),icon:"none"});try{P.value=!0;const t=await(l={old_table_id:o.tableId,new_table_id:$.value},e("order.order/changeTable",l));y({title:t.msg,icon:"none"}),i("update:show",!1),T($.value),setTimeout((()=>{i("success")}),100)}catch(a){}finally{P.value=!1}var l}},S=()=>{d.value.page=1,U(!0)},L=()=>{b.value&&(d.value.page+=1,U())},U=async e=>{var t;if(!g.value)try{e&&(g.value=!0);const l=await re(d.value);x.value=(null==(t=l.data)?void 0:t.list)||[]}catch(l){}finally{e&&(g.value=!1)}};return(e,t)=>{const l=u(s("ti-loading"),O),a=h,d=u(s("ti-empty-data"),j),y=D,S=u(s("ti-drawer"),B);return n(),c(S,{show:o.show,confirmLoading:P.value,title:`[${o.tableNo}]${f(m)("轉台")}`,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:N},{content:r((()=>[v(a,{class:"ti-turntable-box"},{default:r((()=>[v(y,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:L},{default:r((()=>[g.value?(n(),c(l,{key:0})):x.value&&x.value.length>0?(n(),w(k,{key:1},[v(a,{class:"ti-turntable-list"},{default:r((()=>[(n(!0),w(k,null,I(x.value,(e=>(n(),c(a,{key:e.table_id,class:C([{active:$.value==e.table_id},"ti-turntable-item"]),onClick:t=>$.value=e.table_id},{default:r((()=>[_(p(e.table_no),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:b.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(d,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","confirmLoading","title"])}}},[["__scopeId","data-v-1e54f37e"]]),_e=t({__name:"open-table",props:{show:{type:Boolean,default:!1},tableNo:{type:String,default:null},tableId:{type:[Number,String],default:null},isUpdate:{type:Boolean,default:!1}},emits:["update:show","success"],setup(t,{emit:_}){const p=t,b=l(!1),g=l("");a((()=>p.show),(()=>{p.show&&(g.value="")}));const w=e=>{e&&(g.value+=e)},k=async()=>{if(g.value<=0)return y({title:m("請輸入人數"),icon:"none"});try{b.value=!0;const a=await(t={table_id:p.tableId,meal_num:g.value},l=p.isUpdate,e(l?"order.Order/updateMealNum":"order.Order/tableBuy",t));1==a.code&&(y({title:a.msg,icon:"none"}),T(p.tableId),_("update:show",!1),setTimeout((()=>{_("success")}),100))}catch(a){}finally{b.value=!1}var t,l};return(e,t)=>{const l=u(s("ti-input"),i),a=h,y=u(s("ti-keyboard"),o),I=u(s("ti-modal"),d);return n(),c(I,{show:p.show,title:`[${p.tableNo}]${f(m)("就餐人數")}`},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-modify-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:f(m)("請輸入人數"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:r((()=>[v(a,{class:"ti-dialog-btn"},{default:r((()=>[v(y,{primaryLoading:b.value,isDoubleZero:!0,isCross:!1,isDrop:!1,onExit:t[1]||(t[1]=e=>_("update:show",!1)),onClear:t[2]||(t[2]=e=>g.value=""),onInput:w,onConfirm:k},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-b18daf9d"]]),pe=t({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},tableNo:{type:[Number,String],default:null},tableId:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0}},emits:["success","change"],setup(t,{emit:a}){const i=t,o=H((()=>i.orderList&&i.orderList.length>0));H((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)>0))));const c=H((()=>i.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)<=0)))),b=l(!1),g=l(!1),I=l(!1),C=l(!1),x=l(!1),$=l(!1),P=l(!1),N=l(!1),S=l(!1),L=l(!1),U=l(!1),D=()=>{V(),setTimeout((()=>{a("change")}),100)},O=async()=>{var t,l;if(!g.value)try{g.value=!0;const u=await(l={order_product_id:null==(t=i.productItem)?void 0:t.order_product_id},e("order.HallCart/delProduct",l));y({title:u.msg,icon:"none"}),a("success")}catch(u){}finally{b.value=!1,g.value=!1}},j=async()=>{var t;if(!C.value)try{C.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/sendKitchen",t,{isLoading:!1}));y({title:l.msg,icon:"none"}),a("success"),I.value=!1}catch(l){I.value=!1}finally{C.value=!1}};return(e,l)=>{const y=K,V=h,B=u(s("ti-modal"),d);return n(),w(k,null,[v(V,{class:"ti-action-box"},{default:r((()=>[v(V,{class:"ti-action-btn"},{default:r((()=>[v(V,{class:"ti-btn-box"},{default:r((()=>{var e,a,u;return[v(y,{class:"ti-btn-item",disabled:!1,onClick:D},{default:r((()=>[_(p(f(m)("返回")),1)])),_:1}),v(y,{class:"ti-btn-item danger",disabled:!(t.productItem&&0==(null==(e=t.productItem)?void 0:e.is_send_kitchen)),onClick:l[0]||(l[0]=e=>b.value=!0)},{default:r((()=>[_(p(f(m)("删除")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item",disabled:0!=(null==(a=t.productItem)?void 0:a.is_send_kitchen),onClick:l[1]||(l[1]=e=>P.value=!0)},{default:r((()=>[_(p(f(m)("备注")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item",disabled:!f(o),onClick:l[2]||(l[2]=e=>$.value=!0)},{default:r((()=>[_(p(f(m)("價格")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item",disabled:!1,onClick:l[3]||(l[3]=e=>L.value=!0)},{default:r((()=>[_(p(f(m)("人数")),1)])),_:1}),v(y,{class:"ti-btn-item",disabled:!1,onClick:l[4]||(l[4]=e=>U.value=!0)},{default:r((()=>[_(p(f(m)("转台")),1)])),_:1}),v(y,{class:"ti-btn-item",disabled:0==f(c).length,onClick:l[5]||(l[5]=e=>I.value=!0)},{default:r((()=>[_(p(f(m)("送廚")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item danger",disabled:!(t.productItem&&1==(null==(u=t.productItem)?void 0:u.is_send_kitchen)),onClick:l[6]||(l[6]=e=>N.value=!0)},{default:r((()=>[_(p(f(m)("退菜")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item danger",disabled:!f(o),onClick:l[7]||(l[7]=e=>x.value=!0)},{default:r((()=>[_(p(f(m)("清台")),1)])),_:1},8,["disabled"]),v(y,{class:"ti-btn-item",disabled:!f(o),onClick:l[8]||(l[8]=e=>S.value=!0)},{default:r((()=>[_(p(f(m)("優惠折扣")),1)])),_:1},8,["disabled"])]})),_:1})])),_:1})])),_:1}),v(B,{class:"ti-action-tips",show:b.value,"onUpdate:show":l[9]||(l[9]=e=>b.value=e),confirmLoading:g.value,title:f(m)("溫馨提示"),content:f(m)("是否删除此商品？"),onConfirm:O},null,8,["show","confirmLoading","title","content"]),v(B,{class:"ti-action-tips",show:I.value,"onUpdate:show":l[10]||(l[10]=e=>I.value=e),confirmLoading:C.value,title:f(m)("溫馨提示"),content:f(m)("是否将商品送廚？"),onConfirm:j},null,8,["show","confirmLoading","title","content"]),v(_e,{show:L.value,"onUpdate:show":l[11]||(l[11]=e=>L.value=e),isUpdate:!0,tableId:i.tableId,tableNo:i.tableNo,onSuccess:l[12]||(l[12]=e=>a("success"))},null,8,["show","tableId","tableNo"]),v(ve,{show:U.value,"onUpdate:show":l[13]||(l[13]=e=>U.value=e),tableId:i.tableId,tableNo:i.tableNo,onSuccess:l[14]||(l[14]=e=>a("success"))},null,8,["show","tableId","tableNo"]),v(ce,{show:x.value,"onUpdate:show":l[15]||(l[15]=e=>x.value=e),sendKitchen:i.sendKitchen,tableId:i.tableId,onSuccess:l[16]||(l[16]=e=>a("change"))},null,8,["show","sendKitchen","tableId"]),v(se,{show:$.value,"onUpdate:show":l[17]||(l[17]=e=>$.value=e),productItem:i.productItem,onSuccess:l[18]||(l[18]=e=>a("success"))},null,8,["show","productItem"]),v(oe,{show:P.value,"onUpdate:show":l[19]||(l[19]=e=>P.value=e),productItem:i.productItem,onSuccess:l[20]||(l[20]=e=>a("success"))},null,8,["show","productItem"]),v(de,{show:N.value,"onUpdate:show":l[21]||(l[21]=e=>N.value=e),tableId:i.tableId,productItem:i.productItem,onSuccess:l[22]||(l[22]=e=>a("success"))},null,8,["show","tableId","productItem"]),v(ne,{show:S.value,"onUpdate:show":l[23]||(l[23]=e=>S.value=e),tableId:i.tableId,productItem:i.productItem,totalPayPrice:t.totalPayPrice,onSuccess:l[24]||(l[24]=e=>a("success"))},null,8,["show","tableId","productItem","totalPayPrice"])],64)}}},[["__scopeId","data-v-0068dd91"]]),fe=t({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const a=e,i=l(!1),o=async e=>{var l,u;const s={order_product_id:null==(l=a.productItem)?void 0:l.order_product_id,product_num:null==(u=a.productItem)?void 0:u.total_num,type:e};"up"==e?s.product_num+=1:s.product_num-=1;try{i.value=!0;1==(await Y(s)).code&&t("change")}catch(o){}finally{i.value=!1}};return(e,t)=>{const l=u(s("uni-icons"),M),d=K,f=h;return n(),c(f,{class:"ti-number-box",onClick:t[2]||(t[2]=z((()=>{}),["stop"]))},{default:r((()=>{var e,u,s,n,c,m;return[v(d,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=a.productItem)?void 0:e.total_num)<=1||i.value||(null==(u=a.productItem)?void 0:u.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>o("down"))},{default:r((()=>[v(l,{"custom-prefix":"iconfont",type:"icon-minus",size:"16"})])),_:1},8,["disabled"]),v(f,{class:"ti-number-input"},{default:r((()=>{var e;return[_(p((null==(e=a.productItem)?void 0:e.total_num)||1),1)]})),_:1}),v(d,{class:"ti-number-btn ti-number-plus",disabled:(null==(s=a.productItem)?void 0:s.total_num)>=(null==(c=null==(n=a.productItem)?void 0:n.product)?void 0:c.product_stock)||i.value||(null==(m=a.productItem)?void 0:m.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>o("up"))},{default:r((()=>[v(l,{type:"plusempty",size:"16"})])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-cdd7204f"]]);const me=t({__name:"member",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null}},emits:["update:show","change"],setup(e,{emit:t}){const m=e,y=l(!1),g=l(""),w=l({});a((()=>m.show),(()=>{m.show&&(g.value="",w.value={})}));const k=()=>{t("update:show",!1),t("change",null)},I=e=>{e&&(g.value+=e)},C=async()=>{try{y.value=!0;const e=await ae({mobile:g.value,table_id:m.tableId});w.value={...e.data.user,pay_price:e.data.total_product_pay_price}}catch(e){}finally{y.value=!1}},S=()=>{t("update:show",!1),t("change",w.value)};return(e,t)=>{const l=u(s("ti-input"),i),a=u(s("ti-button"),b),L=h,U=N,V=u(s("ti-keyboard"),o),D=u(s("ti-modal"),d);return n(),c(D,{show:m.show,title:e.$t("会员")},{content:r((()=>[v(L,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(L,{class:"ti-payment-input"},{default:r((()=>[v(l,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e),placeholder:e.$t("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),v(a,{loading:y.value,type:"primary",onClick:C},{default:r((()=>[_(p(e.$t("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(u=w.value)?void 0:u.user_id)?(n(),c(L,{key:0,class:"ti-payment-member"},{default:r((()=>[v(L,{class:"ti-member-list"},{default:r((()=>[v(L,{class:"ti-member-item"},{default:r((()=>[v(L,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(L,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p(null==(e=w.value)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(L,{class:"ti-member-item"},{default:r((()=>[v(L,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(L,{class:"ti-member-name"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=w.value)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=w.value)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(L,{class:"ti-member-item"},{default:r((()=>[v(L,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(L,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(L,{class:"ti-member-item"},{default:r((()=>[v(L,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(L,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p((null==(e=w.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),v(L,{class:"ti-member-discount"},{default:r((()=>[v(U,{class:"ti-discount-title"},{default:r((()=>[_(p(e.$t("會員折扣應收金額")),1)])),_:1}),v(U,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=w.value)?void 0:e.pay_price)||0)),1)]})),_:1}),v(U,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=w.value)?void 0:e.pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):P("",!0)]})),_:1})])),footer:r((()=>[v(L,{class:"ti-dialog-btn"},{default:r((()=>[v(V,{isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:k,onClear:t[1]||(t[1]=e=>g.value=""),onInput:I,onConfirm:S})])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-3bc0a803"]]),ye=t({__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},tableId:{type:[Number,String],default:null},orderId:{type:[Number,String],default:null}},emits:["update:show"],setup(t,{emit:i}){const o=t,m=l(!1),g=l({}),D=l([]),O=l({delivery:40,pay_type:"40",user_id:null,table_id:null}),B=l(!1),T=l(!1);a((()=>o.show),(()=>{o.show&&(D.value=[],O.value.pay_type="40")})),a((()=>O.value.pay_type),(()=>{o.show&&(O.value.pay_type>0||(D.value&&D.value.length>0?O.value.pay_type=D.value[0].value:ue().then((e=>{D.value=e.data||[],O.value.pay_type=D.value[0].value}))))}));const H=e=>{g.value=e},K=e=>{O.value.pay_type=e.detail.value},M=async()=>{if(!T.value)try{T.value=!0;const e=await ie({order_id:o.orderId});y({title:e.msg,icon:"none"})}catch(e){}finally{T.value=!1}},z=async()=>{var t;if(B.value)return;const l={...O.value};l.table_id=o.tableId,l.user_id=null==(t=g.value)?void 0:t.user_id;try{B.value=!0;const t=await function(t){return e("order.order/pay",t)}(l);y({title:t.msg,icon:"none"}),i("update:show",!1),V(),setTimeout((()=>{i("success")}),100)}catch(a){}finally{B.value=!1}};return(e,l)=>{const a=N,y=h,V=S,Z=L,F=U,R=E,q=u(s("ti-empty-data"),j),G=u(s("ti-button"),b),W=u(s("ti-modal"),d);return n(),c(W,{show:o.show,title:e.$t("結賬")},{content:r((()=>[v(y,{class:"ti-dialog-content"},{default:r((()=>{var u;return[v(y,{class:"ti-payment-money"},{default:r((()=>[v(a,{class:"ti-payment-label"},{default:r((()=>[_(p(e.$t("應收金額")),1)])),_:1}),v(a,{class:"ti-payment-price"},{default:r((()=>[_(p(f(x)(t.totalPayPrice)),1)])),_:1}),v(a,{class:"ti-payment-subPrice"},{default:r((()=>[_(p(f($)(t.totalPayPrice)),1)])),_:1})])),_:1}),v(y,{class:"ti-payment-type"},{default:r((()=>[v(y,{class:"ti-type-label"},{default:r((()=>[_(p(e.$t("收款方式")),1)])),_:1}),v(F,{class:"ti-type-radio",onChange:K},{default:r((()=>[v(Z,null,{default:r((()=>[v(V,{value:"40",color:"#ffbe00",checked:"true"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("現金")),1)])),_:1})])),_:1}),v(Z,null,{default:r((()=>[v(V,{value:"10",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1})])),_:1}),v(Z,null,{default:r((()=>[v(V,{value:"",color:"#ffbe00"}),v(a,{class:"ti-radio-text"},{default:r((()=>[_(p(e.$t("其他方式")),1)])),_:1})])),_:1})])),_:1})])),_:1}),"40"!=O.value.pay_type&&"10"!=O.value.pay_type?(n(),c(y,{key:0,class:"ti-payment-other"},{default:r((()=>[v(y,{class:"ti-other-title"},{default:r((()=>[_(p(e.$t("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),D.value&&D.value.length>0?(n(),c(y,{key:0,class:"ti-other-list"},{default:r((()=>[(n(!0),w(k,null,I(D.value,(e=>(n(),c(y,{key:e.value,class:C([{active:e.value==O.value.pay_type},"ti-other-item"]),onClick:t=>O.value.pay_type=e.value},{default:r((()=>[v(y,{class:"ti-other-image"},{default:r((()=>{var t;return[v(R,{src:`${(null==(t=f(A)())?void 0:t.api_url)||""}/${e.img}`,mode:"widthFix"},null,8,["src"])]})),_:2},1024),v(y,{class:"ti-other-text"},{default:r((()=>[_(p(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(n(),c(q,{key:1}))])),_:1})):P("",!0),(null==(u=g.value)?void 0:u.user_id)?(n(),c(y,{key:1,class:"ti-payment-member"},{default:r((()=>[v(y,{class:"ti-payment-top"},{default:r((()=>[v(y,{class:"ti-payment-top-name"},{default:r((()=>[_(p(e.$t("會員")),1)])),_:1}),v(y,{class:"ti-payment-top-discomfort",onClick:l[0]||(l[0]=e=>g.value=null)},{default:r((()=>[_(p(e.$t("不使用此會員")),1)])),_:1})])),_:1}),v(y,{class:"ti-member-list"},{default:r((()=>[v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("暱稱")),1)])),_:1}),v(y,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p(null==(e=g.value)?void 0:e.nickName),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("會員卡/等級")),1)])),_:1}),v(y,{class:"ti-member-name"},{default:r((()=>{var e,t,l,a;return[_(p(`${null==(t=null==(e=g.value)?void 0:e.card)?void 0:t.card_name}/${null==(a=null==(l=g.value)?void 0:l.grade)?void 0:a.name}`),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("餘額")),1)])),_:1}),v(y,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p((null==(e=g.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),v(y,{class:"ti-member-item"},{default:r((()=>[v(y,{class:"ti-member-head"},{default:r((()=>[_(p(e.$t("積分")),1)])),_:1}),v(y,{class:"ti-member-name"},{default:r((()=>{var e;return[_(p((null==(e=g.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),v(y,{class:"ti-member-discount"},{default:r((()=>[v(a,{class:"ti-discount-title"},{default:r((()=>[_(p(e.$t("會員折扣應收金額")),1)])),_:1}),v(a,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=g.value)?void 0:e.pay_price)||0)),1)]})),_:1}),v(a,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=g.value)?void 0:e.pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):P("",!0),v(me,{show:m.value,"onUpdate:show":l[1]||(l[1]=e=>m.value=e),tableId:o.tableId,onChange:H},null,8,["show","tableId"])]})),_:1})])),footer:r((()=>[v(y,{class:"ti-dialog-btn"},{default:r((()=>[v(G,{onClick:l[2]||(l[2]=e=>i("update:show",!1))},{default:r((()=>[_(p(e.$t("退出")),1)])),_:1}),v(G,{loading:T.value,onClick:M},{default:r((()=>[_(p(e.$t("打印")),1)])),_:1},8,["loading"]),v(G,{onClick:l[3]||(l[3]=e=>m.value=!0)},{default:r((()=>[_(p(e.$t("会员")),1)])),_:1}),v(G,{loading:B.value,type:"primary",onClick:z},{default:r((()=>[_(p(e.$t("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-e57e7fdd"]]),he=t({__name:"time-meter",props:{tableDetail:{type:Object,default:()=>({})}},setup(e){const t=e,u=l(),i=l(),s=l(`00 ${m("分钟")} 00 ${m("秒")}`);a((()=>{var e;return null==(e=t.tableDetail)?void 0:e.elapsed_time}),(()=>{var e;i.value=null==(e=t.tableDetail)?void 0:e.elapsed_time,i.value>0&&(u.value&&clearInterval(u.value),u.value=setInterval((()=>{i.value++,o(i.value)}),1e3))}),{deep:!0}),Z((()=>{u.value&&clearInterval(u.value)}));const o=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";t>0&&(u+=`${d(t)} ${m("小时")} `),u+=`${d(l)} ${m("分钟")} ${d(a)} ${m("秒")}`,s.value=u},d=e=>e<10?`0${e}`:e;return(e,l)=>{const a=h;return n(),c(a,{class:"ti-table-info"},{default:r((()=>[v(a,{class:"ti-table-num"},{default:r((()=>{var e,l;return[_(p(`${(null==(e=t.tableDetail)?void 0:e.table_no)||""} (${(null==(l=t.tableDetail)?void 0:l.meal_num)||0})`),1)]})),_:1}),v(a,{class:"ti-table-time"},{default:r((()=>[_(p(f(m)("已就餐："))+p(s.value),1)])),_:1})])),_:1})}}},[["__scopeId","data-v-72effccd"]]),be=t({__name:"cart-list",emits:["change"],setup(t,{expose:a,emit:i}){const o=l(!1),d=l(!1),y=l({}),b=l({}),g=l(),S=l([]),L=l(),U=l({table_no:"",meal_num:"",elapsed_time:""}),V=()=>{o.value=!0},B=async t=>{var l,a,u,i,s,o,n,c,r,v,_,p,f,m,h,w;try{t&&(d.value=!0);const k=await(w={table_id:F()},e("order.HallCart/tableProductList",w,{isLoading:!1}));if(L.value=F(),g.value=k.data.order_id,U.value={table_no:null==(u=null==(a=null==(l=k.data)?void 0:l.allProductInfo)?void 0:a.orderInfo)?void 0:u.table_no,meal_num:null==(o=null==(s=null==(i=k.data)?void 0:i.allProductInfo)?void 0:s.orderInfo)?void 0:o.meal_num,elapsed_time:null==(r=null==(c=null==(n=k.data)?void 0:n.allProductInfo)?void 0:c.orderInfo)?void 0:r.elapsed_time},b.value=null==(_=null==(v=k.data)?void 0:v.allProductInfo)?void 0:_.sumInfo,S.value=(null==(m=null==(f=null==(p=k.data)?void 0:p.allProductInfo)?void 0:f.orderInfo)?void 0:m.product)||[],S.value&&S.value.length>0){let e=0;(null==(h=y.value)?void 0:h.order_product_id)&&(e=S.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=y.value)?void 0:t.order_product_id)}))),y.value=S.value[Math.max(e,0)]}}catch(k){}finally{t&&(d.value=!1)}};return B(!0),a({getCartData:B}),(e,t)=>{var l,a;const T=h,H=u(s("ti-loading"),O),M=N,z=u(s("ti-empty-data"),j),A=D,E=K;return n(),w(k,null,[v(T,{class:"ti-cart-box"},{default:r((()=>[v(he,{tableDetail:U.value},null,8,["tableDetail"]),v(T,{class:"ti-cart-list"},{default:r((()=>[v(T,{class:"ti-cart-shop-head"},{default:r((()=>[v(T,{class:"ti-shop-head-title"},{default:r((()=>[_(p(f(m)("商品名稱")),1)])),_:1}),v(T,{class:"ti-shop-head-money"},{default:r((()=>[_(p(f(m)("金額")),1)])),_:1}),v(T,{class:"ti-shop-head-num"},{default:r((()=>[_(p(f(m)("數量")),1)])),_:1})])),_:1}),v(T,{class:"ti-shop-list"},{default:r((()=>[v(A,{"scroll-y":""},{default:r((()=>[d.value?(n(),c(H,{key:0})):S.value&&S.value.length>0?(n(),c(T,{key:1,class:"ti-shop-box"},{default:r((()=>[(n(!0),w(k,null,I(S.value,(e=>{var l;return n(),c(T,{key:e,class:C([{active:(null==(l=y.value)?void 0:l.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:t=>(e=>{var t;(null==(t=y.value)?void 0:t.order_product_id)!=(null==e?void 0:e.order_product_id)&&(y.value=e)})(e)},{default:r((()=>[v(T,{class:"ti-shop-item-box"},{default:r((()=>[v(T,{class:"ti-shop-box"},{default:r((()=>[v(T,{class:"ti-shop-body-top"},{default:r((()=>[v(T,{class:"ti-shop-title text-ellipsis"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),e.product_attr?(n(),c(T,{key:0,class:"ti-shop-spec"},{default:r((()=>[_("( "+p(e.product_attr)+" )",1)])),_:2},1024)):P("",!0)])),_:2},1024),v(T,{class:"ti-shop-body-money"},{default:r((()=>[v(M,{class:"ti-shop-price"},{default:r((()=>[_(p(f(x)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(M,{class:"ti-shop-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),v(fe,{productItem:e,onChange:t[0]||(t[0]=e=>B())},null,8,["productItem"])])),_:2},1024),e.remark?(n(),c(T,{key:0,class:"ti-shop-remark"},{default:r((()=>[_(p(e.remark),1)])),_:2},1024)):P("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(n(),c(z,{key:2}))])),_:1})])),_:1})])),_:1}),v(T,{class:"ti-cart-statistics"},{default:r((()=>[v(T,{class:"ti-cart-total"},{default:r((()=>[v(M,{class:"ti-total-text"},{default:r((()=>[_(p(f(m)("小計:")),1)])),_:1}),v(M,{class:"ti-total-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=b.value)?void 0:e.subtotal)||0)),1)]})),_:1}),v(M,{class:"ti-total-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),v(T,{class:"ti-cart-discount"},{default:r((()=>[v(T,{class:"ti-discount-item"},{default:r((()=>[v(T,null,{default:r((()=>[v(M,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("服務費:")),1)])),_:1}),v(M,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=b.value)?void 0:e.service_money)||0)),1)]})),_:1}),v(M,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),v(T,null,{default:r((()=>{var e;return[v(M,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("優惠折扣:")),1)])),_:1}),v(M,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f(x)((null==(e=b.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),f($)((null==(e=b.value)?void 0:e.special_discount)||0)?(n(),c(M,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=b.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):P("",!0)]})),_:1})])),_:1}),v(T,{class:"ti-discount-item"},{default:r((()=>[v(T,null,{default:r((()=>[v(M,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("消費稅:")),1)])),_:1}),v(M,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=b.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),v(M,{class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),v(T,null,{default:r((()=>{var e;return[v(M,{class:"ti-discount-text"},{default:r((()=>[_(p(f(m)("會員折扣:")),1)])),_:1}),v(M,{class:"ti-discount-price"},{default:r((()=>{var e;return[_(p(`-${f(x)((null==(e=b.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),f($)((null==(e=b.value)?void 0:e.total_user_discount_money)||0)?(n(),c(M,{key:0,class:"ti-discount-subPrice"},{default:r((()=>{var e;return[_(p(`-${f($)((null==(e=b.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):P("",!0)]})),_:1})])),_:1})])),_:1}),v(T,{class:"ti-cart-settlement"},{default:r((()=>[v(T,{class:"ti-settlement-total"},{default:r((()=>[v(M,{class:"ti-settlement-text"},{default:r((()=>[_(p(f(m)("應收：")),1)])),_:1}),v(M,{class:"ti-settlement-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=b.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),v(M,{class:"ti-settlement-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),v(E,{class:"ti-settlement-btn",disabled:S.value.length<=0,onClick:V},{default:r((()=>[v(M,null,{default:r((()=>[_(p(f(m)("結賬")),1)])),_:1}),S.value.length>0?(n(),c(M,{key:0,class:"ti-settlement-badge"},{default:r((()=>[_(p(S.value.length),1)])),_:1})):P("",!0)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),v(pe,{productItem:y.value,totalPayPrice:null==(l=b.value)?void 0:l.total_pay_price,tableId:L.value,tableNo:U.value.table_no,orderList:S.value,onChange:t[1]||(t[1]=e=>i("change")),onSuccess:t[2]||(t[2]=e=>B())},null,8,["productItem","totalPayPrice","tableId","tableNo","orderList"]),v(ye,{show:o.value,"onUpdate:show":t[3]||(t[3]=e=>o.value=e),totalPayPrice:null==(a=b.value)?void 0:a.total_pay_price,orderId:g.value,tableId:L.value,onSuccess:t[4]||(t[4]=e=>i("change"))},null,8,["show","totalPayPrice","orderId","tableId"])],64)}}},[["__scopeId","data-v-e49c86b2"]]),ge=t({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(e,{emit:t}){const u=e,i=l(0),s=l(0),o=l([]);a((()=>u.list),(async e=>{if(await R(),!e||0==e.length)return;const t=q().in(this);if(e.map(((e,l)=>{t.select(`#scroll-item-${l}`).boundingClientRect((e=>{if(!e)return;const t=o.value;t[l]=e.width+10,o.value=t})).exec()})),u.menuId>0){const e=u.list.findIndex((e=>e.category_id==u.menuId));e>-1&&d(e)}}),{deep:!0,immediate:!0});const d=e=>{s.value=e,i.value=o.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(o.value[e]+100),t("update:menuId",u.list[e].category_id)};return(e,t)=>{const l=N,a=h,o=D;return n(),c(o,{class:"ti-dish-menu","scroll-left":i.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:r((()=>[v(a,{class:"ti-menu-content"},{default:r((()=>[(n(!0),w(k,null,I(u.list,((e,t)=>(n(),c(a,{key:t,class:C(["ti-menu-item",{active:t==s.value}]),id:`scroll-item-${t}`,onClick:e=>d(t)},{default:r((()=>[v(l,{class:"ti-menu-title"},{default:r((()=>[_(p(e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-384c1800"]]),we=t({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId"],setup(e,{emit:t}){const u=l([]),i=l(0),s=l(0),o=H((()=>{let e=(u.value.find((e=>e.category_id==i.value))||{}).child||[];return e&&e.length>0&&(e=[{name_text:m("全部"),category_id:0}].concat(e)),e}));a((()=>i.value),(()=>{t("update:categoryId",i.value),o&&o.length>0&&(s.value=o.value[0].category_id)}));return(async()=>{try{const e=await ee();e.data.list&&(u.value=[{name_text:m("全部"),category_id:0}].concat(e.data.list),i.value=u.value[0].category_id)}catch(e){}})(),(e,l)=>{const a=h;return n(),c(a,{class:"ti-category-box"},{default:r((()=>[v(ge,{list:u.value,menuId:i.value,"onUpdate:menuId":l[0]||(l[0]=e=>i.value=e)},null,8,["list","menuId"]),v(a,{class:"ti-dish-secondary"},{default:r((()=>[(n(!0),w(k,null,I(f(o),((e,l)=>(n(),c(a,{key:l,class:C([{active:e.category_id==s.value},"ti-secondary-item"]),onClick:l=>{return a=e.category_id,s.value=a,void t("update:categoryId",s.value>0?s.value:i.value);var a}},{default:r((()=>[_(p(e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-ebcc8dbd"]]),ke=t({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(t,{emit:i}){const o=t,b=l({}),g=l(!1),S=l(!1),L=l({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:40,describe:null});a((()=>o.show),(()=>{o.show&&U()}));const U=async()=>{var e,t,l,a,u,i,s,d,n;if(!g.value||o.productId)try{g.value=!0;const c=await te(o.productId);b.value=c.data,L.value.product_id=null==(e=b.value)?void 0:e.product_id,L.value.price=null==(t=b.value)?void 0:t.product_price,L.value.product_price=null==(l=b.value)?void 0:l.product_price,(null==(a=b.value)?void 0:a.product_sku)&&(null==(u=b.value)?void 0:u.product_sku.length)>0&&(L.value.product_sku_id=null==(i=b.value)?void 0:i.product_sku[0].product_sku_id),(null==(s=b.value)?void 0:s.product_attr)&&(null==(d=b.value)?void 0:d.product_attr.length)>0&&(null==(n=b.value)||n.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value)&&(null==e?void 0:e.attribute_value.length)>0?L.value.attr[t]=0:L.value.attr[t]=null}))),L.value.feed&&L.value.feed.length>0&&(L.value.feed=[])}catch(c){}finally{g.value=!1}},V=async()=>{var t,l,a,u,s,o,d,n,c;if(S.value)return;const r={...L.value};r.attr=r.attr.join(","),r.feed=r.feed.join(",");let v=[];(null==(t=b.value)?void 0:t.product_sku)&&(null==(l=b.value)?void 0:l.product_sku.length)>0&&v.push(null==(a=b.value)?void 0:a.product_sku.find((e=>e.product_sku_id==L.value.product_sku_id)).spec_name_text),(null==(u=b.value)?void 0:u.product_attr)&&(null==(s=b.value)?void 0:s.product_attr.length)&&(null==(o=b.value)||o.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value)&&(null==e?void 0:e.attribute_value.length)>0&&(null==e?void 0:e.attribute_value[L.value.attr[t]])&&v.push(null==e?void 0:e.attribute_value[L.value.attr[t]])}))),(null==(d=b.value)?void 0:d.product_feed)&&(null==(n=b.value)?void 0:n.product_feed.length)>0&&(null==(c=b.value)||c.product_feed.map(((e,t)=>{O(t)&&v.push(e.feed_name_text)}))),r.describe=v.join(";"),r.table_id=F();try{S.value=!0;const t=await function(t){return e("order.HallCart/add",t)}(r);1==t.code&&(y({title:t.msg,icon:"none"}),i("update:show",!1),i("success"))}catch(_){}finally{S.value=!1}},O=e=>L.value.feed.indexOf(e)>-1,j=(e,t)=>L.value.attr[e]==t;return(e,t)=>{const l=E,a=h,y=N,g=D,U=u(s("ti-modal"),d);return n(),c(U,{show:o.show,title:f(m)("商品详情"),confirmLoading:S.value,onCancel:t[0]||(t[0]=e=>i("update:show",!1)),onConfirm:V},{content:r((()=>[v(a,{class:"ti-dialog-content"},{default:r((()=>[v(a,{class:"ti-detail-box"},{default:r((()=>[v(a,{class:"ti-detail-image"},{default:r((()=>{var e,t,a,u;return[(null==(e=b.value)?void 0:e.image)&&(null==(t=b.value)?void 0:t.image[0])&&(null==(a=b.value)?void 0:a.image[0].file_path)?(n(),c(l,{key:0,src:null==(u=b.value)?void 0:u.image[0].file_path,mode:"widthFix"},null,8,["src"])):P("",!0)]})),_:1}),v(a,{class:"ti-detail-con"},{default:r((()=>[v(a,{class:"ti-detail-title text-ellipsis"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_name_text),1)]})),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單價：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(f(x)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1}),v(y,{class:"ti-detail-subPrice"},{default:r((()=>{var e;return[_(p(f($)((null==(e=b.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),v(a,{class:"ti-price-box"},{default:r((()=>[v(y,{class:"ti-detail-unit"},{default:r((()=>[_(p(f(m)("單位：")),1)])),_:1}),v(y,{class:"ti-detail-price"},{default:r((()=>{var e;return[_(p(null==(e=b.value)?void 0:e.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),v(a,{class:"ti-detail-specs"},{default:r((()=>[v(g,{"scroll-y":""},{default:r((()=>[v(a,{class:"ti-specs-box"},{default:r((()=>{var e,t,l,u,i,s,o;return[(null==(e=b.value)?void 0:e.product_sku)&&(null==(t=b.value)?void 0:t.product_sku.length)>0?(n(),c(a,{key:0,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("規格")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(n(!0),w(k,null,I(null==(e=b.value)?void 0:e.product_sku,(e=>(n(),c(a,{key:e.product_sku_id,class:C([{active:e.product_sku_id==L.value.product_sku_id},"ti-child-item"]),onClick:t=>{return l=e.product_sku_id,void(L.value.product_sku_id!=l&&(L.value.product_sku_id=l));var l}},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.spec_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f(x)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):P("",!0),(null==(l=b.value)?void 0:l.product_attr)&&(null==(u=b.value)?void 0:u.product_attr.length)>0?(n(!0),w(k,{key:1},I(null==(i=b.value)?void 0:i.product_attr,((e,t)=>(n(),c(a,{key:t,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(e.attribute_name_text),1)])),_:2},1024),v(a,{class:"ti-specs-child"},{default:r((()=>[(n(!0),w(k,null,I(null==e?void 0:e.attribute_value,((e,l)=>(n(),c(a,{key:l,class:C([{active:j(t,l)},"ti-child-item"]),onClick:e=>((e,t)=>{L.value.attr[e]=t})(t,l)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):P("",!0),(null==(s=b.value)?void 0:s.product_feed)&&(null==(o=b.value)?void 0:o.product_feed.length)>0?(n(),c(a,{key:2,class:"ti-specs-item"},{default:r((()=>[v(a,{class:"ti-specs-title"},{default:r((()=>[_(p(f(m)("加料")),1)])),_:1}),v(a,{class:"ti-specs-child"},{default:r((()=>{var e;return[(n(!0),w(k,null,I(null==(e=b.value)?void 0:e.product_feed,((e,t)=>(n(),c(a,{key:t,class:C([{active:O(t)},"ti-child-item"]),onClick:e=>(e=>{const t=L.value.feed.indexOf(e);t>=0?L.value.feed.splice(t,1):L.value.feed.push(e)})(t)},{default:r((()=>[v(y,{class:"ti-child-name"},{default:r((()=>[_(p(e.feed_name_text),1)])),_:2},1024),v(y,{class:"ti-child-price"},{default:r((()=>[_(p(f(x)((null==e?void 0:e.price)||0)),1)])),_:2},1024),v(y,{class:"ti-child-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):P("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-4d66353e"]]),Ie=t({__name:"dish-list",emits:["success"],setup(e,{emit:t}){const i=l(!1),o=l({category_id:null,page:1,list_rows:20}),d=l([]),b=l(!1),g=l(),S=l(!1);a((()=>o.value.category_id),(()=>{V()}));const L=()=>{t("success")},U=()=>{S.value&&(o.value.page+=1,B())},V=()=>{o.value.page=1,B(!0)},B=async e=>{var t,l,a,u,i,s;if(b.value)return;const n={...o.value};n.category_id||(n.category_id=null);try{e&&(b.value=!0);const c=await le(n);1==o.value.page&&(d.value=[]),d.value=d.value.concat((null==(l=null==(t=c.data)?void 0:t.list)?void 0:l.data)||[]),S.value=(null==(u=null==(a=c.data)?void 0:a.list)?void 0:u.last_page)>(null==(s=null==(i=c.data)?void 0:i.list)?void 0:s.current_page)}catch(c){}finally{e&&(b.value=!1)}};return V(),(e,t)=>{const l=u(s("ti-loading"),O),a=E,V=N,B=h,T=u(s("ti-empty-data"),j),H=D;return n(),w(k,null,[v(B,{class:"ti-dish-box"},{default:r((()=>[v(we,{categoryId:o.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>o.value.category_id=e)},null,8,["categoryId"]),v(B,{class:"ti-dish-list"},{default:r((()=>[v(H,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:U},{default:r((()=>[b.value?(n(),c(l,{key:0})):d.value&&d.value.length>0?(n(),w(k,{key:1},[v(B,{class:"ti-dish-goods"},{default:r((()=>[(n(!0),w(k,null,I(d.value,((e,t)=>(n(),c(B,{key:t,class:C([{"sold-out":e.product_stock<=0},"ti-goods-item"]),onClick:t=>(e=>{if(e.product_stock<=0)return y({title:m("已售罄"),icon:"none"});i.value=!0,g.value=e.product_id})(e)},{default:r((()=>[v(B,{class:"ti-goods-image"},{default:r((()=>[e.image&&e.image[0]&&e.image[0].file_path?(n(),c(a,{key:0,src:e.image[0].file_path,mode:"widthFix"},null,8,["src"])):P("",!0),v(V,{class:"sold-out-text"},{default:r((()=>[_(p(f(m)("已售罄")),1)])),_:1})])),_:2},1024),v(B,{class:"ti-goods-content"},{default:r((()=>[v(B,{class:"ti-goods-title"},{default:r((()=>[_(p(e.product_name_text),1)])),_:2},1024),v(B,{class:"ti-price-box"},{default:r((()=>[v(V,{class:"ti-goods-price"},{default:r((()=>[_(p(f(x)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),v(V,{class:"ti-goods-subPrice"},{default:r((()=>[_(p(f($)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(l,{status:S.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(T,{key:2}))])),_:1})])),_:1})])),_:1}),v(ke,{show:i.value,"onUpdate:show":t[1]||(t[1]=e=>i.value=e),productId:g.value,onSuccess:L},null,8,["show","productId"])],64)}}},[["__scopeId","data-v-a87260b5"]]),Ce=t({__name:"index",emits:["change"],setup(e,{emit:t}){const a=l();G((()=>{W()}));const u=()=>{var e;null==(e=a.value)||e.getCartData()};return(e,l)=>{const i=h;return n(),c(i,{class:"ti-order-food"},{default:r((()=>[v(be,{ref_key:"cartRef",ref:a,onChange:l[0]||(l[0]=e=>t("change"))},null,512),v(Ie,{onSuccess:u})])),_:1})}}},[["__scopeId","data-v-a1a999ff"]]),xe=t({__name:"cancel-all",props:{show:{type:Boolean,default:!1},tableId:{type:[Number,String],default:null},list:{type:Array,default:()=>[]}},emits:["update:show","success"],setup(t,{emit:a}){const i=t,o=l(!1),f=async()=>{var t;if(!o.value)try{o.value=!0;const l=await(t={table_id:i.tableId},e("order.HallCart/cancel",t));y({title:l.msg,icon:"none"}),a("update:show",!1),a("success")}catch(l){}finally{o.value=!1}};return(e,l)=>{const m=h,y=D,b=u(s("ti-modal"),d);return n(),c(b,{class:"ti-action-tips",title:e.$t("溫馨提示"),show:i.show,confirmLoading:o.value,onCancel:l[0]||(l[0]=e=>a("update:show",!1)),onConfirm:f},{content:r((()=>[v(m,{class:"ti-dialog-content"},{default:r((()=>[i.list&&t.list.length>0?(n(),w(k,{key:0},[v(m,{class:"ti-cancel-title"},{default:r((()=>[_(p(e.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),v(m,{class:"ti-cancel-all"},{default:r((()=>[v(y,{"scroll-y":""},{default:r((()=>[v(m,{class:"ti-cancel-list"},{default:r((()=>[(n(!0),w(k,null,I(i.list,((e,t)=>(n(),c(m,{key:t,class:"ti-cancel-item"},{default:r((()=>[_(p(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(n(),w(k,{key:1},[_(p(e.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-2649cc86"]]),$e=t({__name:"index",emits:["change"],setup(t,{emit:i}){const o=l({area_id:"",type_id:"",table_status:""}),d=l(!1),y=l(!1),b=l([]),g=l(),P=l(),S=l([]),L=l([]),U=H((()=>g.value-P.value)),V=l(!1),B=l(),K=l([]),A=l(!1),E=l(),Z=l();a((()=>o.value),(()=>{G(!0)}),{deep:!0});const F=e=>{const t=Math.floor((e||0)/3600),l=Math.floor((e||0)/60)%60,a=Math.floor(e||0)%60;let u="";return t>0&&(u+=`${R(t)} ${m("小时")} `),u+=`${R(l)} ${m("分钟")} ${R(a)} ${m("秒")}`,u},R=e=>e<10?`0${e}`:e,q=async t=>{var l,a,u;try{const i=await(u={table_id:t},e("order.HallCart/getUnSendKitchen",u));K.value=(null==(a=null==(l=i.data)?void 0:l.detail)?void 0:a.unSendKitchenProduct)||[],V.value=!0,B.value=t}catch(i){}},G=async e=>{var t,l,a;if(!y.value)try{e&&(y.value=!0);const u=await re(o.value);b.value=(null==(t=u.data)?void 0:t.list)||[],g.value=(null==(l=u.data)?void 0:l.total_num)||0,P.value=(null==(a=u.data)?void 0:a.available_num)||0}catch(u){}finally{e&&(y.value=!1)}};return(async()=>{var t,l;try{const a=await e("store.table/tableType");S.value=(null==(t=a.data)?void 0:t.areaList)||[],L.value=(null==(l=a.data)?void 0:l.typeList)||[]}catch(a){}})(),G(!0),(e,t)=>{const l=h,a=D,H=u(s("ti-loading"),O),R=u(s("uni-icons"),M),W=N,J=u(s("ti-empty-data"),j);return n(),w(k,null,[v(l,{class:"ti-dining-box"},{default:r((()=>[v(l,{class:"ti-dining-category"},{default:r((()=>[v(a,{"scroll-x":""},{default:r((()=>[v(l,{class:"ti-category-list"},{default:r((()=>[v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:C(["ti-category-all",{active:""==o.value.area_id}]),onClick:t[0]||(t[0]=e=>o.value.area_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(n(!0),w(k,null,I(S.value,(e=>(n(),c(l,{key:e.area_id,class:C([{active:o.value.area_id==e.area_id},"ti-category-childItem"]),onClick:t=>o.value.area_id=e.area_id},{default:r((()=>[_(p(e.area_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:C(["ti-category-all",{active:""==o.value.type_id}]),onClick:t[1]||(t[1]=e=>o.value.type_id="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[(n(!0),w(k,null,I(L.value,(e=>(n(),c(l,{key:e.type_id,class:C([{active:o.value.type_id==e.type_id},"ti-category-childItem"]),onClick:t=>o.value.type_id=e.type_id},{default:r((()=>[_(p(e.type_name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),v(l,{class:"ti-category-item"},{default:r((()=>[v(l,{class:C(["ti-category-all",{active:""==o.value.table_status}]),onClick:t[2]||(t[2]=e=>o.value.table_status="")},{default:r((()=>[_(p(f(m)("全部")),1)])),_:1},8,["class"]),v(l,{class:"ti-category-child"},{default:r((()=>[v(l,{class:C(["ti-category-childItem",{active:"10"==o.value.table_status}]),onClick:t[3]||(t[3]=e=>o.value.table_status="10")},{default:r((()=>[_(p(f(m)("可用"))+" ("+p(P.value||0)+") ",1)])),_:1},8,["class"]),v(l,{class:C(["ti-category-childItem",{active:"30"==o.value.table_status}]),onClick:t[4]||(t[4]=e=>o.value.table_status="30")},{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(U)||0)+") ",1)])),_:1},8,["class"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(l,{class:"ti-dining-table"},{default:r((()=>[v(a,{class:"ti-scroll","scroll-y":""},{default:r((()=>[y.value?(n(),c(H,{key:0})):b.value&&b.value.length>0?(n(),w(k,{key:1},[v(l,{class:"ti-dining-list"},{default:r((()=>[(n(!0),w(k,null,I(b.value,(e=>(n(),c(l,{key:e.table_id,class:C([{green:30!=e.status},"ti-dining-item"]),onClick:t=>(e=>{30!=e.status?(Z.value=e.table_no,E.value=e.table_id,A.value=!0):(T(e.table_id),i("change"))})(e)},{default:r((()=>[v(l,{class:"ti-dining-number"},{default:r((()=>[_(p(e.table_no),1)])),_:2},1024),30!=e.status?(n(),c(l,{key:0,class:"ti-dining-idle"},{default:r((()=>[_(p(f(m)("空闲中")),1)])),_:1})):(n(),w(k,{key:1},[v(l,{class:"ti-dining-info"},{default:r((()=>[v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-user",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p((null==(t=e.underwayOrder)?void 0:t.meal_num)||0),1)]})),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-wallet",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>[v(W,{class:"ti-dining-info-price"},{default:r((()=>{var t;return[_(p(f(x)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024),v(W,{class:"ti-dining-info-subPrice"},{default:r((()=>{var t;return[_(p(f($)(null==(t=e.underwayOrder)?void 0:t.total_price)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-info-item"},{default:r((()=>[v(l,{class:"ti-dining-info-icon"},{default:r((()=>[v(R,{"custom-prefix":"iconfont",type:"icon-clock",size:"18",color:"#100A05"})])),_:1}),v(l,{class:"ti-dining-info-text"},{default:r((()=>{var t;return[_(p(F(null==(t=e.underwayOrder)?void 0:t.elapsed_time)),1)]})),_:2},1024)])),_:2},1024)])),_:2},1024),v(l,{class:"ti-dining-close",onClick:z((t=>q(e.table_id)),["stop"])},{default:r((()=>[v(R,{type:"closeempty",size:"14",color:"#fff"})])),_:2},1032,["onClick"])],64))])),_:2},1032,["class","onClick"])))),128))])),_:1}),v(H,{status:d.value?"loading":"no-more"},null,8,["status"])],64)):(n(),c(J,{key:2}))])),_:1})])),_:1}),v(l,{class:"ti-dining-total"},{default:r((()=>[v(l,{class:"ti-dining-total-box"},{default:r((()=>[v(l,{class:"ti-dining-total-item"},{default:r((()=>[_(p(f(m)("全部"))+" ("+p(g.value)+")",1)])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color green"}),v(l,null,{default:r((()=>[_(p(f(m)("可用"))+" ("+p(P.value||0)+")",1)])),_:1})])),_:1}),v(l,{class:"ti-dining-total-item"},{default:r((()=>[v(l,{class:"ti-dining-total-color orange"}),v(l,null,{default:r((()=>[_(p(f(m)("佔用"))+" ("+p(f(U)||0)+")",1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),v(xe,{show:V.value,"onUpdate:show":t[5]||(t[5]=e=>V.value=e),tableId:B.value,list:K.value,onSuccess:t[6]||(t[6]=e=>G())},null,8,["show","tableId","list"]),v(_e,{show:A.value,"onUpdate:show":t[7]||(t[7]=e=>A.value=e),tableId:E.value,tableNo:Z.value,onSuccess:t[8]||(t[8]=e=>i("change"))},null,8,["show","tableId","tableNo"])],64)}}},[["__scopeId","data-v-22445472"]]),Pe={__name:"index",setup(e){const t=l();G((()=>{a(),W()}));const a=()=>{t.value=!!F()};return(e,l)=>{const u=J("ti-layout");return n(),c(u,null,{default:r((()=>[t.value?(n(),c(Ce,{key:0,onChange:a})):(n(),c($e,{key:1,onChange:a}))])),_:1})}}};export{Pe as default};
