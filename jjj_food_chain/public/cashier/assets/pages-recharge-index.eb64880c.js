import{_ as e,r as a,a as t,b as l,c as s,l as r,d as u,o as c,f as i,g as o,h as n,i as d,t as m,u as f,j as h,D as _,s as v,k as g,E as p,C as b,G as y,H as k,P as C,U as w,V as x,ab as V,M as U,W as j}from"./index-3bbd2984.js";import{_ as I}from"./u-popup.0dfae59e.js";import{f as O,c as D}from"./payment.ca4cf5da.js";const E=""+new URL("close-40f4220f.svg",import.meta.url).href,R=e({__name:"dialog-recharge",props:{show:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup(e,{emit:w}){a("");const x=a(!1),V=a(!1),U=a(0);var j="inc";const R={1:"inc",2:"dec",3:"final"},B=a(),F=a(""),G=a({}),H=a(""),L=e=>{j=R[e.detail.value]},M=e=>{x.value?F.value+=e+"":V.value&&(H.value+=e+"")},N=()=>{x.value?F.value="":V.value&&(H.value="")},P=()=>{A()},T=()=>{q()},W=async()=>{const e={mobile:F.value};try{const a=await O(e);1==a.code&&(G.value=a.data)}catch(a){}},q=async()=>{const e={user_id:G.value.user_id,source:U.value,recharge_value:H.value,mode:j};try{1==(await D(e)).code&&(setTimeout((()=>{v({title:h("充值成功")})}),200),W())}catch(a){}},z=e=>{"recharge"==e?(V.value=!0,x.value=!1):"phone"==e&&(V.value=!1,x.value=!0)},A=()=>{w("update:show",!1)},J=()=>{};return(a,v)=>{const w=g,j=t(s("ti-input"),l),O=t(s("ti-button"),r),D=p,R=b,q=y,K=k,Q=C,S=t(s("ti-keyboard"),u),X=t(s("u-popup"),I);return c(),i(X,{ref_key:"dialogRef",ref:B,round:16,show:e.show,mode:"right",onOpen:J,onClose:A,closeOnClickOverlay:!1},{default:o((()=>[n(w,{class:"ti-recharge-container"},{default:o((()=>[n(w,{class:"ti-recharge-title"},{default:o((()=>[d(m(f(h)("会员充值")),1)])),_:1}),n(w,{class:"ti-recharge-content"},{default:o((()=>{var e;return[n(w,{class:"ti-recharge-item"},{default:o((()=>[n(j,{class:"ti-recharge-input",focus:x.value,modelValue:F.value,"onUpdate:modelValue":v[0]||(v[0]=e=>F.value=e),placeholder:f(h)("請輸入會員手機號/ID"),onClick:v[1]||(v[1]=e=>z("phone"))},null,8,["focus","modelValue","placeholder"]),n(O,{class:"ti-recharge-button",type:"primary",onClick:W},{default:o((()=>[d(m(f(h)("查找")),1)])),_:1})])),_:1}),(null==(e=G.value)?void 0:e.user_id)?(c(),i(w,{key:0,class:"ti-recharge-member"},{default:o((()=>[n(w,{class:"ti-recharge-member-item"},{default:o((()=>[n(w,{class:"ti-recharge-member-title"},{default:o((()=>[d(m(f(h)("暱稱")),1)])),_:1}),n(w,{class:"ti-recharge-member-content"},{default:o((()=>[d(m(G.value.nickName||"-"),1)])),_:1})])),_:1}),n(w,{class:"ti-recharge-member-item"},{default:o((()=>[n(w,{class:"ti-recharge-member-title"},{default:o((()=>[d(m(f(h)("會員卡/等級")),1)])),_:1}),n(w,{class:"ti-recharge-member-content"},{default:o((()=>{var e;return[d(m(null==(e=G.value.card)?void 0:e.card_name),1)]})),_:1})])),_:1}),n(w,{class:"ti-recharge-member-item"},{default:o((()=>[n(w,{class:"ti-recharge-member-title"},{default:o((()=>[d(m(f(h)("餘額")),1)])),_:1}),n(w,{class:"ti-recharge-member-content"},{default:o((()=>[d(m(G.value.balance),1)])),_:1})])),_:1}),n(w,{class:"ti-recharge-member-item"},{default:o((()=>[n(w,{class:"ti-recharge-member-title"},{default:o((()=>[d(m(f(h)("積分")),1)])),_:1}),n(w,{class:"ti-recharge-member-content"},{default:o((()=>[d(m(G.value.points),1)])),_:1})])),_:1})])),_:1})):_("",!0),n(w,{class:"ti-recharge-item margin"},{default:o((()=>[n(w,{class:"ti-recharge-subtitle"},{default:o((()=>[d(m(f(h)("充值类型")),1)])),_:1}),n(w,{class:"ti-recharge-item-buttons"},{default:o((()=>[n(O,{class:"ti-recharge-button",type:0==U.value?"primary":"default",onClick:v[2]||(v[2]=e=>U.value=0)},{default:o((()=>[d(m(f(h)("余额")),1)])),_:1},8,["type"]),n(O,{class:"ti-recharge-button",type:1==U.value?"primary":"default",onClick:v[3]||(v[3]=e=>U.value=1)},{default:o((()=>[d(m(f(h)("积分")),1)])),_:1},8,["type"])])),_:1})])),_:1}),n(w,{class:"ti-recharge-item margin"},{default:o((()=>[n(w,{class:"ti-recharge-subtitle"},{default:o((()=>[d(m(f(h)("充值类型")),1)])),_:1}),n(K,{class:"ti-type-radio",onChange:L},{default:o((()=>[n(q,null,{default:o((()=>[n(D,{value:"1",color:"#ffbe00",checked:"true"}),n(R,{class:"ti-radio-text"},{default:o((()=>[d(m(f(h)("增加")),1)])),_:1})])),_:1}),n(q,null,{default:o((()=>[n(D,{value:"2",color:"#ffbe00"}),n(R,{class:"ti-radio-text"},{default:o((()=>[d(m(f(h)("減少")),1)])),_:1})])),_:1}),n(q,null,{default:o((()=>[n(D,{value:"3",color:"#ffbe00"}),n(R,{class:"ti-radio-text"},{default:o((()=>[d(m(f(h)("最終結果")),1)])),_:1})])),_:1})])),_:1})])),_:1}),n(w,{class:"ti-recharge-item margin"},{default:o((()=>[n(w,{class:"ti-recharge-subtitle"},{default:o((()=>[d(m(f(h)("變更金額")),1)])),_:1}),n(j,{modelValue:H.value,"onUpdate:modelValue":v[4]||(v[4]=e=>H.value=e),class:"ti-recharge-input left",focus:V.value,placeholder:f(h)("請輸入變更金額"),onClick:v[5]||(v[5]=e=>z("recharge"))},null,8,["modelValue","focus","placeholder"])])),_:1})]})),_:1}),n(Q,{onClick:A,class:"ti-recharge-close",src:E,mode:"widthFix"})])),_:1}),n(w,{class:"ti-recharge-keyboard"},{default:o((()=>[n(S,{onInput:M,onClear:N,onExit:P,onConfirm:T,isCross:!0})])),_:1})])),_:1},8,["show"])}}},[["__scopeId","data-v-87e41eea"]]),B={__name:"index",setup(e){var t=a(!0);const l=()=>{t.value=!0};return w((()=>{x()})),(e,a)=>{const s=U,r=g,u=j("ti-layout");return c(),i(u,null,{default:o((()=>[n(r,null,{default:o((()=>[n(s,{onClick:l},{default:o((()=>[d("充值")])),_:1})])),_:1}),n(R,{show:f(t),"onUpdate:show":a[0]||(a[0]=e=>V(t)?t.value=e:t=e)},null,8,["show"])])),_:1})}}};export{B as default};
