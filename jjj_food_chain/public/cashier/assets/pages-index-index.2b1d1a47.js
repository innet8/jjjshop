var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,i=(e,t)=>{for(var l in t||(t={}))u.call(t,l)&&n(e,l,t[l]);if(a)for(var l of a(t))o.call(t,l)&&n(e,l,t[l]);return e},r=(e,a)=>t(e,l(a)),s=(e,t,l)=>new Promise(((a,u)=>{var o=e=>{try{i(l.next(e))}catch(t){u(t)}},n=e=>{try{i(l.throw(e))}catch(t){u(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,n);i((l=l.apply(e,t)).next())}));import{_ as c,n as d,q as p,r as v,K as _,b as f,L as m,M as y,o as h,d as b,w as g,e as w,f as k,t as j,g as I,$ as x,y as C,k as O,J as P,N as S,O as A,P as D,Q as U,R as $,S as V,T as L,U as z,V as F,W as B,X as T,Y as N,j as E,Z as M,a0 as K,a1 as R,a2 as W,c as Z,a3 as q,a4 as G,a5 as J,a6 as H,a as Q,a7 as X,a8 as Y,a9 as ee,aa as te,p as le,ab as ae,ac as ue,H as oe,ad as ne,m as ie,ae as re,h as se,af as ce,ag as de,ah as pe,ai as ve,aj as _e,s as fe,ak as me}from"./index-d8251714.js";import{f as ye,a as he,b as be,c as ge,g as we,d as ke,e as je,h as Ie,i as xe,j as Ce,k as Oe,l as Pe,m as Se,n as Ae,o as De,p as Ue,q as $e}from"./pureFunctionsAny.generated.0c856677.js";import{_ as Ve}from"./u-switch.cea44f76.js";const Le="object"==typeof global&&global&&global.Object===Object&&global;var ze="object"==typeof self&&self&&self.Object===Object&&self;const Fe=Le||ze||Function("return this")();const Be=Fe.Symbol;var Te=Object.prototype,Ne=Te.hasOwnProperty,Ee=Te.toString,Me=Be?Be.toStringTag:void 0;var Ke=Object.prototype.toString;var Re="[object Null]",We="[object Undefined]",Ze=Be?Be.toStringTag:void 0;function qe(e){return null==e?void 0===e?We:Re:Ze&&Ze in Object(e)?function(e){var t=Ne.call(e,Me),l=e[Me];try{e[Me]=void 0;var a=!0}catch(o){}var u=Ee.call(e);return a&&(t?e[Me]=l:delete e[Me]),u}(e):function(e){return Ke.call(e)}(e)}function Ge(e){return null!=e&&"object"==typeof e}const Je=Array.isArray;function He(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Qe="[object AsyncFunction]",Xe="[object Function]",Ye="[object GeneratorFunction]",et="[object Proxy]";function tt(e){if(!He(e))return!1;var t=qe(e);return t==Xe||t==Ye||t==Qe||t==et}const lt=Fe["__core-js_shared__"];var at,ut=(at=/[^.]+$/.exec(lt&&lt.keys&&lt.keys.IE_PROTO||""))?"Symbol(src)_1."+at:"";var ot=Function.prototype.toString;function nt(e){if(null!=e){try{return ot.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var it=/^\[object .+?Constructor\]$/,rt=Function.prototype,st=Object.prototype,ct=rt.toString,dt=st.hasOwnProperty,pt=RegExp("^"+ct.call(dt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vt(e){return!(!He(e)||(t=e,ut&&ut in t))&&(tt(e)?pt:it).test(nt(e));var t}function _t(e,t){var l=function(e,t){return null==e?void 0:e[t]}(e,t);return vt(l)?l:void 0}const ft=_t(Fe,"WeakMap");var mt=Object.create;const yt=function(){function e(){}return function(t){if(!He(t))return{};if(mt)return mt(t);e.prototype=t;var l=new e;return e.prototype=void 0,l}}();const ht=function(){try{var e=_t(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();var bt=9007199254740991,gt=/^(?:0|[1-9]\d*)$/;function wt(e,t){var l=typeof e;return!!(t=null==t?bt:t)&&("number"==l||"symbol"!=l&&gt.test(e))&&e>-1&&e%1==0&&e<t}function kt(e,t,l){"__proto__"==t&&ht?ht(e,t,{configurable:!0,enumerable:!0,value:l,writable:!0}):e[t]=l}function jt(e,t){return e===t||e!=e&&t!=t}var It=Object.prototype.hasOwnProperty;function xt(e,t,l){var a=e[t];It.call(e,t)&&jt(a,l)&&(void 0!==l||t in e)||kt(e,t,l)}function Ct(e,t,l,a){var u=!l;l||(l={});for(var o=-1,n=t.length;++o<n;){var i=t[o],r=a?a(l[i],e[i],i,l,e):void 0;void 0===r&&(r=e[i]),u?kt(l,i,r):xt(l,i,r)}return l}var Ot=9007199254740991;function Pt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ot}function St(e){return null!=e&&Pt(e.length)&&!tt(e)}var At=Object.prototype;function Dt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||At)}function Ut(e){return Ge(e)&&"[object Arguments]"==qe(e)}var $t=Object.prototype,Vt=$t.hasOwnProperty,Lt=$t.propertyIsEnumerable;const zt=Ut(function(){return arguments}())?Ut:function(e){return Ge(e)&&Vt.call(e,"callee")&&!Lt.call(e,"callee")};var Ft="object"==typeof exports&&exports&&!exports.nodeType&&exports,Bt=Ft&&"object"==typeof module&&module&&!module.nodeType&&module,Tt=Bt&&Bt.exports===Ft?Fe.Buffer:void 0;const Nt=(Tt?Tt.isBuffer:void 0)||function(){return!1};var Et={};function Mt(e){return function(t){return e(t)}}Et["[object Float32Array]"]=Et["[object Float64Array]"]=Et["[object Int8Array]"]=Et["[object Int16Array]"]=Et["[object Int32Array]"]=Et["[object Uint8Array]"]=Et["[object Uint8ClampedArray]"]=Et["[object Uint16Array]"]=Et["[object Uint32Array]"]=!0,Et["[object Arguments]"]=Et["[object Array]"]=Et["[object ArrayBuffer]"]=Et["[object Boolean]"]=Et["[object DataView]"]=Et["[object Date]"]=Et["[object Error]"]=Et["[object Function]"]=Et["[object Map]"]=Et["[object Number]"]=Et["[object Object]"]=Et["[object RegExp]"]=Et["[object Set]"]=Et["[object String]"]=Et["[object WeakMap]"]=!1;var Kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Rt=Kt&&"object"==typeof module&&module&&!module.nodeType&&module,Wt=Rt&&Rt.exports===Kt&&Le.process;const Zt=function(){try{var e=Rt&&Rt.require&&Rt.require("util").types;return e||Wt&&Wt.binding&&Wt.binding("util")}catch(t){}}();var qt=Zt&&Zt.isTypedArray;const Gt=qt?Mt(qt):function(e){return Ge(e)&&Pt(e.length)&&!!Et[qe(e)]};var Jt=Object.prototype.hasOwnProperty;function Ht(e,t){var l=Je(e),a=!l&&zt(e),u=!l&&!a&&Nt(e),o=!l&&!a&&!u&&Gt(e),n=l||a||u||o,i=n?function(e,t){for(var l=-1,a=Array(e);++l<e;)a[l]=t(l);return a}(e.length,String):[],r=i.length;for(var s in e)!t&&!Jt.call(e,s)||n&&("length"==s||u&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||wt(s,r))||i.push(s);return i}function Qt(e,t){return function(l){return e(t(l))}}const Xt=Qt(Object.keys,Object);var Yt=Object.prototype.hasOwnProperty;function el(e){return St(e)?Ht(e):function(e){if(!Dt(e))return Xt(e);var t=[];for(var l in Object(e))Yt.call(e,l)&&"constructor"!=l&&t.push(l);return t}(e)}var tl=Object.prototype.hasOwnProperty;function ll(e){if(!He(e))return function(e){var t=[];if(null!=e)for(var l in Object(e))t.push(l);return t}(e);var t=Dt(e),l=[];for(var a in e)("constructor"!=a||!t&&tl.call(e,a))&&l.push(a);return l}function al(e){return St(e)?Ht(e,!0):ll(e)}const ul=_t(Object,"create");var ol=Object.prototype.hasOwnProperty;var nl=Object.prototype.hasOwnProperty;function il(e){var t=-1,l=null==e?0:e.length;for(this.clear();++t<l;){var a=e[t];this.set(a[0],a[1])}}function rl(e,t){for(var l=e.length;l--;)if(jt(e[l][0],t))return l;return-1}il.prototype.clear=function(){this.__data__=ul?ul(null):{},this.size=0},il.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},il.prototype.get=function(e){var t=this.__data__;if(ul){var l=t[e];return"__lodash_hash_undefined__"===l?void 0:l}return ol.call(t,e)?t[e]:void 0},il.prototype.has=function(e){var t=this.__data__;return ul?void 0!==t[e]:nl.call(t,e)},il.prototype.set=function(e,t){var l=this.__data__;return this.size+=this.has(e)?0:1,l[e]=ul&&void 0===t?"__lodash_hash_undefined__":t,this};var sl=Array.prototype.splice;function cl(e){var t=-1,l=null==e?0:e.length;for(this.clear();++t<l;){var a=e[t];this.set(a[0],a[1])}}cl.prototype.clear=function(){this.__data__=[],this.size=0},cl.prototype.delete=function(e){var t=this.__data__,l=rl(t,e);return!(l<0)&&(l==t.length-1?t.pop():sl.call(t,l,1),--this.size,!0)},cl.prototype.get=function(e){var t=this.__data__,l=rl(t,e);return l<0?void 0:t[l][1]},cl.prototype.has=function(e){return rl(this.__data__,e)>-1},cl.prototype.set=function(e,t){var l=this.__data__,a=rl(l,e);return a<0?(++this.size,l.push([e,t])):l[a][1]=t,this};const dl=_t(Fe,"Map");function pl(e,t){var l,a,u=e.__data__;return("string"==(a=typeof(l=t))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==l:null===l)?u["string"==typeof t?"string":"hash"]:u.map}function vl(e){var t=-1,l=null==e?0:e.length;for(this.clear();++t<l;){var a=e[t];this.set(a[0],a[1])}}function _l(e,t){for(var l=-1,a=t.length,u=e.length;++l<a;)e[u+l]=t[l];return e}vl.prototype.clear=function(){this.size=0,this.__data__={hash:new il,map:new(dl||cl),string:new il}},vl.prototype.delete=function(e){var t=pl(this,e).delete(e);return this.size-=t?1:0,t},vl.prototype.get=function(e){return pl(this,e).get(e)},vl.prototype.has=function(e){return pl(this,e).has(e)},vl.prototype.set=function(e,t){var l=pl(this,e),a=l.size;return l.set(e,t),this.size+=l.size==a?0:1,this};const fl=Qt(Object.getPrototypeOf,Object);function ml(e){var t=this.__data__=new cl(e);this.size=t.size}ml.prototype.clear=function(){this.__data__=new cl,this.size=0},ml.prototype.delete=function(e){var t=this.__data__,l=t.delete(e);return this.size=t.size,l},ml.prototype.get=function(e){return this.__data__.get(e)},ml.prototype.has=function(e){return this.__data__.has(e)},ml.prototype.set=function(e,t){var l=this.__data__;if(l instanceof cl){var a=l.__data__;if(!dl||a.length<199)return a.push([e,t]),this.size=++l.size,this;l=this.__data__=new vl(a)}return l.set(e,t),this.size=l.size,this};var yl="object"==typeof exports&&exports&&!exports.nodeType&&exports,hl=yl&&"object"==typeof module&&module&&!module.nodeType&&module,bl=hl&&hl.exports===yl?Fe.Buffer:void 0,gl=bl?bl.allocUnsafe:void 0;function wl(){return[]}var kl=Object.prototype.propertyIsEnumerable,jl=Object.getOwnPropertySymbols;const Il=jl?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var l=-1,a=null==e?0:e.length,u=0,o=[];++l<a;){var n=e[l];t(n,l,e)&&(o[u++]=n)}return o}(jl(e),(function(t){return kl.call(e,t)})))}:wl;const xl=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)_l(t,Il(e)),e=fl(e);return t}:wl;function Cl(e,t,l){var a=t(e);return Je(e)?a:_l(a,l(e))}function Ol(e){return Cl(e,el,Il)}function Pl(e){return Cl(e,al,xl)}const Sl=_t(Fe,"DataView");const Al=_t(Fe,"Promise");const Dl=_t(Fe,"Set");var Ul="[object Map]",$l="[object Promise]",Vl="[object Set]",Ll="[object WeakMap]",zl="[object DataView]",Fl=nt(Sl),Bl=nt(dl),Tl=nt(Al),Nl=nt(Dl),El=nt(ft),Ml=qe;(Sl&&Ml(new Sl(new ArrayBuffer(1)))!=zl||dl&&Ml(new dl)!=Ul||Al&&Ml(Al.resolve())!=$l||Dl&&Ml(new Dl)!=Vl||ft&&Ml(new ft)!=Ll)&&(Ml=function(e){var t=qe(e),l="[object Object]"==t?e.constructor:void 0,a=l?nt(l):"";if(a)switch(a){case Fl:return zl;case Bl:return Ul;case Tl:return $l;case Nl:return Vl;case El:return Ll}return t});const Kl=Ml;var Rl=Object.prototype.hasOwnProperty;const Wl=Fe.Uint8Array;function Zl(e){var t=new e.constructor(e.byteLength);return new Wl(t).set(new Wl(e)),t}var ql=/\w*$/;var Gl=Be?Be.prototype:void 0,Jl=Gl?Gl.valueOf:void 0;var Hl="[object Boolean]",Ql="[object Date]",Xl="[object Map]",Yl="[object Number]",ea="[object RegExp]",ta="[object Set]",la="[object String]",aa="[object Symbol]",ua="[object ArrayBuffer]",oa="[object DataView]",na="[object Float32Array]",ia="[object Float64Array]",ra="[object Int8Array]",sa="[object Int16Array]",ca="[object Int32Array]",da="[object Uint8Array]",pa="[object Uint8ClampedArray]",va="[object Uint16Array]",_a="[object Uint32Array]";function fa(e,t,l){var a,u,o,n=e.constructor;switch(t){case ua:return Zl(e);case Hl:case Ql:return new n(+e);case oa:return function(e,t){var l=t?Zl(e.buffer):e.buffer;return new e.constructor(l,e.byteOffset,e.byteLength)}(e,l);case na:case ia:case ra:case sa:case ca:case da:case pa:case va:case _a:return function(e,t){var l=t?Zl(e.buffer):e.buffer;return new e.constructor(l,e.byteOffset,e.length)}(e,l);case Xl:return new n;case Yl:case la:return new n(e);case ea:return(o=new(u=e).constructor(u.source,ql.exec(u))).lastIndex=u.lastIndex,o;case ta:return new n;case aa:return a=e,Jl?Object(Jl.call(a)):{}}}var ma=Zt&&Zt.isMap;const ya=ma?Mt(ma):function(e){return Ge(e)&&"[object Map]"==Kl(e)};var ha=Zt&&Zt.isSet;const ba=ha?Mt(ha):function(e){return Ge(e)&&"[object Set]"==Kl(e)};var ga=1,wa=2,ka=4,ja="[object Arguments]",Ia="[object Function]",xa="[object GeneratorFunction]",Ca="[object Object]",Oa={};function Pa(e,t,l,a,u,o){var n,i=t&ga,r=t&wa,s=t&ka;if(l&&(n=u?l(e,a,u,o):l(e)),void 0!==n)return n;if(!He(e))return e;var c=Je(e);if(c){if(n=function(e){var t=e.length,l=new e.constructor(t);return t&&"string"==typeof e[0]&&Rl.call(e,"index")&&(l.index=e.index,l.input=e.input),l}(e),!i)return function(e,t){var l=-1,a=e.length;for(t||(t=Array(a));++l<a;)t[l]=e[l];return t}(e,n)}else{var d=Kl(e),p=d==Ia||d==xa;if(Nt(e))return function(e,t){if(t)return e.slice();var l=e.length,a=gl?gl(l):new e.constructor(l);return e.copy(a),a}(e,i);if(d==Ca||d==ja||p&&!u){if(n=r||p?{}:function(e){return"function"!=typeof e.constructor||Dt(e)?{}:yt(fl(e))}(e),!i)return r?function(e,t){return Ct(e,xl(e),t)}(e,function(e,t){return e&&Ct(t,al(t),e)}(n,e)):function(e,t){return Ct(e,Il(e),t)}(e,function(e,t){return e&&Ct(t,el(t),e)}(n,e))}else{if(!Oa[d])return u?e:{};n=fa(e,d,i)}}o||(o=new ml);var v=o.get(e);if(v)return v;o.set(e,n),ba(e)?e.forEach((function(a){n.add(Pa(a,t,l,a,e,o))})):ya(e)&&e.forEach((function(a,u){n.set(u,Pa(a,t,l,u,e,o))}));var _=c?void 0:(s?r?Pl:Ol:r?al:el)(e);return function(e,t){for(var l=-1,a=null==e?0:e.length;++l<a&&!1!==t(e[l],l,e););}(_||e,(function(a,u){_&&(a=e[u=a]),xt(n,u,Pa(a,t,l,u,e,o))})),n}Oa[ja]=Oa["[object Array]"]=Oa["[object ArrayBuffer]"]=Oa["[object DataView]"]=Oa["[object Boolean]"]=Oa["[object Date]"]=Oa["[object Float32Array]"]=Oa["[object Float64Array]"]=Oa["[object Int8Array]"]=Oa["[object Int16Array]"]=Oa["[object Int32Array]"]=Oa["[object Map]"]=Oa["[object Number]"]=Oa[Ca]=Oa["[object RegExp]"]=Oa["[object Set]"]=Oa["[object String]"]=Oa["[object Symbol]"]=Oa["[object Uint8Array]"]=Oa["[object Uint8ClampedArray]"]=Oa["[object Uint16Array]"]=Oa["[object Uint32Array]"]=!0,Oa["[object Error]"]=Oa[Ia]=Oa["[object WeakMap]"]=!1;function Sa(e){return Pa(e,5)}const Aa=c({__name:"modify-price",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d(!1),u=d("");p((()=>l.show),(()=>{l.show&&(u.value="")}));const o=e=>{e&&(u.value+=e)},n=()=>s(this,null,(function*(){var e,o;if(!u.value)return C({title:x("請輸入價格"),icon:"none"});if(!((o=u.value)>=0&&o<=1e6))return C({title:x("请输入0-1000000间的價格"),icon:"none"});try{a.value=!0;const o=yield ye({order_product_id:null==(e=l.productItem)?void 0:e.order_product_id,price:u.value});1==o.code&&(C({title:o.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(n){}finally{a.value=!1}}));return(i,r)=>{const s=O,c=v(f("ti-input"),_),d=v(f("ti-keyboard"),m),p=v(f("ti-modal"),y);return h(),b(p,{show:l.show,title:I(x)("價格")},{content:g((()=>[w(s,{class:"ti-dialog-content"},{default:g((()=>[w(s,{class:"ti-modify-title text-ellipsis"},{default:g((()=>{var t,l,a;return[k(j((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),w(s,{class:"ti-modify-input"},{default:g((()=>[w(c,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=e=>u.value=e),placeholder:I(x)("請輸入價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:g((()=>[w(s,{class:"ti-dialog-btn"},{default:g((()=>[w(d,{primaryLoading:a.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:r[1]||(r[1]=e=>t("update:show",!1)),onClear:r[2]||(r[2]=e=>u.value=""),onInput:o,onConfirm:n},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-d9d71982"]]),Da=c({__name:"remark",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d(!1),u=d("");p((()=>l.show),(()=>{var e;l.show&&(u.value=(null==(e=l.productItem)?void 0:e.remark)||"")}));const o=()=>s(this,null,(function*(){var e;try{a.value=!0;const o=yield he({order_product_id:null==(e=l.productItem)?void 0:e.order_product_id,remark:u.value.trim()});1==o.code&&(C({title:o.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(o){}finally{a.value=!1}}));return(n,i)=>{const r=O,s=S,c=v(f("ti-button"),P),d=v(f("ti-modal"),y);return h(),b(d,{show:l.show,title:I(x)("備註")},{content:g((()=>[w(r,{class:"ti-dialog-content"},{default:g((()=>[w(r,{class:"ti-remark-title text-ellipsis"},{default:g((()=>{var t,l,a;return[k(j((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),w(r,{class:"ti-remark-textarea"},{default:g((()=>[w(s,{modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=e=>u.value=e),maxlength:50,"placeholder-style":"color:rgba(16,10,5,.3)",placeholder:I(x)("请输入")},null,8,["modelValue","placeholder"])])),_:1}),w(r,{class:"ti-remark-num"},{default:g((()=>{var e;return[k(j((null==(e=u.value)?void 0:e.trim().length)||0)+"/50 ",1)]})),_:1})])),_:1})])),footer:g((()=>[w(r,{class:"ti-dialog-btn"},{default:g((()=>[w(c,{onClick:i[1]||(i[1]=e=>t("update:show",!1))},{default:g((()=>[k(j(I(x)("退出")),1)])),_:1}),w(c,{onClick:i[2]||(i[2]=e=>u.value="")},{default:g((()=>[k(j(I(x)("清空")),1)])),_:1}),w(c,{loading:a.value,type:"primary",onClick:o},{default:g((()=>[k(j(I(x)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-11362681"]]),Ua=c({__name:"withdrawal",props:{show:{type:Boolean,default:!1},productItem:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d(!1),u=d(""),o=d([x("等待時間長"),x("口味不好"),x("菜賣光了")]),n=d(0);p((()=>l.show),(()=>{var e;l.show&&(u.value=(null==(e=l.productItem)?void 0:e.total_num)||"")}));const i=e=>{e&&(u.value+=e)},r=()=>s(this,null,(function*(){var e,i;if(!u.value)return C({title:x("请输入退菜數量"),icon:"none"});try{a.value=!0;const r=yield be({order_id:null==(e=l.productItem)?void 0:e.order_id,order_product_id:null==(i=l.productItem)?void 0:i.order_product_id,num:u.value,return_reason:o.value[n.value]});1==r.code&&(C({title:r.msg,icon:"none"}),t("update:show",!1),t("success"))}catch(r){}finally{a.value=!1}}));return(s,c)=>{const d=O,p=v(f("ti-input"),_),C=v(f("ti-keyboard"),m),P=v(f("ti-modal"),y);return h(),b(P,{show:l.show,title:I(x)("退菜")},{content:g((()=>[w(d,{class:"ti-dialog-content"},{default:g((()=>[w(d,{class:"ti-withdrawal-title text-ellipsis"},{default:g((()=>{var t,l,a;return[k(j((null==(t=e.productItem)?void 0:t.product_name_text)||(null==(a=null==(l=e.productItem)?void 0:l.product)?void 0:a.product_name_text)),1)]})),_:1}),w(d,{class:"ti-withdrawal-list"},{default:g((()=>[(h(!0),A(D,null,U(o.value,((e,t)=>(h(),b(d,{key:t,class:$([{active:t==n.value},"ti-withdrawal-item"]),onClick:e=>(e=>{n.value=e})(t)},{default:g((()=>[k(j(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),w(d,{class:"ti-withdrawal-input"},{default:g((()=>[w(p,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=e=>u.value=e),placeholder:I(x)("请输入退菜數量"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})])),_:1})])),footer:g((()=>[w(d,{class:"ti-dialog-btn"},{default:g((()=>[w(C,{primaryLoading:a.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:c[1]||(c[1]=e=>t("update:show",!1)),onClear:c[2]||(c[2]=e=>u.value=""),onInput:i,onConfirm:r},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-098e8133"]]),$a=c({__name:"cancel-all",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d(!1),u=()=>s(this,null,(function*(){if(!a.value)try{a.value=!0;const e=yield ge({order_id:l.orderId});C({title:e.msg,icon:"none"}),t("update:show",!1),t("success")}catch(e){}finally{a.value=!1}}));return(o,n)=>{const i=O,r=V,s=v(f("ti-modal"),y);return h(),b(s,{class:"ti-action-tips",title:o.$t("溫馨提示"),show:l.show,confirmLoading:a.value,onCancel:n[0]||(n[0]=e=>t("update:show",!1)),onConfirm:u},{content:g((()=>[w(i,{class:"ti-dialog-content"},{default:g((()=>[l.sendKitchen&&e.sendKitchen.length>0?(h(),A(D,{key:0},[w(i,{class:"ti-cancel-title"},{default:g((()=>[k(j(o.$t("此單有商品已送廚，是否取消此筆交易？")),1)])),_:1}),w(i,{class:"ti-cancel-all"},{default:g((()=>[w(r,{"scroll-y":""},{default:g((()=>[w(i,{class:"ti-cancel-list"},{default:g((()=>[(h(!0),A(D,null,U(l.sendKitchen,((e,t)=>(h(),b(i,{key:t,class:"ti-cancel-item"},{default:g((()=>[k(j(null==e?void 0:e.product_name_text),1)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})],64)):(h(),A(D,{key:1},[k(j(o.$t("是否取消此筆交易？")),1)],64))])),_:1})])),_:1},8,["title","show","confirmLoading"])}}},[["__scopeId","data-v-9ce42bf3"]]),Va=c({__name:"order-pickup",props:{show:{type:Boolean,default:!1},sendKitchen:{type:Object,default:()=>[]}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d(),u=d(!1),o=d(!1),n=d(),i=d({page:1,list_rows:20}),r=d(!1),c=d([]),_=d(!1);p((()=>l.show),(()=>{l.show&&m()}));const m=()=>{i.value.page=1,S(!0)},y=()=>{_.value&&(i.value.page+=1,S())},S=e=>s(this,null,(function*(){var t,l,a,u,o;if(!r.value)try{e&&(r.value=!0);const n=yield we(i.value);1==i.value.page&&(c.value=[]),c.value=c.value.concat((null==(t=n.data)?void 0:t.productList)||[]),_.value=(null==(a=null==(l=n.data)?void 0:l.list)?void 0:a.last_page)>(null==(o=null==(u=n.data)?void 0:u.list)?void 0:o.current_page)}catch(n){}finally{e&&(r.value=!1)}})),$=e=>s(this,null,(function*(){if(!u.value){a.value=e;try{u.value=!0;const l=yield ke({order_id:e});C({title:l.msg,icon:"none"}),t("update:show",!1),N(e),setTimeout((()=>{t("success")}),100)}catch(l){}finally{u.value=!1}}}));return(i,s)=>{const d=v(f("ti-loading"),L),p=E,C=O,S=v(f("ti-button"),P),N=v(f("ti-empty-data"),z),M=V,K=v(f("ti-drawer"),F);return h(),b(C,null,{default:g((()=>[w(K,{show:l.show,isConfirmShow:!1,title:I(x)("取單"),onCancel:s[0]||(s[0]=e=>t("update:show",!1))},{content:g((()=>[w(C,{class:"ti-order-pickup"},{default:g((()=>[w(M,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:y},{default:g((()=>[r.value?(h(),b(d,{key:0})):c.value&&c.value.length>0?(h(),A(D,{key:1},[w(C,{class:"ti-pickup-list"},{default:g((()=>[(h(!0),A(D,null,U(c.value,((e,t)=>(h(),b(C,{key:t,class:"ti-pickup-item"},{default:g((()=>[w(C,{class:"ti-pickup-top"},{default:g((()=>[w(C,{class:"ti-pickup-left"},{default:g((()=>[w(C,{class:"ti-price-box"},{default:g((()=>[w(p,{class:"ti-price-text"},{default:g((()=>[k(j(I(x)("訂單總價：")),1)])),_:1}),w(p,{class:"ti-pickup-price"},{default:g((()=>[k(j(I(B)(null==e?void 0:e.total_price)),1)])),_:2},1024),w(p,{class:"ti-pickup-subPrice"},{default:g((()=>[k(j(I(T)(null==e?void 0:e.total_price)),1)])),_:2},1024)])),_:2},1024),w(C,{class:"ti-pickup-time"},{default:g((()=>[w(p,null,{default:g((()=>[k(j(I(x)("掛單時間：")),1)])),_:1}),w(p,null,{default:g((()=>[k(j(null==e?void 0:e.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),w(C,{class:"ti-pickup-action"},{default:g((()=>[w(C,{class:"ti-cancel-all"},{default:g((()=>[w(S,{type:"danger",onClick:t=>{return l=e.order_id,n.value=l,void(o.value=!0);var l}},{default:g((()=>[k(j(I(x)("整單取消")),1)])),_:2},1032,["onClick"])])),_:2},1024),w(C,null,{default:g((()=>[w(S,{type:"primary",loading:a.value==e.order_id&&u.value,onClick:t=>$(e.order_id)},{default:g((()=>[k(j(I(x)("取單")),1)])),_:2},1032,["loading","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024),w(C,{class:"ti-pickup-goods"},{default:g((()=>[w(C,{class:"ti-goods-head"},{default:g((()=>[w(C,null,{default:g((()=>[k(j(I(x)("商品名称")),1)])),_:1}),w(C,null,{default:g((()=>[k(j(I(x)("金額")),1)])),_:1}),w(C,null,{default:g((()=>[k(j(I(x)("數量")),1)])),_:1})])),_:1}),w(C,{class:"ti-goods-body"},{default:g((()=>[(h(!0),A(D,null,U((null==e?void 0:e.product)||[],((e,t)=>(h(),b(C,{key:t,class:"ti-goods-item"},{default:g((()=>[w(C,null,{default:g((()=>[k(j(null==e?void 0:e.product_name_text),1)])),_:2},1024),w(C,null,{default:g((()=>[w(p,{class:"ti-goods-price"},{default:g((()=>[k(j(I(B)(null==e?void 0:e.product_price)),1)])),_:2},1024),w(p,{class:"ti-goods-subPrice"},{default:g((()=>[k(j(I(T)(null==e?void 0:e.product_price)),1)])),_:2},1024)])),_:2},1024),w(C,null,{default:g((()=>[k(j(`x ${null==e?void 0:e.total_num}`),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),w(d,{status:_.value?"loading":"no-more"},null,8,["status"])],64)):(h(),b(N,{key:2}))])),_:1})])),_:1})])),_:1},8,["show","title"]),w($a,{show:o.value,"onUpdate:show":s[1]||(s[1]=e=>o.value=e),orderId:n.value,sendKitchen:e.sendKitchen,onSuccess:s[2]||(s[2]=e=>m())},null,8,["show","orderId","sendKitchen"])])),_:1})}}},[["__scopeId","data-v-fa021bbd"]]),La=c({__name:"preferential",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d({type:1,money:"",rate:"",discountType:1}),u=d(!1);p((()=>l.show),(()=>{var e,t;if(l.show){const u={type:1,money:"",rate:"",discountType:1};(null==(e=l.preferentialData)?void 0:e.discount_ratio)&&(u.type=2,u.rate=Math.max(null==(t=l.preferentialData)?void 0:t.discount_ratio,0)),a.value=u}})),p((()=>a.value.type),((e,t)=>{var u,o;1==t?a.value.money="":2==t?(null==(u=l.preferentialData)?void 0:u.discount_ratio)?a.value.rate=Math.max(null==(o=l.preferentialData)?void 0:o.discount_ratio,0):a.value.rate="":3==t&&(a.value.discountType=1)}));const o=e=>{a.value.discountType=e.detail.value},n=()=>{1==a.value.type?a.value.money="":2==a.value.type&&(a.value.rate="")},c=e=>{e&&(1==a.value.type?a.value.money+=e:2==a.value.type&&(a.value.rate+=e))},S=()=>s(this,null,(function*(){const e=r(i({},a.value),{order_id:l.orderId});if(!u.value){if(1==e.type){if(!e.money)return C({title:x("请输入實付價格"),icon:"none"});if(!((o=e.money)>=0&&o<=999999999))return C({title:x("请输入0-999999999间的價格"),icon:"none"})}else if(2==e.type){if(!e.rate)return C({title:x("请输入折扣"),icon:"none"});if(!/^(?:[1-9][0-9]?|100|0)$/.test(e.rate))return C({title:x("请输入0-100间的正整数"),icon:"none"})}var o;try{u.value=!0;const l=yield je(e);C({title:l.msg,icon:"none"}),t("update:show",!1),t("success")}catch(n){}finally{u.value=!1}}}));return(i,r)=>{const s=O,d=E,p=v(f("ti-input"),_),C=K,V=R,L=W,z=v(f("ti-button"),P),F=v(f("ti-keyboard"),m),N=v(f("ti-modal"),y);return h(),b(N,{show:l.show,title:I(x)("優惠折扣")},{content:g((()=>[w(s,{class:"ti-dialog-content"},{default:g((()=>[w(s,{class:"ti-preferential-box"},{default:g((()=>[w(s,{class:"ti-preferential-label"},{default:g((()=>[k(j(I(x)("當前價格")),1)])),_:1}),w(s,{class:"ti-preferential-input"},{default:g((()=>[w(d,{class:"ti-preferential-price"},{default:g((()=>[k(j(I(B)(e.totalPayPrice)),1)])),_:1}),w(d,{class:"ti-preferential-subPrice"},{default:g((()=>[k(j(I(T)(e.totalPayPrice)),1)])),_:1})])),_:1}),w(s,{class:"ti-preferential-label"},{default:g((()=>[k(j(I(x)("優惠方式")),1)])),_:1}),w(s,{class:"ti-preferential-input ti-preferential-type"},{default:g((()=>[(h(!0),A(D,null,U([I(x)("改價"),I(x)("折扣"),I(x)("抹零")],((e,t)=>(h(),b(s,{key:t,class:$([{active:a.value.type==t+1},"ti-preferential-type-item"]),onClick:e=>a.value.type=t+1},{default:g((()=>[k(j(e),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),1==a.value.type?(h(),A(D,{key:0},[w(s,{class:"ti-preferential-label"},{default:g((()=>[k(j(I(x)("實付價格")),1)])),_:1}),w(s,{class:"ti-preferential-input"},{default:g((()=>[w(p,{modelValue:a.value.money,"onUpdate:modelValue":r[0]||(r[0]=e=>a.value.money=e),placeholder:I(x)("请输入實付價格"),focus:!0},null,8,["modelValue","placeholder"])])),_:1})],64)):M("",!0),2==a.value.type?(h(),A(D,{key:1},[w(s,{class:"ti-preferential-label"},{default:g((()=>[k(j(I(x)("折扣")),1)])),_:1}),w(s,{class:"ti-preferential-input"},{default:g((()=>[w(p,{modelValue:a.value.rate,"onUpdate:modelValue":r[1]||(r[1]=e=>a.value.rate=e),placeholder:I(x)("请输入折扣"),focus:!0},{right:g((()=>[w(s,{class:"ti-preferential-percentage"},{default:g((()=>[k("%")])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})],64)):M("",!0),3==a.value.type?(h(),A(D,{key:2},[w(s,{class:"ti-preferential-label"},{default:g((()=>[k(j(I(x)("抹零方式")),1)])),_:1}),w(s,{class:"ti-preferential-input"},{default:g((()=>[w(L,{class:"ti-type-radio",onChange:o},{default:g((()=>[w(V,null,{default:g((()=>[w(C,{value:"1",color:"#ffbe00",checked:"true"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("抹分")),1)])),_:1})])),_:1}),w(V,null,{default:g((()=>[w(C,{value:"2",color:"#ffbe00"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("抹角")),1)])),_:1})])),_:1}),w(V,null,{default:g((()=>[w(C,{value:"3",color:"#ffbe00"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("四捨五入到角")),1)])),_:1})])),_:1}),w(V,null,{default:g((()=>[w(C,{value:"4",color:"#ffbe00"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("四捨五入到元")),1)])),_:1})])),_:1})])),_:1})])),_:1})],64)):M("",!0)])),_:1})])),_:1})])),footer:g((()=>[3==a.value.type?(h(),b(s,{key:0,class:"ti-dialog-btn"},{default:g((()=>[w(z,{onClick:r[2]||(r[2]=e=>t("update:show",!1))},{default:g((()=>[k(j(I(x)("退出")),1)])),_:1}),w(z,{loading:u.value,type:"primary",onClick:S},{default:g((()=>[k(j(I(x)("确定")),1)])),_:1},8,["loading"])])),_:1})):(h(),b(s,{key:1,class:"ti-dialog-btn ti-preferential-keyboard"},{default:g((()=>[w(F,{primaryLoading:u.value,isDoubleZero:!0,isCross:!1,isDrop:!0,onExit:r[3]||(r[3]=e=>t("update:show",!1)),onClear:n,onInput:c,onConfirm:S},null,8,["primaryLoading"])])),_:1}))])),_:1},8,["show","title"])}}},[["__scopeId","data-v-d7270166"]]),za=c({__name:"action-list",props:{productItem:{type:Object,default:()=>({})},orderId:{type:[Number,String],default:null},orderList:{type:Array,default:()=>[]},totalPayPrice:{type:[Number,String],default:0},preferentialData:{type:Object,default:()=>({})}},emits:["success"],setup(e,{emit:t}){const l=e,a=Z((()=>l.orderList&&l.orderList.length>0)),u=Z((()=>l.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)>0)))),o=Z((()=>l.orderList.filter((e=>(null==e?void 0:e.is_send_kitchen)<=0)))),n=d(q()),i=d(!1),r=d(!1),c=d(!1),p=d(!1),_=d(!1),m=d(!1),b=d(!1),P=d(!1),S=d(!1),U=d(!1),$=d(!1),V=d(!1),L=d(!1),z=()=>{l.orderList&&l.orderList.length>0?L.value=!0:V.value=!0},F=e=>{G(e)},B=()=>s(this,null,(function*(){var e;if(!p.value)try{p.value=!0;const a=yield Ie({order_product_id:null==(e=l.productItem)?void 0:e.order_product_id});1==a.code&&(C({title:a.msg,icon:"none"}),t("success"))}catch(a){}finally{c.value=!1,p.value=!1}})),T=()=>s(this,null,(function*(){b.value=!0})),N=()=>{J(),setTimeout((()=>{t("success")}),100)},M=()=>s(this,null,(function*(){if(!m.value)try{m.value=!0;const e=yield xe({delivery:n.value?30:40,order_id:l.orderId});C({title:e.msg,icon:"none"}),_.value=!1,t("success")}catch(e){}finally{m.value=!1}})),K=()=>s(this,null,(function*(){if(!r.value)try{r.value=!0;const e=yield Ce({order_id:l.orderId});1==e.code&&(C({title:e.msg,icon:"none"}),J(),setTimeout((()=>{t("success")}),100))}catch(e){}finally{i.value=!1,r.value=!1}}));return(r,s)=>{const d=E,p=v(f("u-switch"),Ve),m=O,C=H,R=v(f("ti-modal"),y);return h(),A(D,null,[w(m,{class:"ti-action-box"},{default:g((()=>[w(m,{class:"ti-action-btn"},{default:g((()=>[w(m,{class:"ti-action-pack"},{default:g((()=>[w(d,{class:"ti-pack-text"},{default:g((()=>[k(j(I(x)("打包")),1)])),_:1}),w(p,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=e=>n.value=e),activeColor:"#FFBE00",size:"20",onChange:F},null,8,["modelValue"])])),_:1}),w(m,{class:"ti-btn-box"},{default:g((()=>{var t,l,u;return[w(C,{class:"ti-btn-item",disabled:!(e.productItem&&0==(null==(t=e.productItem)?void 0:t.is_send_kitchen)),onClick:s[1]||(s[1]=e=>c.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("删除")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:0!=(null==(l=e.productItem)?void 0:l.is_send_kitchen),onClick:s[2]||(s[2]=e=>S.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("备注")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:!I(a),onClick:s[3]||(s[3]=e=>P.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("價格")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:!I(a),onClick:s[4]||(s[4]=e=>i.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("掛單")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:!1,onClick:z},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("取單")),1)])),_:1})])),_:1}),w(C,{class:"ti-btn-item danger",disabled:!I(a),onClick:s[5]||(s[5]=e=>T())},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("整單取消")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:0==I(o).length,onClick:s[6]||(s[6]=e=>_.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("送廚")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item danger",disabled:!(e.productItem&&1==(null==(u=e.productItem)?void 0:u.is_send_kitchen)),onClick:s[7]||(s[7]=e=>U.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("退菜")),1)])),_:1})])),_:1},8,["disabled"]),w(C,{class:"ti-btn-item",disabled:!I(a),onClick:s[8]||(s[8]=e=>$.value=!0)},{default:g((()=>[w(d,{class:"ti-btn-item-text"},{default:g((()=>[k(j(I(x)("優惠折扣")),1)])),_:1})])),_:1},8,["disabled"])]})),_:1})])),_:1})])),_:1}),w(R,{class:"ti-action-tips",show:c.value,"onUpdate:show":s[9]||(s[9]=e=>c.value=e),title:I(x)("溫馨提示"),content:I(x)("是否删除此商品？"),onConfirm:B},null,8,["show","title","content"]),w(R,{class:"ti-action-tips",show:_.value,"onUpdate:show":s[10]||(s[10]=e=>_.value=e),title:I(x)("溫馨提示"),content:I(x)("是否将商品送廚？"),onConfirm:M},null,8,["show","title","content"]),w(R,{class:"ti-action-tips",show:i.value,"onUpdate:show":s[11]||(s[11]=e=>i.value=e),title:I(x)("溫馨提示"),content:I(x)("是否将商品挂单？"),onConfirm:K},null,8,["show","title","content"]),w($a,{show:b.value,"onUpdate:show":s[12]||(s[12]=e=>b.value=e),sendKitchen:I(u),orderId:l.orderId,onSuccess:N},null,8,["show","sendKitchen","orderId"]),w(Aa,{show:P.value,"onUpdate:show":s[13]||(s[13]=e=>P.value=e),productItem:l.productItem,onSuccess:s[14]||(s[14]=e=>t("success"))},null,8,["show","productItem"]),w(Da,{show:S.value,"onUpdate:show":s[15]||(s[15]=e=>S.value=e),productItem:l.productItem,onSuccess:s[16]||(s[16]=e=>t("success"))},null,8,["show","productItem"]),w(Va,{show:V.value,"onUpdate:show":s[17]||(s[17]=e=>V.value=e),sendKitchen:I(u),onSuccess:s[18]||(s[18]=e=>t("success"))},null,8,["show","sendKitchen"]),w(R,{class:"ti-action-tips",show:L.value,"onUpdate:show":s[19]||(s[19]=e=>L.value=e),title:I(x)("溫馨提示"),content:I(x)("请先将购物车内的商品挂单或结账后再取单"),onConfirm:s[20]||(s[20]=e=>L.value=!1)},null,8,["show","title","content"]),w(Ua,{show:U.value,"onUpdate:show":s[21]||(s[21]=e=>U.value=e),productItem:l.productItem,onSuccess:s[22]||(s[22]=e=>t("success"))},null,8,["show","productItem"]),w(La,{show:$.value,"onUpdate:show":s[23]||(s[23]=e=>$.value=e),preferentialData:l.preferentialData,orderId:l.orderId,totalPayPrice:e.totalPayPrice,onSuccess:s[24]||(s[24]=e=>t("success"))},null,8,["show","preferentialData","orderId","totalPayPrice"])],64)}}},[["__scopeId","data-v-fd7e9961"]]),Fa=c({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const l=e,a=d(!1),u=e=>s(this,null,(function*(){var u,o;const n={order_product_id:null==(u=l.productItem)?void 0:u.order_product_id,product_num:null==(o=l.productItem)?void 0:o.total_num,type:e};"up"==e?n.product_num+=1:n.product_num-=1;try{a.value=!0;1==(yield Oe(n)).code&&t("change")}catch(i){}finally{a.value=!1}}));return(e,t)=>{const o=v(f("uni-icons"),Q),n=H,i=O;return h(),b(i,{class:"ti-number-box",onClick:t[2]||(t[2]=X((()=>{}),["stop"]))},{default:g((()=>{var e,r,s,c,d,p;return[w(n,{class:"ti-number-btn ti-number-minus",disabled:(null==(e=l.productItem)?void 0:e.total_num)<=1||a.value||(null==(r=l.productItem)?void 0:r.is_send_kitchen)>0,onClick:t[0]||(t[0]=e=>u("down"))},{default:g((()=>[w(o,{"custom-prefix":"iconfont",type:"icon-minus",size:"16"})])),_:1},8,["disabled"]),w(i,{class:"ti-number-input"},{default:g((()=>{var e;return[k(j((null==(e=l.productItem)?void 0:e.total_num)||1),1)]})),_:1}),w(n,{class:"ti-number-btn ti-number-plus",disabled:(null==(s=l.productItem)?void 0:s.total_num)>=(null==(d=null==(c=l.productItem)?void 0:c.product)?void 0:d.product_stock)||a.value||(null==(p=l.productItem)?void 0:p.is_send_kitchen)>0,onClick:t[1]||(t[1]=e=>u("up"))},{default:g((()=>[w(o,{type:"plusempty",size:"16"})])),_:1},8,["disabled"])]})),_:1})}}},[["__scopeId","data-v-1f4f3df5"]]),Ba=c({__name:"member",props:{show:{type:Boolean,default:!1},orderId:{type:[Number,String],default:null}},emits:["update:show","change"],setup(e,{emit:t}){const l=e,a=d(!1),u=d(""),o=d({}),n=d(!1);p((()=>l.show),(()=>{l.show&&(u.value="",o.value={})}));const c=()=>{t("update:show",!1),t("change",null)},S=e=>{e&&(u.value+=e)},A=()=>s(this,null,(function*(){if(!u.value)return C({title:x("请输入会员手机号/ID"),icon:"none"});try{a.value=!0;const e=yield Y({mobile:u.value,order_id:l.orderId});o.value=r(i({},e.data.user),{total_pay_price:e.data.total_pay_price})}catch(e){}finally{a.value=!1}})),D=()=>s(this,null,(function*(){var e;try{n.value=!0;yield ee({order_id:l.orderId,user_id:(null==(e=o.value)?void 0:e.user_id)||0});t("update:show",!1),t("change",o.value)}catch(a){}finally{n.value=!1}}));return(e,t)=>{const i=v(f("ti-input"),_),r=v(f("ti-button"),P),s=O,d=E,p=v(f("ti-keyboard"),m),C=v(f("ti-modal"),y);return h(),b(C,{show:l.show,title:I(x)("会员")},{content:g((()=>[w(s,{class:"ti-dialog-content"},{default:g((()=>{var e;return[w(s,{class:"ti-payment-input"},{default:g((()=>[w(i,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),placeholder:I(x)("請輸入會員手機號/ID"),focus:!0},null,8,["modelValue","placeholder"]),w(r,{loading:a.value,type:"primary",onClick:A},{default:g((()=>[k(j(I(x)("查找")),1)])),_:1},8,["loading"])])),_:1}),(null==(e=o.value)?void 0:e.user_id)?(h(),b(s,{key:0,class:"ti-payment-member"},{default:g((()=>[w(s,{class:"ti-member-list"},{default:g((()=>[w(s,{class:"ti-member-item"},{default:g((()=>[w(s,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("暱稱")),1)])),_:1}),w(s,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=o.value)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),w(s,{class:"ti-member-item"},{default:g((()=>[w(s,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("會員卡/等級")),1)])),_:1}),w(s,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e,t,l,a,u,n,i,r,s;return[k(j(`${1!=(null==(l=null==(t=null==(e=o.value)?void 0:e.card)?void 0:t.cardRecord)?void 0:l.disabled)&&(null==(u=null==(a=o.value)?void 0:a.card)?void 0:u.card_name)?null==(i=null==(n=o.value)?void 0:n.card)?void 0:i.card_name:"-"}/${(null==(s=null==(r=o.value)?void 0:r.grade)?void 0:s.name)||"-"}`),1)]})),_:1})])),_:1}),w(s,{class:"ti-member-item"},{default:g((()=>[w(s,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("餘額")),1)])),_:1}),w(s,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=o.value)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),w(s,{class:"ti-member-item"},{default:g((()=>[w(s,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("積分")),1)])),_:1}),w(s,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=o.value)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1}),w(s,{class:"ti-member-discount"},{default:g((()=>[w(d,{class:"ti-discount-title"},{default:g((()=>[k(j(I(x)("會員折扣應收金額")),1)])),_:1}),w(d,{class:"ti-discount-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=o.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),w(d,{class:"ti-discount-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=o.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1})])),_:1})):M("",!0)]})),_:1})])),footer:g((()=>[w(s,{class:"ti-dialog-btn"},{default:g((()=>[w(p,{primaryLoading:n.value,isDoubleZero:!1,isCross:!0,isDrop:!0,onExit:c,onClear:t[1]||(t[1]=e=>u.value=""),onInput:S,onConfirm:D},null,8,["primaryLoading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-ca913bab"]]),Ta=c({__name:"payment-type",props:{show:{type:Boolean,default:!1},totalPayPrice:{type:[Number,String],default:0},orderId:{type:[Number,String],default:null},memberDetail:{type:Object,default:()=>({})}},emits:["update:show"],setup(e,{emit:t}){const l=e,a=d(!1),u=d([]),o=d({delivery:null,pay_type:"40",user_id:null,order_id:null}),n=d(!1),r=d(!1);p((()=>l.show),(()=>{l.show&&(u.value=[],o.value.pay_type="40")})),p((()=>o.value.pay_type),(()=>{l.show&&(o.value.pay_type>0||(u.value&&u.value.length>0?o.value.pay_type=u.value[0].value:te().then((e=>{u.value=e.data||[],o.value.pay_type=u.value[0].value}))))}));const c=e=>{var a;(null==e?void 0:e.user_id)!=(null==(a=l.memberDetail)?void 0:a.user_id)&&t("success")},_=()=>s(this,null,(function*(){try{yield ee({order_id:l.orderId,user_id:0});t("success")}catch(e){}})),m=e=>{o.value.pay_type=e.detail.value},S=()=>s(this,null,(function*(){if(!r.value)try{r.value=!0;const e=yield ae({order_id:l.orderId});C({title:e.msg,icon:"none"})}catch(e){}finally{r.value=!1}})),V=()=>s(this,null,(function*(){var e;if(n.value)return;const a=i({},o.value);if(a.delivery=q()?30:40,a.order_id=l.orderId,a.user_id=null==(e=l.memberDetail)?void 0:e.user_id,"10"==a.pay_type&&!a.user_id)return C({title:x("请选择会员身份以享受更多优惠，再进行余额支付"),icon:"none"});try{n.value=!0;const e=yield ue(a);C({title:e.msg,icon:"none"}),t("update:show",!1),J(),setTimeout((()=>{t("success")}),100)}catch(u){}finally{n.value=!1}}));return(i,s)=>{const d=E,p=O,C=K,L=R,F=W,N=oe,Z=v(f("ti-empty-data"),z),q=v(f("ti-button"),P),G=v(f("ti-modal"),y);return h(),b(G,{show:l.show,title:I(x)("結賬")},{content:g((()=>[w(p,{class:"ti-dialog-content"},{default:g((()=>{var t;return[w(p,{class:"ti-payment-money"},{default:g((()=>[w(d,{class:"ti-payment-label"},{default:g((()=>[k(j(I(x)("應收金額")),1)])),_:1}),w(d,{class:"ti-payment-price"},{default:g((()=>[k(j(I(B)(e.totalPayPrice)),1)])),_:1}),w(d,{class:"ti-payment-subPrice"},{default:g((()=>[k(j(I(T)(e.totalPayPrice)),1)])),_:1})])),_:1}),w(p,{class:"ti-payment-type"},{default:g((()=>[w(p,{class:"ti-type-label"},{default:g((()=>[k(j(I(x)("收款方式")),1)])),_:1}),w(F,{class:"ti-type-radio",onChange:m},{default:g((()=>[w(L,null,{default:g((()=>[w(C,{value:"40",color:"#ffbe00",checked:"true"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("現金")),1)])),_:1})])),_:1}),w(L,null,{default:g((()=>[w(C,{value:"10",color:"#ffbe00"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("餘額")),1)])),_:1})])),_:1}),w(L,null,{default:g((()=>[w(C,{value:"",color:"#ffbe00"}),w(d,{class:"ti-radio-text"},{default:g((()=>[k(j(I(x)("其他方式")),1)])),_:1})])),_:1})])),_:1})])),_:1}),"40"!=o.value.pay_type&&"10"!=o.value.pay_type?(h(),b(p,{key:0,class:"ti-payment-other"},{default:g((()=>[w(p,{class:"ti-other-title"},{default:g((()=>[k(j(I(x)("用戶通過店內掃碼等方式進行支付，確認用戶支付完成後，點擊確認即可完成付款操作。")),1)])),_:1}),u.value&&u.value.length>0?(h(),b(p,{key:0,class:"ti-other-list"},{default:g((()=>[(h(!0),A(D,null,U(u.value,(e=>(h(),b(p,{key:e.value,class:$([{active:e.value==o.value.pay_type},"ti-other-item"]),onClick:t=>o.value.pay_type=e.value},{default:g((()=>[w(p,{class:"ti-other-image"},{default:g((()=>{var t;return[w(N,{src:`${(null==(t=I(le)())?void 0:t.api_url)||""}/${e.img}`,mode:"widthFix"},null,8,["src"])]})),_:2},1024),w(p,{class:"ti-other-text"},{default:g((()=>[k(j(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})):(h(),b(Z,{key:1}))])),_:1})):M("",!0),(null==(t=l.memberDetail)?void 0:t.user_id)?(h(),b(p,{key:1,class:"ti-payment-member"},{default:g((()=>[w(p,{class:"ti-payment-top"},{default:g((()=>[w(p,{class:"ti-payment-top-name"},{default:g((()=>[k(j(I(x)("會員")),1)])),_:1}),w(p,{class:"ti-payment-top-discomfort",onClick:_},{default:g((()=>[k(j(I(x)("不使用此會員")),1)])),_:1})])),_:1}),w(p,{class:"ti-member-list"},{default:g((()=>[w(p,{class:"ti-member-item"},{default:g((()=>[w(p,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("暱稱")),1)])),_:1}),w(p,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=l.memberDetail)?void 0:e.nickName)||"-"),1)]})),_:1})])),_:1}),w(p,{class:"ti-member-item"},{default:g((()=>[w(p,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("會員卡/等級")),1)])),_:1}),w(p,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e,t,a,u,o,n,i,r,s;return[k(j(`${1!=(null==(a=null==(t=null==(e=l.memberDetail)?void 0:e.card)?void 0:t.cardRecord)?void 0:a.disabled)&&(null==(o=null==(u=l.memberDetail)?void 0:u.card)?void 0:o.card_name)?null==(i=null==(n=l.memberDetail)?void 0:n.card)?void 0:i.card_name:"-"}/${(null==(s=null==(r=l.memberDetail)?void 0:r.grade)?void 0:s.name)||"-"}`),1)]})),_:1})])),_:1}),w(p,{class:"ti-member-item"},{default:g((()=>[w(p,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("餘額")),1)])),_:1}),w(p,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=l.memberDetail)?void 0:e.balance)||0),1)]})),_:1})])),_:1}),w(p,{class:"ti-member-item"},{default:g((()=>[w(p,{class:"ti-member-head"},{default:g((()=>[k(j(I(x)("積分")),1)])),_:1}),w(p,{class:"ti-member-name text-ellipsis"},{default:g((()=>{var e;return[k(j((null==(e=l.memberDetail)?void 0:e.points)||0),1)]})),_:1})])),_:1})])),_:1})])),_:1})):M("",!0),w(Ba,{show:a.value,"onUpdate:show":s[0]||(s[0]=e=>a.value=e),orderId:l.orderId,onChange:c},null,8,["show","orderId"])]})),_:1})])),footer:g((()=>[w(p,{class:"ti-dialog-btn"},{default:g((()=>[w(q,{onClick:s[1]||(s[1]=e=>t("update:show",!1))},{default:g((()=>[k(j(I(x)("退出")),1)])),_:1}),w(q,{loading:r.value,onClick:S},{default:g((()=>[k(j(I(x)("打印")),1)])),_:1},8,["loading"]),w(q,{onClick:s[2]||(s[2]=e=>a.value=!0)},{default:g((()=>[k(j(I(x)("会员")),1)])),_:1}),w(q,{loading:n.value,type:"primary",onClick:V},{default:g((()=>[k(j(I(x)("确定")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["show","title"])}}},[["__scopeId","data-v-f380a73c"]]),Na=c({__name:"cart-list",setup(e,{expose:t}){const{userInfo:l}=ne(ie()),a=d(),u=d(!1),o=d(!1),n=d({}),r=d({}),c=d({}),p=d([]),_=d(),m=d({}),y=()=>{u.value=!0},x=e=>s(this,null,(function*(){var t,l,u,s,d,v,f,y,h,b,g;const w=i({},c.value);w.order_id=re();try{e&&(o.value=!0);const i=yield Pe(w);if(m.value={discount_ratio:null==(u=null==(l=null==(t=i.data)?void 0:t.allProductInfo)?void 0:l.orderInfo)?void 0:u.discount_ratio},r.value=null==(d=null==(s=i.data)?void 0:s.allProductInfo)?void 0:d.sumInfo,p.value=(null==(y=null==(f=null==(v=i.data)?void 0:v.allProductInfo)?void 0:f.orderInfo)?void 0:y.product)||[],p.value&&p.value.length>0){let e=0;(null==(h=n.value)?void 0:h.order_product_id)&&(e=p.value.findIndex((e=>{var t;return e.order_product_id==(null==(t=n.value)?void 0:t.order_product_id)}))),n.value=p.value[Math.max(e,0)],a.value=null==(g=null==(b=i.data)?void 0:b.allProductInfo)?void 0:g.userInfo,_.value=re()}else n.value=null,a.value=null,_.value=null,J();C(Sa(p.value),Sa(r.value))}catch(k){}finally{e&&(o.value=!1)}})),C=(e,t)=>{var a;const u={subtotal:B((null==t?void 0:t.subtotal)||0),subtotal_sub:T((null==t?void 0:t.subtotal)||0),service_money:B((null==t?void 0:t.service_money)||0),service_money_sub:T((null==t?void 0:t.service_money)||0),special_discount:B((null==t?void 0:t.special_discount)||0),special_discount_sub:T((null==t?void 0:t.special_discount)||0),total_consumption_tax_money:B((null==t?void 0:t.total_consumption_tax_money)||0),total_consumption_tax_money_sub:T((null==t?void 0:t.total_consumption_tax_money)||0),total_user_discount_money:B((null==t?void 0:t.total_user_discount_money)||0),total_user_discount_money_sub:T((null==t?void 0:t.total_user_discount_money)||0),total_pay_price:B((null==t?void 0:t.total_pay_price)||0),total_pay_price_sub:T((null==t?void 0:t.total_pay_price)||0)},o=null==e?void 0:e.map((e=>{const t=null==e?void 0:e.product_price;return e.product_price=B(t||0),e.product_price_sub=T(t||0),e})),n={language:se(),system_name:null==(a=l.value)?void 0:a.name,order_list:o,statistics:u};JSON.stringify(n)};return x(!0),t({getCartData:x}),(e,t)=>{var l,i;const s=O,c=v(f("ti-loading"),L),d=E,C=v(f("ti-empty-data"),z),P=V,S=H;return h(),A(D,null,[w(s,{class:"ti-cart-box"},{default:g((()=>[w(s,{class:"ti-cart-list"},{default:g((()=>[w(s,{class:"ti-cart-head"},{default:g((()=>[w(s,{class:"ti-cart-shop-head"},{default:g((()=>[w(s,{class:"ti-shop-head-title"},{default:g((()=>[k(j(e.$t("商品名稱")),1)])),_:1}),w(s,{class:"ti-shop-head-money"},{default:g((()=>[k(j(e.$t("金額")),1)])),_:1}),w(s,{class:"ti-shop-head-num"},{default:g((()=>[k(j(e.$t("數量")),1)])),_:1})])),_:1})])),_:1}),w(s,{class:"ti-shop-list"},{default:g((()=>[w(P,{"scroll-y":""},{default:g((()=>[o.value?(h(),b(c,{key:0})):p.value&&p.value.length>0?(h(),b(s,{key:1,class:"ti-shop-box"},{default:g((()=>[(h(!0),A(D,null,U(p.value,(e=>{var l;return h(),b(s,{key:e,class:$([{active:(null==(l=n.value)?void 0:l.order_product_id)==(null==e?void 0:e.order_product_id)},"ti-shop-item"]),onClick:t=>(e=>{var t;(null==(t=n.value)?void 0:t.order_product_id)!=(null==e?void 0:e.order_product_id)&&(n.value=e)})(e)},{default:g((()=>[w(s,{class:"ti-shop-item-box"},{default:g((()=>[w(s,{class:"ti-shop-body"},{default:g((()=>[w(s,{class:"ti-shop-body-top"},{default:g((()=>[w(s,{class:"ti-shop-title text-ellipsis"},{default:g((()=>[k(j(e.product_name_text),1)])),_:2},1024),e.product_attr?(h(),b(s,{key:0,class:"ti-shop-spec"},{default:g((()=>[k("( "+j(e.product_attr)+" )",1)])),_:2},1024)):M("",!0)])),_:2},1024),w(s,{class:"ti-shop-body-money"},{default:g((()=>[w(d,{class:"ti-shop-price"},{default:g((()=>[k(j(I(B)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),w(d,{class:"ti-shop-subPrice"},{default:g((()=>[k(j(I(T)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),w(Fa,{productItem:e,onChange:t[0]||(t[0]=e=>x())},null,8,["productItem"])])),_:2},1024),e.remark?(h(),b(s,{key:0,class:"ti-shop-remark"},{default:g((()=>[k(j(e.remark),1)])),_:2},1024)):M("",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])})),128))])),_:1})):(h(),b(C,{key:2}))])),_:1})])),_:1})])),_:1}),w(s,{class:"ti-cart-statistics"},{default:g((()=>[w(s,{class:"ti-cart-total"},{default:g((()=>[w(d,{class:"ti-total-text"},{default:g((()=>[k(j(e.$t("小計:")),1)])),_:1}),w(d,{class:"ti-total-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=r.value)?void 0:e.subtotal)||0)),1)]})),_:1}),w(d,{class:"ti-total-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=r.value)?void 0:e.subtotal)||0)),1)]})),_:1})])),_:1}),w(s,{class:"ti-cart-discount"},{default:g((()=>[w(s,{class:"ti-discount-item"},{default:g((()=>[w(s,null,{default:g((()=>[w(d,{class:"ti-discount-text"},{default:g((()=>[k(j(e.$t("服務費:")),1)])),_:1}),w(d,{class:"ti-discount-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=r.value)?void 0:e.service_money)||0)),1)]})),_:1}),w(d,{class:"ti-discount-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=r.value)?void 0:e.service_money)||0)),1)]})),_:1})])),_:1}),w(s,null,{default:g((()=>{var t;return[w(d,{class:"ti-discount-text"},{default:g((()=>[k(j(e.$t("優惠折扣:")),1)])),_:1}),w(d,{class:"ti-discount-price"},{default:g((()=>{var e;return[k(j(`-${I(B)((null==(e=r.value)?void 0:e.special_discount)||0)}`),1)]})),_:1}),I(T)((null==(t=r.value)?void 0:t.special_discount)||0)?(h(),b(d,{key:0,class:"ti-discount-subPrice"},{default:g((()=>{var e;return[k(j(`-${I(T)((null==(e=r.value)?void 0:e.special_discount)||0)}`),1)]})),_:1})):M("",!0)]})),_:1})])),_:1}),w(s,{class:"ti-discount-item"},{default:g((()=>[w(s,null,{default:g((()=>[w(d,{class:"ti-discount-text"},{default:g((()=>[k(j(e.$t("消費稅:")),1)])),_:1}),w(d,{class:"ti-discount-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=r.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1}),w(d,{class:"ti-discount-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=r.value)?void 0:e.total_consumption_tax_money)||0)),1)]})),_:1})])),_:1}),w(s,null,{default:g((()=>{var t;return[w(d,{class:"ti-discount-text"},{default:g((()=>[k(j(e.$t("會員折扣:")),1)])),_:1}),w(d,{class:"ti-discount-price"},{default:g((()=>{var e;return[k(j(`-${I(B)((null==(e=r.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1}),I(T)((null==(t=r.value)?void 0:t.total_user_discount_money)||0)?(h(),b(d,{key:0,class:"ti-discount-subPrice"},{default:g((()=>{var e;return[k(j(`-${I(T)((null==(e=r.value)?void 0:e.total_user_discount_money)||0)}`),1)]})),_:1})):M("",!0)]})),_:1})])),_:1})])),_:1}),w(s,{class:"ti-cart-settlement"},{default:g((()=>[w(s,{class:"ti-settlement-total"},{default:g((()=>[w(d,{class:"ti-settlement-text"},{default:g((()=>[k(j(e.$t("應收：")),1)])),_:1}),w(d,{class:"ti-settlement-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=r.value)?void 0:e.total_pay_price)||0)),1)]})),_:1}),w(d,{class:"ti-settlement-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=r.value)?void 0:e.total_pay_price)||0)),1)]})),_:1})])),_:1}),w(S,{class:"ti-settlement-btn",disabled:p.value.length<=0,onClick:y},{default:g((()=>[w(d,null,{default:g((()=>[k(j(e.$t("結賬")),1)])),_:1}),p.value.length>0?(h(),b(d,{key:0,class:"ti-settlement-badge"},{default:g((()=>[k(j(p.value.length),1)])),_:1})):M("",!0)])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),w(za,{productItem:n.value,orderId:_.value,preferentialData:m.value,totalPayPrice:null==(l=r.value)?void 0:l.total_pay_price,orderList:p.value,onSuccess:t[1]||(t[1]=e=>x())},null,8,["productItem","orderId","preferentialData","totalPayPrice","orderList"]),w(Ta,{show:u.value,"onUpdate:show":t[2]||(t[2]=e=>u.value=e),orderId:_.value,totalPayPrice:null==(i=r.value)?void 0:i.total_pay_price,memberDetail:a.value,onSuccess:t[3]||(t[3]=e=>x())},null,8,["show","orderId","totalPayPrice","memberDetail"])],64)}}},[["__scopeId","data-v-6c96ad3c"]]),Ea=c({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(e,{emit:t}){const l=e,a=d(0),u=d(0),o=d([]);p((()=>l.list),(e=>s(this,null,(function*(){if(yield ce(),!e||0==e.length)return;const t=de().in(this);if(e.map(((e,l)=>{t.select(`#scroll-item-${l}`).boundingClientRect((e=>{if(!e)return;const t=o.value;t[l]=e.width+10,o.value=t})).exec()})),l.menuId>0){const e=l.list.findIndex((e=>e.category_id==l.menuId));e>-1&&n(e)}}))),{deep:!0,immediate:!0});const n=e=>{u.value=e,a.value=o.value.slice(0,e+1).reduce(((e,t)=>e+t),0)-(o.value[e]+100),t("update:menuId",l.list[e].category_id)};return(e,t)=>{const o=E,i=O,r=V;return h(),b(r,{class:"ti-dish-menu","scroll-left":a.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:g((()=>[w(i,{class:"ti-menu-content"},{default:g((()=>[(h(!0),A(D,null,U(l.list,((e,t)=>(h(),b(i,{key:t,class:$(["ti-menu-item",{active:t==u.value}]),id:`scroll-item-${t}`,onClick:e=>n(t)},{default:g((()=>[w(o,{class:"ti-menu-title"},{default:g((()=>[k(j(e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-4f990a9b"]]),Ma=c({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId","update:isSpecial"],setup(e,{emit:t}){const l=d([]),a=d(0),u=d(0),o=Z((()=>{let e=(l.value.find((e=>e.category_id==a.value))||{}).child||[];return e&&e.length>0&&(e=[{name_text:x("全部"),category_id:0}].concat(e)),e})),n=Z((()=>l.value.find((e=>e.category_id==a.value)))),i=Z((()=>o.value.find((e=>e.category_id==u.value))));p((()=>a.value),(()=>{var e;o&&o.length>0&&(u.value=o.value[0].category_id),t("update:isSpecial",null==(e=n.value)?void 0:e.is_special),t("update:categoryId",a.value)}));return(()=>{s(this,null,(function*(){try{const e=yield Se();e.data.list&&(l.value=[{name_text:x("全部"),category_id:0}].concat(e.data.list),a.value=l.value[0].category_id)}catch(e){}}))})(),(e,n)=>{const r=O;return h(),b(r,{class:"ti-category-box"},{default:g((()=>[w(Ea,{list:l.value,menuId:a.value,"onUpdate:menuId":n[0]||(n[0]=e=>a.value=e)},null,8,["list","menuId"]),w(r,{class:"ti-dish-secondary"},{default:g((()=>[(h(!0),A(D,null,U(I(o),((e,l)=>(h(),b(r,{key:l,class:$([{active:e.category_id==u.value},"ti-secondary-item"]),onClick:l=>{return o=e.category_id,u.value=o,t("update:isSpecial",null==(n=i.value)?void 0:n.is_special),void t("update:categoryId",u.value>0?u.value:a.value);var o,n}},{default:g((()=>[k(j(e.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-d51921f8"]]),Ka=c({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(e,{emit:t}){const l=e,a=d({}),u=d(!1),o=d(!1),n=d({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:q()?30:40,describe:null});p((()=>l.show),(()=>{l.show&&r()}));const r=()=>s(this,null,(function*(){var e,t,o,i,r,s,c,d,p;if(!u.value||l.productId)try{u.value=!0;const v=yield Ae(l.productId);a.value=v.data,n.value.product_id=null==(e=a.value)?void 0:e.product_id,n.value.price=null==(t=a.value)?void 0:t.product_price,n.value.product_price=null==(o=a.value)?void 0:o.product_price,(null==(i=a.value)?void 0:i.sku)&&(null==(r=a.value)?void 0:r.sku.length)>0&&(n.value.product_sku_id=null==(s=a.value)?void 0:s.sku[0].product_sku_id),(null==(c=a.value)?void 0:c.product_attr)&&(null==(d=a.value)?void 0:d.product_attr.length)>0&&(null==(p=a.value)||p.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value_text)&&(null==e?void 0:e.attribute_value_text.length)>0?n.value.attr[t]=0:n.value.attr[t]=null}))),n.value.feed&&n.value.feed.length>0&&(n.value.feed=[])}catch(v){}finally{u.value=!1}})),c=()=>s(this,null,(function*(){var e,l,u,r,s,c,d,p,v;if(o.value)return;const f=i({},n.value);f.attr=f.attr.join(","),f.feed=f.feed.join(",");let m=[];if((null==(e=a.value)?void 0:e.sku)&&(null==(l=a.value)?void 0:l.sku.length)>0){const e=null==(u=a.value)?void 0:u.sku.find((e=>e.product_sku_id==n.value.product_sku_id));f.price=(null==e?void 0:e.product_price)||0,(null==e?void 0:e.spec_name)&&m.push(null==e?void 0:e.spec_name)}(null==(r=a.value)?void 0:r.product_attr)&&(null==(s=a.value)?void 0:s.product_attr.length)&&(null==(c=a.value)||c.product_attr.map(((e,t)=>{(null==e?void 0:e.attribute_value)&&(null==e?void 0:e.attribute_value.length)>0&&(null==e?void 0:e.attribute_value[n.value.attr[t]])&&m.push(null==e?void 0:e.attribute_value[n.value.attr[t]])}))),(null==(d=a.value)?void 0:d.product_feed)&&(null==(p=a.value)?void 0:p.product_feed.length)>0&&(null==(v=a.value)||v.product_feed.map(((e,t)=>{_(t)&&(m.push(e.feed_name),f.price=De(f.price,null==e?void 0:e.price))}))),f.describe=m.join(";"),f.delivery=q()?30:40,f.order_id=re();try{o.value=!0;const e=yield Ue(f);1==e.code&&(N(e.data.order_id),C({title:e.msg,icon:"none"}),t("update:show",!1),setTimeout((()=>{t("success")}),100))}catch(y){}finally{o.value=!1}})),_=e=>n.value.feed.indexOf(e)>-1,m=(e,t)=>n.value.attr[e]==t;return(e,u)=>{const i=oe,r=O,s=E,d=V,p=v(f("ti-modal"),y);return h(),b(p,{show:l.show,title:I(x)("商品详情"),confirmLoading:o.value,onCancel:u[0]||(u[0]=e=>t("update:show",!1)),onConfirm:c},{content:g((()=>[w(r,{class:"ti-dialog-content"},{default:g((()=>[w(r,{class:"ti-detail-box"},{default:g((()=>[w(r,{class:"ti-detail-image"},{default:g((()=>{var e,t,l,u;return[(null==(e=a.value)?void 0:e.image)&&(null==(t=a.value)?void 0:t.image[0])&&(null==(l=a.value)?void 0:l.image[0].file_path)?(h(),b(i,{key:0,src:null==(u=a.value)?void 0:u.image[0].file_path,mode:"widthFix"},null,8,["src"])):M("",!0)]})),_:1}),w(r,{class:"ti-detail-con"},{default:g((()=>[w(r,{class:"ti-detail-title text-ellipsis"},{default:g((()=>{var e;return[k(j(null==(e=a.value)?void 0:e.product_name_text),1)]})),_:1}),w(r,{class:"ti-price-box"},{default:g((()=>[w(s,{class:"ti-detail-unit"},{default:g((()=>[k(j(I(x)("單價：")),1)])),_:1}),w(s,{class:"ti-detail-price"},{default:g((()=>{var e;return[k(j(I(B)((null==(e=a.value)?void 0:e.product_price)||0)),1)]})),_:1}),w(s,{class:"ti-detail-subPrice"},{default:g((()=>{var e;return[k(j(I(T)((null==(e=a.value)?void 0:e.product_price)||0)),1)]})),_:1})])),_:1}),w(r,{class:"ti-price-box"},{default:g((()=>[w(s,{class:"ti-detail-unit"},{default:g((()=>[k(j(I(x)("單位：")),1)])),_:1}),w(s,{class:"ti-detail-price"},{default:g((()=>{var e;return[k(j(null==(e=a.value)?void 0:e.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),w(r,{class:"ti-detail-specs"},{default:g((()=>[w(d,{"scroll-y":""},{default:g((()=>[w(r,{class:"ti-specs-box"},{default:g((()=>{var e,t,l,u,o,i,c;return[(null==(e=a.value)?void 0:e.sku)&&(null==(t=a.value)?void 0:t.sku.length)>0?(h(),b(r,{key:0,class:"ti-specs-item"},{default:g((()=>[w(r,{class:"ti-specs-title"},{default:g((()=>[k(j(I(x)("規格")),1)])),_:1}),w(r,{class:"ti-specs-child"},{default:g((()=>{var e;return[(h(!0),A(D,null,U(null==(e=a.value)?void 0:e.sku,(e=>(h(),b(r,{key:e.product_sku_id,class:$([{active:e.product_sku_id==n.value.product_sku_id},"ti-child-item"]),onClick:t=>{return l=e.product_sku_id,void(n.value.product_sku_id!=l&&(n.value.product_sku_id=l));var l}},{default:g((()=>[w(s,{class:"ti-child-name"},{default:g((()=>[k(j(e.spec_name_text),1)])),_:2},1024),w(s,{class:"ti-child-price"},{default:g((()=>[k(j(I(B)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024),w(s,{class:"ti-child-subPrice"},{default:g((()=>[k(j(I(T)((null==e?void 0:e.product_price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):M("",!0),(null==(l=a.value)?void 0:l.product_attr)&&(null==(u=a.value)?void 0:u.product_attr.length)>0?(h(!0),A(D,{key:1},U(null==(o=a.value)?void 0:o.product_attr,((e,t)=>(h(),b(r,{key:t,class:"ti-specs-item"},{default:g((()=>[w(r,{class:"ti-specs-title"},{default:g((()=>[k(j(e.attribute_name_text),1)])),_:2},1024),w(r,{class:"ti-specs-child"},{default:g((()=>[(h(!0),A(D,null,U(null==e?void 0:e.attribute_value_text,((e,l)=>(h(),b(r,{key:l,class:$([{active:m(t,l)},"ti-child-item"]),onClick:e=>((e,t)=>{n.value.attr[e]=t})(t,l)},{default:g((()=>[w(s,{class:"ti-child-name"},{default:g((()=>[k(j(e),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):M("",!0),(null==(i=a.value)?void 0:i.product_feed)&&(null==(c=a.value)?void 0:c.product_feed.length)>0?(h(),b(r,{key:2,class:"ti-specs-item"},{default:g((()=>[w(r,{class:"ti-specs-title"},{default:g((()=>[k(j(I(x)("加料")),1)])),_:1}),w(r,{class:"ti-specs-child"},{default:g((()=>{var e;return[(h(!0),A(D,null,U(null==(e=a.value)?void 0:e.product_feed,((e,t)=>(h(),b(r,{key:t,class:$([{active:_(t)},"ti-child-item"]),onClick:e=>(e=>{const t=n.value.feed.indexOf(e);t>=0?n.value.feed.splice(t,1):n.value.feed.push(e)})(t)},{default:g((()=>[w(s,{class:"ti-child-name"},{default:g((()=>[k(j(e.feed_name_text),1)])),_:2},1024),w(s,{class:"ti-child-price"},{default:g((()=>[k(j(I(B)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024),w(s,{class:"ti-child-subPrice"},{default:g((()=>[k(j(I(T)((null==e?void 0:e.price)||0,!0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):M("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","confirmLoading"])}}},[["__scopeId","data-v-0d153051"]]),Ra=c({__name:"dish-list",emits:["success"],setup(e,{emit:t}){const l=d(!1),a=d({category_id:null,page:1,list_rows:20}),u=d([]),o=d(!1),n=d(),r=d(!1),c=d(0);p((()=>a.value.category_id),(()=>{y()}));const _=()=>{t("success")},m=()=>{r.value&&(a.value.page+=1,P())},y=()=>{a.value.page=1,P(!0)},P=e=>s(this,null,(function*(){var t,l,n,s,d,p;if(o.value)return;const v=i({},a.value);v.category_id||(v.category_id=null),1==c.value&&(v.is_special=1);try{e&&(o.value=!0);const i=yield $e(v);1==a.value.page&&(u.value=[]),u.value=u.value.concat((null==(l=null==(t=i.data)?void 0:t.list)?void 0:l.data)||[]),r.value=(null==(s=null==(n=i.data)?void 0:n.list)?void 0:s.last_page)>(null==(p=null==(d=i.data)?void 0:d.list)?void 0:p.current_page)}catch(_){}finally{e&&(o.value=!1)}}));return y(),(e,t)=>{const i=v(f("ti-loading"),L),s=oe,d=E,p=O,y=v(f("ti-empty-data"),z),P=V;return h(),A(D,null,[w(p,{class:"ti-dish-box"},{default:g((()=>[w(Ma,{categoryId:a.value.category_id,"onUpdate:categoryId":t[0]||(t[0]=e=>a.value.category_id=e),isSpecial:c.value,"onUpdate:isSpecial":t[1]||(t[1]=e=>c.value=e)},null,8,["categoryId","isSpecial"]),w(p,{class:"ti-dish-list"},{default:g((()=>[w(P,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:m},{default:g((()=>[o.value?(h(),b(i,{key:0})):u.value&&u.value.length>0?(h(),A(D,{key:1},[w(p,{class:"ti-dish-goods"},{default:g((()=>[(h(!0),A(D,null,U(u.value,((e,t)=>(h(),b(p,{key:t,class:$([{"sold-out":e.product_stock<=0},"ti-goods-item"]),onClick:t=>(e=>{if(e.product_stock<=0)return C({title:x("已售罄"),icon:"none"});l.value=!0,n.value=e.product_id})(e)},{default:g((()=>[w(p,{class:"ti-goods-image"},{default:g((()=>[e.image&&e.image[0]&&e.image[0].file_path?(h(),b(s,{key:0,src:e.image[0].file_path,mode:"widthFix"},null,8,["src"])):M("",!0),w(d,{class:"sold-out-text"},{default:g((()=>[k(j(I(x)("已售罄")),1)])),_:1})])),_:2},1024),w(p,{class:"ti-goods-content"},{default:g((()=>[w(p,{class:"ti-goods-title line-clamp-2"},{default:g((()=>[k(j(e.product_name_text),1)])),_:2},1024),w(p,{class:"ti-price-box"},{default:g((()=>[w(d,{class:"ti-goods-price"},{default:g((()=>[k(j(I(B)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),w(d,{class:"ti-goods-subPrice"},{default:g((()=>[k(j(I(T)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),w(i,{status:r.value?"loading":"no-more"},null,8,["status"])],64)):(h(),b(y,{key:2}))])),_:1})])),_:1})])),_:1}),w(Ka,{show:l.value,"onUpdate:show":t[2]||(t[2]=e=>l.value=e),productId:n.value,onSuccess:_},null,8,["show","productId"])],64)}}},[["__scopeId","data-v-202380de"]]),Wa=c({__name:"index",setup(e){const t=d();pe((()=>{ve({title:"二次进入"}),_e()})),fe((()=>{preloadPage("/pages/index/index")}));const l=()=>{var e;null==(e=t.value)||e.getCartData()};return(e,a)=>{const u=O,o=me("ti-layout");return h(),b(o,null,{default:g((()=>[w(u,{class:"ti-index"},{default:g((()=>[w(Na,{ref_key:"cartRef",ref:t},null,512),w(Ra,{onSuccess:l})])),_:1})])),_:1})}}},[["__scopeId","data-v-d9d0ba18"]]);export{Wa as default};
