import{_ as e,r as a,a as t,b as l,c as r,k as s,d as u,o as c,f as i,g as o,h as d,i as n,t as m,u as f,$ as h,C as _,s as g,j as v,D as p,B as b,E as y,G as k,O as C,T as w,U as x,aj as V,L as j,V as U}from"./index-ddc987dd.js";import{_ as O}from"./u-popup.d3c67cb1.js";import{d as I,e as B}from"./payment.b8ada7fc.js";const D=""+new URL("close-40f4220f.svg",import.meta.url).href,E=e({__name:"dialog-recharge",props:{show:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup(e,{emit:w}){a("");const x=a(!1),V=a(!1),j=a(0);var U="inc";const E={1:"inc",2:"dec",3:"final"},L=a(),R=a(""),T=a({}),F=a(""),G=e=>{U=E[e.detail.value]},N=e=>{x.value?R.value+=e+"":V.value&&(F.value+=e+"")},$=()=>{x.value?R.value="":V.value&&(F.value="")},q=()=>{K()},z=()=>{H()},A=async()=>{const e={mobile:R.value};try{const a=await I(e);1==a.code&&(T.value=a.data)}catch(a){}},H=async()=>{const e={user_id:T.value.user_id,source:j.value,recharge_value:F.value,mode:U};try{1==(await B(e)).code&&(setTimeout((()=>{g({title:h("充值成功")})}),200),A())}catch(a){}},J=e=>{"recharge"==e?(V.value=!0,x.value=!1):"phone"==e&&(V.value=!1,x.value=!0)},K=()=>{w("update:show",!1)},M=()=>{};return(a,g)=>{const w=v,U=t(r("ti-input"),l),I=t(r("ti-button"),s),B=p,E=b,H=y,P=k,Q=C,S=t(r("ti-keyboard"),u),W=t(r("u-popup"),O);return c(),i(W,{ref_key:"dialogRef",ref:L,bgColor:"transparent",round:16,show:e.show,mode:"right",onOpen:M,onClose:K,closeOnClickOverlay:!1},{default:o((()=>[d(w,{class:"ti-recharge-dialog"},{default:o((()=>[d(w,{class:"ti-recharge-container"},{default:o((()=>[d(w,{class:"ti-recharge-title"},{default:o((()=>[n(m(f(h)("会员充值")),1)])),_:1}),d(w,{class:"ti-recharge-content"},{default:o((()=>{var e;return[d(w,{class:"ti-recharge-item"},{default:o((()=>[d(U,{class:"ti-recharge-input",focus:x.value,modelValue:R.value,"onUpdate:modelValue":g[0]||(g[0]=e=>R.value=e),placeholder:f(h)("請輸入會員手機號/ID"),onClick:g[1]||(g[1]=e=>J("phone"))},null,8,["focus","modelValue","placeholder"]),d(I,{class:"ti-recharge-button",type:"primary",onClick:A},{default:o((()=>[n(m(f(h)("查找")),1)])),_:1})])),_:1}),(null==(e=T.value)?void 0:e.user_id)?(c(),i(w,{key:0,class:"ti-recharge-member"},{default:o((()=>[d(w,{class:"ti-recharge-member-item"},{default:o((()=>[d(w,{class:"ti-recharge-member-title"},{default:o((()=>[n(m(f(h)("暱稱")),1)])),_:1}),d(w,{class:"ti-recharge-member-content"},{default:o((()=>[n(m(T.value.nickName||"-"),1)])),_:1})])),_:1}),d(w,{class:"ti-recharge-member-item"},{default:o((()=>[d(w,{class:"ti-recharge-member-title"},{default:o((()=>[n(m(f(h)("會員卡/等級")),1)])),_:1}),d(w,{class:"ti-recharge-member-content"},{default:o((()=>{var e;return[n(m(null==(e=T.value.card)?void 0:e.card_name),1)]})),_:1})])),_:1}),d(w,{class:"ti-recharge-member-item"},{default:o((()=>[d(w,{class:"ti-recharge-member-title"},{default:o((()=>[n(m(f(h)("餘額")),1)])),_:1}),d(w,{class:"ti-recharge-member-content"},{default:o((()=>[n(m(T.value.balance),1)])),_:1})])),_:1}),d(w,{class:"ti-recharge-member-item"},{default:o((()=>[d(w,{class:"ti-recharge-member-title"},{default:o((()=>[n(m(f(h)("積分")),1)])),_:1}),d(w,{class:"ti-recharge-member-content"},{default:o((()=>[n(m(T.value.points),1)])),_:1})])),_:1})])),_:1})):_("",!0),d(w,{class:"ti-recharge-item margin"},{default:o((()=>[d(w,{class:"ti-recharge-subtitle"},{default:o((()=>[n(m(f(h)("充值类型")),1)])),_:1}),d(w,{class:"ti-recharge-item-buttons"},{default:o((()=>[d(I,{class:"ti-recharge-button",type:0==j.value?"primary":"default",onClick:g[2]||(g[2]=e=>j.value=0)},{default:o((()=>[n(m(f(h)("余额")),1)])),_:1},8,["type"]),d(I,{class:"ti-recharge-button",type:1==j.value?"primary":"default",onClick:g[3]||(g[3]=e=>j.value=1)},{default:o((()=>[n(m(f(h)("积分")),1)])),_:1},8,["type"])])),_:1})])),_:1}),d(w,{class:"ti-recharge-item margin"},{default:o((()=>[d(w,{class:"ti-recharge-subtitle"},{default:o((()=>[n(m(f(h)("充值类型")),1)])),_:1}),d(P,{class:"ti-type-radio",onChange:G},{default:o((()=>[d(H,null,{default:o((()=>[d(B,{value:"1",color:"#ffbe00",checked:"true"}),d(E,{class:"ti-radio-text"},{default:o((()=>[n(m(f(h)("增加")),1)])),_:1})])),_:1}),d(H,null,{default:o((()=>[d(B,{value:"2",color:"#ffbe00"}),d(E,{class:"ti-radio-text"},{default:o((()=>[n(m(f(h)("減少")),1)])),_:1})])),_:1}),d(H,null,{default:o((()=>[d(B,{value:"3",color:"#ffbe00"}),d(E,{class:"ti-radio-text"},{default:o((()=>[n(m(f(h)("最終結果")),1)])),_:1})])),_:1})])),_:1})])),_:1}),d(w,{class:"ti-recharge-item margin"},{default:o((()=>[d(w,{class:"ti-recharge-subtitle"},{default:o((()=>[n(m(f(h)("變更金額")),1)])),_:1}),d(U,{modelValue:F.value,"onUpdate:modelValue":g[4]||(g[4]=e=>F.value=e),class:"ti-recharge-input left",focus:V.value,placeholder:f(h)("請輸入變更金額"),onClick:g[5]||(g[5]=e=>J("recharge"))},null,8,["modelValue","focus","placeholder"])])),_:1})]})),_:1}),d(Q,{onClick:K,class:"ti-recharge-close",src:D,mode:"widthFix"})])),_:1}),d(w,{class:"ti-recharge-keyboard"},{default:o((()=>[d(S,{onInput:N,onClear:$,onExit:q,onConfirm:z,isCross:!0})])),_:1})])),_:1})])),_:1},8,["show"])}}},[["__scopeId","data-v-5226cce3"]]),L={__name:"index",setup(e){var t=a(!0);const l=()=>{t.value=!0};return w((()=>{x()})),(e,a)=>{const r=j,s=v,u=U("ti-layout");return c(),i(u,null,{default:o((()=>[d(s,null,{default:o((()=>[d(r,{onClick:l},{default:o((()=>[n("充值")])),_:1})])),_:1}),d(E,{show:f(t),"onUpdate:show":a[0]||(a[0]=e=>V(t)?t.value=e:t=e)},null,8,["show"])])),_:1})}}};export{L as default};
