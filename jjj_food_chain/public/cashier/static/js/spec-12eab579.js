import{d as e,B as t}from"./element-plus-cd5f0841.js";import{_ as s}from"./index-1d6a11a7.js";import{o as i,T as a,S as l,a as d,P as c,W as r,c as o,X as p,Q as _,a9 as u,Y as n,M as m}from"./@vue-ec4837bd.js";import"./lodash-es-42625722.js";import"./async-validator-cf877c1f.js";import"./@vueuse-351f2583.js";import"./dayjs-3a594381.js";import"./call-bind-8544b80b.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./@element-plus-399cea60.js";import"./@popperjs-b78c3215.js";import"./escape-html-1590d737.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-bec44c5f.js";import"./pinia-57a80881.js";import"./sass-9c753014.js";import"./immutable-f1afe65f.js";const h={data:()=>({dialogVisible:!1,product_sku_id:0,space_name:"",attr_name:[],feed_name:[],show_sku:{attr:[],feed:[],product_price:"",bag_price:0},feed_price:"",line_price:""}),props:{is_pop:Boolean,detail:Object},computed:{},watch:{is_pop:function(e,t){e!=t&&(this.dialogVisible=e,e&&this.init())}},methods:{init(){this.space_name="",this.attr_name=[],this.feed_name=[],this.product_sku_id=0,this.feed_price="",this.line_price="",this.show_sku={attr:[],feed:[],product_price:"",bag_price:0},this.selecedtSpec(this.detail.sku[0],0)},selecedtSpec(e,t){let s=this;s.product_sku_id=e.product_sku_id,s.space_name=e.spec_name,s.show_sku.product_price=e.product_price,s.line_price=e.line_price,s.show_sku.bag_price=e.bag_price},selectAttr(e,t,s){this.show_sku.attr[s]=t,this.attr_name[s]=e},selectFeed(e,t){let s=this;if(s.show_sku.feed[t]||0===s.show_sku.feed[t]){s.show_sku.feed[t]=null,s.feed_price=1*s.feed_price-1*e.price;let i=s.feed_name.indexOf(e.feed_name);i>-1&&s.feed_name.splice(i,1)}else s.show_sku.feed[t]=t,s.feed_price=1*s.feed_price+1*e.price,s.feed_name.push(e.feed_name)},describe:function(){let e=this.space_name;""!=e&&(e+=";");let t=this.attr_name.join(";");""!=t&&(t+=";");let s=this.feed_name.join(",");return""!=s&&(s+=";"),e+t+s},addCart(){let e=this,t=[];e.show_sku.feed.forEach(((e,s)=>{null!=e&&t.push(e)})),t=t.length<=0?"":t.join(",");let s={product_id:e.detail.product_id,product_num:1,product_sku_id:e.product_sku_id,attr:e.show_sku.attr.join(","),feed:t,describe:e.describe(),price:1*e.feed_price+1*e.show_sku.product_price,product_price:1*e.feed_price+1*e.line_price,bag_price:e.show_sku.bag_price};e.handleClose(s)},handleClose(e){e&&e.product_id?this.$emit("close",e):this.$emit("close",null)}}},f=d("div",{class:"dialog-title"},"商品详情",-1),k={class:"d-s-c"},b={class:"product-image"},j=["src"],v={class:"p20"},g={class:"f16 tl fb"},w={class:"gray6 tl"},y={key:0,class:"mt20"},C=d("div",{class:"fb mb10 tl"},"规格",-1),V={class:"attr-list"},S=["onClick"],x={class:"fb mb10 tl"},A={class:"attr-list"},B=["onClick"],F={key:2,class:"mt20"},O=d("div",{class:"fb mb10 tl"},"加料",-1),$={class:"attr-list"},z=["onClick"],E={class:"dialog-footer"};const M=s(h,[["render",function(s,h,M,P,Q,T){const U=e,W=t;return i(),a(W,{title:"",modelValue:Q.dialogVisible,"onUpdate:modelValue":h[1]||(h[1]=e=>Q.dialogVisible=e),"before-close":T.handleClose,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"906",class:"dialog-spec"},{title:l((()=>[f])),footer:l((()=>[d("span",E,[c(U,{onClick:h[0]||(h[0]=e=>T.handleClose(null))},{default:l((()=>[r("取 消")])),_:1}),c(U,{type:"primary",onClick:T.addCart},{default:l((()=>[r("确 定")])),_:1},8,["onClick"])])])),default:l((()=>[null!=M.detail?(i(),o(_,{key:0},[d("div",k,[d("div",b,[d("img",{src:M.detail.image[0].file_path},null,8,j)]),d("div",v,[d("div",g,p(M.detail.product_name),1),d("div",w,"单价:￥"+p(M.detail.product_price)+" 单位:"+p(M.detail.product_unit),1)])]),20==M.detail.spec_type?(i(),o("div",y,[C,d("div",V,[(i(!0),o(_,null,u(M.detail.sku,((e,t)=>(i(),o("div",{class:m(["attr-item",{active:Q.product_sku_id==e.product_sku_id}]),onClick:s=>T.selecedtSpec(e,t),key:t},p(e.spec_name+" ￥"+e.product_price),11,S)))),128))])])):n("",!0),M.detail.product_attr.length>0?(i(!0),o(_,{key:1},u(M.detail.product_attr,((e,t)=>(i(),o("div",{class:"mt20",key:t},[d("div",x,p(e.attribute_name),1),d("div",A,[(i(!0),o(_,null,u(e.attribute_value,((e,s)=>(i(),o(_,null,[e?(i(),o("div",{class:m(["attr-item",{active:Q.show_sku.attr[t]==s}]),key:s,onClick:i=>T.selectAttr(e,s,t)},p(e),11,B)):n("",!0)],64)))),256))])])))),128)):n("",!0),M.detail.product_feed.length>0?(i(),o("div",F,[O,d("div",$,[(i(!0),o(_,null,u(M.detail.product_feed,((e,t)=>(i(),o("div",{class:m(["attr-item",{active:null!=Q.show_sku.feed[t]}]),onClick:s=>T.selectFeed(e,t),key:t},p(e.feed_name+" ￥"+e.price),11,z)))),128))])])):n("",!0)],64)):n("",!0)])),_:1},8,["modelValue","before-close"])}]]);export{M as default};
