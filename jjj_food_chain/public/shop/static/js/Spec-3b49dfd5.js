import{g as e,h as l,d as o,E as t,i as a,R as s,m as r,n as m,o as u,p as d}from"./element-plus-b01b3a31.js";import{_ as i}from"./_plugin-vue_export-helper-1b428a4d.js";import{o as n,c as p,P as c,S as f,a as _,W as h,Y as b,T as g,ag as k,Q as y,a8 as V,X as j}from"./@vue-e72ffbb6.js";import"./index-b09dd756.js";import"./@vueuse-0fb12a45.js";import"./lodash-es-cce4393d.js";import"./async-validator-cf877c1f.js";import"./@element-plus-4b00147d.js";import"./dayjs-34225b3b.js";import"./call-bind-2971450c.js";import"./get-intrinsic-d8eb8ca0.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-afbcd6f2.js";import"./has-719bcddc.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-bf98ca95.js";import"./pinia-72b16af9.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./qs-a8eee860.js";import"./side-channel-052d4c61.js";import"./object-inspect-dd55f836.js";import"./pinia-plugin-persistedstate-35ef556e.js";import"./vue-ueditor-wrap-e5a15ab3.js";import"./vue-i18n-73a1cd16.js";import"./@intlify-28c65249.js";const w={class:"spec-many-type"},v={class:"spec-wrap"},S={key:0};const U={class:"mt16"};const x={components:{Single:i({inject:["form"]},[["render",function(o,t,a,s,r,m){const u=e,d=l;return n(),p("div",null,[c(d,{label:"产品价格：",width:"80",rules:[{required:!0,message:"请填写产品价格"}],prop:"model.sku[0].product_price"},{default:f((()=>[c(u,{type:"number",modelValue:m.form.model.sku[0].product_price,"onUpdate:modelValue":t[0]||(t[0]=e=>m.form.model.sku[0].product_price=e),class:"max-w460"},null,8,["modelValue"])])),_:1}),c(d,{label:"包装费：",rules:[{required:!0,message:"请填写包装费"}],prop:"model.sku[0].bag_price"},{default:f((()=>[c(u,{type:"number",modelValue:m.form.model.sku[0].bag_price,"onUpdate:modelValue":t[1]||(t[1]=e=>m.form.model.sku[0].bag_price=e),class:"max-w460"},null,8,["modelValue"])])),_:1}),c(d,{label:"库存数量：",rules:[{required:!0,message:"请填写库存数量"}],prop:"model.sku[0].stock_num"},{default:f((()=>[c(u,{type:"number",modelValue:m.form.model.sku[0].stock_num,"onUpdate:modelValue":t[2]||(t[2]=e=>m.form.model.sku[0].stock_num=e),class:"max-w460"},null,8,["modelValue"])])),_:1})])}]]),Many:i({components:{Type:i({data:()=>({showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}),inject:["form"],created(){},methods:{onToggleAddGroupForm:function(){let e=this;Array.isArray(e.form.model.sku)||(e.form.model.sku=[]),e.form.model.sku.push({spec_name:"",product_price:"",bag_price:"",stock_num:"",cost_price:0,is_full:0})},onDeleteGroup:function(e){var l=this;o.confirm("删除后不可恢复，确认删除该记录吗?","提示",{type:"warning"}).then((()=>{l.form.model.spec_many.spec_attr.splice(e,1),l.buildSkulist()}))},onDeleteValue:function(e,l){let a=this;a.form.isSpecLocked?t({message:"本商品正在参加活动，不能删除规格！",type:"warning"}):o.confirm("删除后不可恢复，确认删除该记录吗?","提示",{type:"warning"}).then((()=>{a.form.model.spec_many.spec_attr[e].spec_items.splice(l,1),a.buildSkulist()}))}}},[["render",function(e,l,o,t,s,r){const m=a;return n(),p("div",w,[_("div",v,[r.form.isSpecLocked?b("",!0):(n(),p("div",S,[c(m,{size:"small",class:"el-icon-circle-plus",onClick:r.onToggleAddGroupForm},{default:f((()=>[h("添加规格 ")])),_:1},8,["onClick"])]))])])}],["__scopeId","data-v-96a82cd0"]]),Table:i({components:{},data:()=>({restaurants:[],formData:{},batchData:{product_price:"",line_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}),inject:["form"],created(){this.formData=this.form},mounted(){},methods:{deleteAttr(e){this.form.model.sku.splice(e,1)},querySearch(e,l){0==this.restaurants.length&&this.formData.spec.forEach(((e,l)=>{this.restaurants.push({value:e.spec_name})}));var o=this.restaurants;l(e?o.filter(this.createFilter(e)):o)},createFilter:e=>l=>0===l.value.toLowerCase().indexOf(e.toLowerCase())}},[["render",function(o,t,u,d,i,_){const k=s,y=l,V=r,j=e,w=a,v=m;return n(),p("div",U,[_.form.model.sku.length>0?(n(),g(y,{key:0,label:"规格明细："},{default:f((()=>[c(v,{size:"",data:_.form.model.sku,border:"",style:{width:"100%","margin-top":"20px"}},{default:f((()=>[c(V,{label:"规格名称"},{default:f((e=>[c(y,{label:"",style:{"margin-bottom":"0"}},{default:f((()=>[c(k,{class:"inline-input",modelValue:e.row.spec_name,"onUpdate:modelValue":l=>e.row.spec_name=l,"fetch-suggestions":_.querySearch,placeholder:"请输入内容"},null,8,["modelValue","onUpdate:modelValue","fetch-suggestions"])])),_:2},1024)])),_:1}),c(V,{label:"价格"},{default:f((e=>[c(y,{label:"",style:{"margin-bottom":"0"}},{default:f((()=>[c(j,{type:"number",size:"small",prop:"product_price",modelValue:e.row.product_price,"onUpdate:modelValue":l=>e.row.product_price=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1}),c(V,{label:"包装费"},{default:f((e=>[c(y,{label:"",style:{"margin-bottom":"0"}},{default:f((()=>[c(j,{type:"number",size:"small",prop:"bag_price",modelValue:e.row.bag_price,"onUpdate:modelValue":l=>e.row.bag_price=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1}),c(V,{label:"库存"},{default:f((e=>[c(y,{label:"",style:{"margin-bottom":"0"}},{default:f((()=>[c(j,{type:"number",size:"small",prop:"stock_num",modelValue:e.row.stock_num,"onUpdate:modelValue":l=>e.row.stock_num=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:1}),c(V,{label:""},{default:f((e=>[c(y,{label:"",style:{"margin-bottom":"0"}},{default:f((()=>[c(w,{type:"text",onClick:l=>_.deleteAttr(e.$index)},{default:f((()=>[h("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])),_:1})):b("",!0)])}]])}},[["render",function(e,l,o,t,a,s){const r=k("Type"),m=k("Table");return n(),p("div",null,[c(r),c(m)])}]])},data:()=>({restaurants:[]}),inject:["form"],methods:{changeSpec(e){10==e?(this.form.sku=[],this.form.sku[0]={product_price:"",stock_num:"",bag_price:"",cost_price:0,is_full:0}):20==e&&(this.form.sku=[])},querySearch(e,l){let o=this;0==o.restaurants.length&&o.form.unit.forEach(((e,l)=>{o.restaurants.push({value:e.unit_name})}));var t=this.restaurants;l(e?t.filter(this.createFilter(e)):t)},createFilter:e=>l=>0===l.value.toLowerCase().indexOf(e.toLowerCase())}},L=_("div",{class:"common-form mt50"},"规格/库存",-1),C={key:0,class:"red"};const q=i(x,[["render",function(e,o,t,a,r,m){const i=u,_=d,w=l,v=s,S=k("Single"),U=k("Many");return n(),p("div",null,[L,c(w,{label:"库存计算方式："},{default:f((()=>[c(_,{modelValue:m.form.model.deduct_stock_type,"onUpdate:modelValue":o[0]||(o[0]=e=>m.form.model.deduct_stock_type=e)},{default:f((()=>[c(i,{label:10},{default:f((()=>[h("下单减库存")])),_:1}),c(i,{label:20},{default:f((()=>[h("付款减库存")])),_:1})])),_:1},8,["modelValue"])])),_:1}),c(w,{label:"特色分类："},{default:f((()=>[c(_,{modelValue:m.form.model.special_id,"onUpdate:modelValue":o[1]||(o[1]=e=>m.form.model.special_id=e)},{default:f((()=>[c(i,{label:0},{default:f((()=>[h("无")])),_:1}),(n(!0),p(y,null,V(m.form.special,((e,l)=>(n(),g(i,{label:e.category_id,key:l},{default:f((()=>[h(j(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(w,{label:"商品单位：",rules:[{required:!0,message:"请填写商品单位"}],prop:"model.product_unit"},{default:f((()=>[c(v,{class:"inline-input",modelValue:m.form.model.product_unit,"onUpdate:modelValue":o[2]||(o[2]=e=>m.form.model.product_unit=e),placeholder:"如:大份","fetch-suggestions":m.querySearch},null,8,["modelValue","fetch-suggestions"])])),_:1}),c(w,{label:"产品规格："},{default:f((()=>[c(_,{modelValue:m.form.model.spec_type,"onUpdate:modelValue":o[3]||(o[3]=e=>m.form.model.spec_type=e),onChange:m.changeSpec},{default:f((()=>[!m.form.isSpecLocked||m.form.isSpecLocked&&10==m.form.model.spec_type?(n(),g(i,{key:0,label:10},{default:f((()=>[h("单规格")])),_:1})):b("",!0),!m.form.isSpecLocked||m.form.isSpecLocked&&20==m.form.model.spec_type?(n(),g(i,{key:1,label:20},{default:f((()=>[h("多规格")])),_:1})):b("",!0)])),_:1},8,["modelValue","onChange"]),m.form.isSpecLocked?(n(),p("div",C,"此商品正在参加活动，不能修改规格")):b("",!0)])),_:1}),10==m.form.model.spec_type?(n(),g(S,{key:0})):b("",!0),20==m.form.model.spec_type?(n(),g(U,{key:1})):b("",!0)])}]]);export{q as default};
