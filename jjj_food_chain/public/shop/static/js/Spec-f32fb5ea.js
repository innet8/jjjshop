import{O as e,h as t,d as s,E as a,i as r,R as l,m as o,g as n,n as u,o as i,p as d}from"./element-plus-d03e850c.js";import{_ as m}from"./_plugin-vue_export-helper-1b428a4d.js";import{o as p,c,P as h,S as _,T as f,W as g,X as k,Y as y,a as w,Q as b,a8 as z,ag as v}from"./@vue-e72ffbb6.js";import{l as j}from"./index-78e33596.js";import"./@vueuse-0fb12a45.js";import"./lodash-es-cce4393d.js";import"./async-validator-cf877c1f.js";import"./@element-plus-4b00147d.js";import"./dayjs-34225b3b.js";import"./call-bind-2971450c.js";import"./get-intrinsic-d8eb8ca0.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-afbcd6f2.js";import"./has-719bcddc.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-bf98ca95.js";import"./pinia-72b16af9.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./qs-a8eee860.js";import"./side-channel-052d4c61.js";import"./object-inspect-dd55f836.js";import"./pinia-plugin-persistedstate-35ef556e.js";import"./vue-ueditor-wrap-e5a15ab3.js";import"./vue-i18n-73a1cd16.js";import"./@intlify-28c65249.js";const $=m({inject:["form"]},[["render",function(s,a,r,l,o,n){const u=e,i=t;return p(),c("div",null,[h(i,{label:s.$t("商品价格："),width:"80",rules:[{required:!0,message:s.$t("请填写商品价格")}],prop:"model.sku[0].product_price"},{default:_((()=>[h(u,{min:0,controls:!1,modelValue:n.form.model.sku[0].product_price,"onUpdate:modelValue":a[0]||(a[0]=e=>n.form.model.sku[0].product_price=e),placeholder:s.$t("请填写商品价格"),class:"max-w460"},null,8,["modelValue","placeholder"])])),_:1},8,["label","rules"]),h(i,{label:s.$t("库存数量："),rules:[{required:!0,message:s.$t("请填写库存数量")}],prop:"model.sku[0].stock_num"},{default:_((()=>[h(u,{min:0,controls:!1,placeholder:s.$t("请填写库存数量"),modelValue:n.form.model.sku[0].stock_num,"onUpdate:modelValue":a[1]||(a[1]=e=>n.form.model.sku[0].stock_num=e),class:"max-w460"},null,8,["placeholder","modelValue"])])),_:1},8,["label","rules"])])}],["__scopeId","data-v-b7fc513d"]]),S=JSON.stringify(j().languageData);const V=m({data:()=>({showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}),inject:["form"],created(){},methods:{onToggleAddGroupForm:function(){let e=this;Array.isArray(e.form.model.sku)||(e.form.model.sku=[]),e.form.model.sku.push({spec_name:JSON.parse(S),product_price:"",bag_price:"",stock_num:"",cost_price:0,is_full:0})},onDeleteGroup:function(e){var t=this;s.confirm("删除后不可恢复，确认删除该记录吗?","提示",{type:"warning"}).then((()=>{t.form.model.spec_many.spec_attr.splice(e,1),t.buildSkulist()}))},onDeleteValue:function(e,t){let r=this;r.form.isSpecLocked?a({message:"本商品正在参加活动，不能删除规格！",type:"warning"}):s.confirm("删除后不可恢复，确认删除该记录吗?","提示",{type:"warning"}).then((()=>{r.form.model.spec_many.spec_attr[e].spec_items.splice(t,1),r.buildSkulist()}))}}},[["render",function(e,t,s,a,l,o){const n=r;return o.form.isSpecLocked?y("",!0):(p(),f(n,{key:0,size:"small",type:"primary",class:"el-icon-circle-plus",onClick:o.onToggleAddGroupForm},{default:_((()=>[g(k(e.$t("添加规格"))+"+",1)])),_:1},8,["onClick"]))}],["__scopeId","data-v-ee9cc575"]]),x=j().languageList,L={class:"mt16"},C={class:"ww100"},O={label:"",class:"spec-name",style:{"margin-bottom":"0"}};const U=m({components:{Type:V,Table:m({components:{},data:()=>({languageList:x,restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],batchData:{product_price:"",line_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}),inject:["form"],created(){this.form.spec.map(((e,t)=>{this.restaurants_zh.push({value:JSON.parse(e.spec_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.spec_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.spec_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.spec_name).th,index:t})}))},mounted(){},methods:{deleteAttr(e){this.form.model.sku.splice(e,1)},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e,t){this.form.model.sku[t].spec_name.zh=this.restaurants_zh[e.index].value,this.form.model.sku[t].spec_name.th=this.restaurants_th[e.index].value,this.form.model.sku[t].spec_name.en=this.restaurants_en[e.index].value,this.form.model.sku[t].spec_name.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(e,s,a,i,d,m){const v=l,j=t,$=o,S=n,V=r,x=u;return p(),c("div",L,[m.form.model.sku.length>0?(p(),f(j,{key:0,label:e.$t("规格明细：")},{default:_((()=>[w("div",C,[h(x,{size:"",data:m.form.model.sku,border:"",style:{width:"100%","margin-top":"20px"}},{default:_((()=>[h($,{label:e.$t("规格名称"),width:"400"},{default:_((t=>[w("div",O,[(p(!0),c(b,null,z(d.languageList,((s,a)=>(p(),f(j,{key:a,prop:`scope.row.spec_name[${s.key}]`,rules:[{validator:()=>!!t.row.spec_name[s.key],message:e.$t("请输入规格名称")}]},{default:_((()=>[h(v,{size:"small",onSelect:e=>m.selectChange(e,t.$index),"fetch-suggestions":(e,t)=>m.querySearch(e,t,s.key),modelValue:t.row.spec_name[s.key],"onUpdate:modelValue":e=>t.row.spec_name[s.key]=e,placeholder:e.$t("请输入")+`(${s.label})`},null,8,["onSelect","fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])))),128))])])),_:1},8,["label"]),h($,{label:e.$t("价格")},{default:_((t=>[h(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.product_price",rules:[{validator:()=>!!t.row.product_price,message:e.$t("请输入价格")}]},{default:_((()=>[h(S,{type:"number",size:"small",modelValue:t.row.product_price,"onUpdate:modelValue":e=>t.row.product_price=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),h($,{label:e.$t("库存")},{default:_((t=>[h(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.stock_num",rules:[{validator:()=>!!t.row.stock_num,message:e.$t("请输入库存")}]},{default:_((()=>[h(S,{type:"number",size:"small",modelValue:t.row.stock_num,"onUpdate:modelValue":e=>t.row.stock_num=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),h($,{label:""},{default:_((t=>[h(j,{label:"",style:{"margin-bottom":"0"}},{default:_((()=>[h(V,{type:"primary",link:"",onClick:e=>m.deleteAttr(t.$index)},{default:_((()=>[g(k(e.$t("删除")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])])),_:1},8,["label"])):y("",!0)])}],["__scopeId","data-v-e53a7997"]])}},[["render",function(e,t,s,a,r,l){const o=v("Type"),n=v("Table");return p(),c("div",null,[h(o),h(n)])}]]),N=j().languageList,J={class:"common-form mt50"},A={key:0,class:"red"};const q=m({components:{Single:$,Many:U},data:()=>({restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],languageList:N}),inject:["form"],watch:{form:{handler(e){this.restaurants_zh=[],this.restaurants_zhtw=[],this.restaurants_en=[],this.restaurants_th=[],e.unit.map(((e,t)=>{this.restaurants_zh.push({value:JSON.parse(e.unit_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.unit_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.unit_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.unit_name).th,index:t})}))},deep:!0,immediate:!0}},methods:{changeSpec(e){10==e?this.form.sku={product_price:"",stock_num:"",bag_price:0,cost_price:0,is_full:0}:20==e&&(this.form.sku=[])},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e){this.form.model.product_unit.zh=this.restaurants_zh[e.index].value,this.form.model.product_unit.th=this.restaurants_th[e.index].value,this.form.model.product_unit.en=this.restaurants_en[e.index].value,this.form.model.product_unit.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(e,s,a,r,o,n){const u=i,m=d,j=t,$=l,S=v("Single"),V=v("Many");return p(),c("div",null,[w("div",J,k(e.$t("规格/库存")),1),h(j,{label:e.$t("库存计算方式：")},{default:_((()=>[h(m,{modelValue:n.form.model.deduct_stock_type,"onUpdate:modelValue":s[0]||(s[0]=e=>n.form.model.deduct_stock_type=e)},{default:_((()=>[h(u,{label:10},{default:_((()=>[g(k(e.$t("下单减库存")),1)])),_:1}),h(u,{label:20},{default:_((()=>[g(k(e.$t("付款减库存")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(p(!0),c(b,null,z(o.languageList,((t,a)=>(p(),f(j,{key:a,label:0==a?e.$t("商品单位："):"",rules:[{required:!0,message:e.$t("请填写商品单位")}],prop:`model.product_unit.${t.key}`},{default:_((()=>[h($,{"fetch-suggestions":(e,s)=>n.querySearch(e,s,t.key),onSelect:s[1]||(s[1]=e=>n.selectChange(e)),class:"inline-input",modelValue:n.form.model.product_unit[t.key],"onUpdate:modelValue":e=>n.form.model.product_unit[t.key]=e,placeholder:e.$t("请输入")+`(${t.label})`},null,8,["fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label","rules","prop"])))),128)),h(j,{label:e.$t("商品规格：")},{default:_((()=>[h(m,{modelValue:n.form.model.spec_type,"onUpdate:modelValue":s[2]||(s[2]=e=>n.form.model.spec_type=e),onChange:n.changeSpec},{default:_((()=>[!n.form.isSpecLocked||n.form.isSpecLocked&&10==n.form.model.spec_type?(p(),f(u,{key:0,label:10},{default:_((()=>[g(k(e.$t("单规格")),1)])),_:1})):y("",!0),!n.form.isSpecLocked||n.form.isSpecLocked&&20==n.form.model.spec_type?(p(),f(u,{key:1,label:20},{default:_((()=>[g(k(e.$t("多规格")),1)])),_:1})):y("",!0)])),_:1},8,["modelValue","onChange"]),n.form.isSpecLocked?(p(),c("div",A,k(e.$t("此商品正在参加活动，不能修改规格")),1)):y("",!0)])),_:1},8,["label"]),10==n.form.model.spec_type?(p(),f(S,{key:0})):y("",!0),20==n.form.model.spec_type?(p(),f(V,{key:1})):y("",!0)])}],["__scopeId","data-v-5461915f"]]);export{q as default};
