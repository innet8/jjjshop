import{p as e,q as a,h as l,i as t,g as i,e as o,m as s,o as n,B as d,u as r,v as c}from"./element-plus-bf694ad1.js";import{P as u}from"./product-0e2f7311.js";import{_ as p}from"./_plugin-vue_export-helper-1b428a4d.js";import{o as g,S as h,R as m,a as f,O as _,V as y,X as b,c as C,P as k,a7 as v,_ as S}from"./@vue-b57a05a6.js";const w={class:"common-seach-wrap"},V={class:"product-content"},z={class:"table-wrap"},I=["src"],x={class:"pagination"},D={class:"dialog-footer"};const L=p({data:()=>({loading:!0,curPage:1,pageSize:20,totalDataNumber:0,formInline:{category_id:0,search:""},cateList:[],productList:[],status:[{id:10,name:"上架"},{id:20,name:"下架"}],multipleSelection:[],formLabelWidth:"120px",dialogVisible:!1,type:"error",params:null}),props:["isproduct","excludeIds","islist","spec_type","product_type"],watch:{isproduct:function(e,a){e!=a&&e&&(this.dialogVisible=e,this.type="error",this.params=null,this.getData())}},created(){},methods:{selectableFunc:e=>"boolean"!=typeof e.noChoose||e.noChoose,handleCurrentChange(e){this.curPage=e,this.getData()},handleSizeChange(e){this.curPage=1,this.pageSize=e,this.getData()},getData(){let e=this,a=e.formInline;a.page=e.curPage,a.list_rows=e.pageSize,a.spec_type=e.spec_type;let l=function(a){1==a.code&&(e.loading=!1,e.cateList=a.data.category,e.excludeIds&&void 0!==e.excludeIds&&e.excludeIds.length>0?a.data.list.data.forEach((a=>{e.excludeIds.indexOf(a.product_id)>-1?a.noChoose=!1:a.noChoose=!0})):e.islist||a.data.list.data.forEach((e=>{e.noChoose=!0})),e.productList=a.data.list.data,e.totalDataNumber=a.data.list.total)};0==e.product_type?u.takeProductList(a,!0).then((e=>{l(e)})):u.storeProductList(a,!0).then((e=>{l(e)}))},SingleFunc(e){this.multipleSelection=[e],this.addClerk()},addClerk(){let e=this,a=null;e.multipleSelection.length<1?e.$message({message:"请至少选择一件产品商品！",type:"error"}):(e.islist&&void 0!==e.islist?(e.multipleSelection.forEach((e=>{e.image=e.image[0].file_path})),a=e.multipleSelection):(a=e.multipleSelection[0],a.image=a.image[0].file_path),e.params=a,e.type="success",e.dialogVisible=!1)},dialogFormVisible(){this.formInline.category_id=0,this.formInline.search="",this.$emit("closeDialog",{type:this.type,openDialog:!1,params:this.params})},tableCurrentChange(e){this.multipleSelection=e}}},[["render",function(u,p,L,P,F,j){const E=e,N=a,U=l,O=t,$=i,q=o,B=s,R=n,W=d,X=r,A=c;return g(),h(X,{title:"选择商品",modelValue:F.dialogVisible,"onUpdate:modelValue":p[3]||(p[3]=e=>F.dialogVisible=e),onClose:j.dialogFormVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"900px"},{footer:m((()=>[f("div",D,[_(O,{size:"small",onClick:p[2]||(p[2]=e=>F.dialogVisible=!1)},{default:m((()=>[y("取 消")])),_:1}),L.islist?(g(),h(O,{key:0,size:"small",type:"primary",onClick:j.addClerk},{default:m((()=>[y("确 定")])),_:1},8,["onClick"])):b("",!0)])])),default:m((()=>[f("div",w,[_(q,{inline:!0,size:"small",model:F.formInline,class:"demo-form-inline"},{default:m((()=>[_(U,{label:"商品分类"},{default:m((()=>[_(N,{modelValue:F.formInline.category_id,"onUpdate:modelValue":p[0]||(p[0]=e=>F.formInline.category_id=e),placeholder:"请选择商品分类"},{default:m((()=>[_(E,{value:0,label:"全部"}),(g(!0),C(k,null,v(F.cateList,(e=>(g(),C(k,{key:e.category_id},[_(E,{value:e.category_id,label:e.name},null,8,["value","label"]),(g(!0),C(k,null,v(e.child,(a=>(g(),C(k,{key:a.category_id},[void 0!==e.child?(g(),C(k,{key:0},[_(E,{value:a.category_id,label:a.name,style:{"padding-left":"30px"}},null,8,["value","label"]),(g(!0),C(k,null,v(a.child,(e=>(g(),C(k,{key:e.category_id},[void 0!==a.child?(g(),h(E,{key:0,value:e.category_id,label:e.name,style:{"padding-left":"60px"}},null,8,["value","label"])):b("",!0)],64)))),128))],64)):b("",!0)],64)))),128))],64)))),128))])),_:1},8,["modelValue"])])),_:1}),_(U,{label:"商品名称"},{default:m((()=>[_($,{placeholder:"请输入商品名称",modelValue:F.formInline.search,"onUpdate:modelValue":p[1]||(p[1]=e=>F.formInline.search=e)},{append:m((()=>[_(O,{class:"search-button",icon:"Search",onClick:j.getData},{default:m((()=>[y(" 查询 ")])),_:1},8,["onClick"])])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])]),f("div",V,[f("div",z,[S((g(),h(R,{size:"small",data:F.productList,border:"",style:{width:"100%"},"highlight-current-row":"",onSelectionChange:j.tableCurrentChange},{default:m((()=>[_(B,{width:"70",label:"商品图片"},{default:m((e=>[f("img",{src:e.row.image&&e.row.image[0]&&e.row.image[0].file_path,width:30,height:30},null,8,I)])),_:1}),_(B,{prop:"product_name",label:"商品名称"}),_(B,{prop:"category.name",width:"100",label:"商品分类"}),_(B,{prop:"create_time",width:"140",label:"添加时间"}),L.islist?(g(),h(B,{key:0,type:"selection",selectable:j.selectableFunc,width:"44"},null,8,["selectable"])):b("",!0),L.islist?b("",!0):(g(),h(B,{key:1,width:"80",label:"单选"},{default:m((e=>[e.row.noChoose?(g(),h(O,{key:0,size:"",onClick:a=>j.SingleFunc(e.row)},{default:m((()=>[y("选择")])),_:2},1032,["onClick"])):(g(),h(O,{key:1,size:"",disabled:""},{default:m((()=>[y("已选")])),_:1}))])),_:1}))])),_:1},8,["data","onSelectionChange"])),[[A,F.loading]])]),f("div",x,[_(W,{onSizeChange:j.handleSizeChange,onCurrentChange:j.handleCurrentChange,background:"","current-page":F.curPage,"page-sizes":[2,10,20,50,100],"page-size":F.pageSize,layout:"total, prev, pager, next, jumper",total:F.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])])),_:1},8,["modelValue","onClose"])}],["__scopeId","data-v-ee270deb"]]);export{L as _};
