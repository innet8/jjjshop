import{c as e,d as a,r as t,s as l,A as r,e as s,b as o,x as i,t as n,u as d,l as p,m as u,n as c,v as m}from"./element-plus-7d357588.js";import{G as _}from"./group-380776a5.js";import{l as h}from"./qs-942d6868.js";import{_ as g,u as f}from"./index-f792122d.js";import{ap as y,o as b,c as v,a as w,P as j,S as k,T as z,Q as C,a8 as x,Y as D,W as S,X as V,$ as F}from"./@vue-48c55b54.js";import"./@vueuse-c556fb5a.js";import"./lodash-es-c1acaa3d.js";import"./async-validator-cf877c1f.js";import"./@element-plus-e0f4a3e8.js";import"./dayjs-9faf8871.js";import"./call-bind-0c463fe3.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./side-channel-ba7aab8a.js";import"./object-inspect-860361a9.js";import"./vue-router-b8ff3004.js";import"./pinia-73166104.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./vue-ueditor-wrap-cd29f9a1.js";const{userInfo:N}=f(),{token:P}=f(),I={components:{},data:()=>({activeName:"all",loading:!0,tableData:[],pageSize:20,totalDataNumber:0,curPage:1,searchForm:{order_no:"",shop_supplier_id:"",create_time:""},supplierList:[],order_count:{all:0,payment:0,delivery:0,received:0,cancel:0,refund:0},user_type:"",token:P}),created(){this.getBaseInof(),this.getData()},methods:{async getBaseInof(){this.user_type=N.user_type,0!=this.user_type&&(this.activeName="complete")},arraySpanMethod(e){if(e.rowIndex%2==0&&0===e.columnIndex)return[1,8]},handleCurrentChange(e){this.curPage=e,this.getData()},handleSizeChange(e){this.curPage=1,this.pageSize=e,this.getData()},handleClick(e,a){this.curPage=1,this.getData()},getData(){let e=this,a=this.searchForm;a.dataType=e.activeName,a.page=e.curPage,a.list_rows=e.pageSize,e.loading=!0,_.orderList(a,!0).then((a=>{let t=[];for(let e=0;e<a.data.list.data.length;e++){let l=a.data.list.data[e],r={order_no:l.order_no,create_time:l.create_time,is_top_row:!0,order_status:l.order_status.value};t.push(r),t.push(l)}e.tableData.data=t,e.totalDataNumber=a.data.list.total,e.supplierList=a.data.supplierList,e.order_count=a.data.order_count.order_count,e.loading=!1})).catch((e=>{}))},addClick(e){let a=e.order_id;this.$router.push({path:"/plus/group/order/detail",query:{order_id:a}})},onSubmit(){this.curPage=1,this.tableData=[],this.getData()},onExport:function(){let e=window.location.protocol+"//"+window.location.host;this.searchForm.token=this.token,window.location.href=e+"/index.php/shop/plus.group.order/export?"+h.stringify(this.searchForm)}}},L={class:"user"},Y={class:"common-seach-wrap"},M={class:"block"},T=w("span",{class:"demonstration"},null,-1),U={class:"product-content"},q={class:"table-wrap"},B={key:0,class:"order-code"},E={class:"c_main"},$={class:"pl16"},A={class:"pic"},G={alt:""},Q={class:"info"},W={class:"name gray3 product-name"},X={class:"d-c-c d-c"},H={class:"orange"},J={class:"gray3"},K={key:0},O={class:"orange"},R={key:0},Z={class:"gray9"},ee={key:0},ae={key:0},te={class:"gray9"},le={key:0},re={class:"pagination"};const se=g(I,[["render",function(_,h,g,f,N,P){const I=e,se=a,oe=t,ie=l,ne=r,de=s,pe=o,ue=i,ce=n,me=d,_e=p,he=u,ge=c,fe=y("img-url"),ye=y("auth"),be=m;return b(),v("div",L,[w("div",Y,[j(pe,{size:"small",inline:!0,model:N.searchForm,class:"demo-form-inline"},{default:k((()=>[j(se,{label:"订单号"},{default:k((()=>[j(I,{size:"small",modelValue:N.searchForm.order_no,"onUpdate:modelValue":h[0]||(h[0]=e=>N.searchForm.order_no=e),placeholder:"请输入订单号"},null,8,["modelValue"])])),_:1}),0==N.user_type?(b(),z(se,{key:0,label:"使用门店"},{default:k((()=>[j(ie,{size:"small",modelValue:N.searchForm.shop_supplier_id,"onUpdate:modelValue":h[1]||(h[1]=e=>N.searchForm.shop_supplier_id=e),placeholder:"请选择"},{default:k((()=>[j(oe,{label:"全部",value:""}),(b(!0),v(C,null,x(N.supplierList,((e,a)=>(b(),z(oe,{key:a,label:e.name,value:e.shop_supplier_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):D("",!0),j(se,{label:"起始时间"},{default:k((()=>[w("div",M,[T,j(ne,{size:"small",modelValue:N.searchForm.create_time,"onUpdate:modelValue":h[2]||(h[2]=e=>N.searchForm.create_time=e),type:"daterange","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])])])),_:1}),j(se,null,{default:k((()=>[j(de,{size:"small",type:"primary",icon:"Search",onClick:P.onSubmit},{default:k((()=>[S("查询")])),_:1},8,["onClick"])])),_:1}),j(se,null,{default:k((()=>[j(de,{size:"small",type:"success",onClick:P.onExport},{default:k((()=>[S("导出")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])]),w("div",U,[w("div",q,[0==N.user_type?(b(),z(me,{key:0,modelValue:N.activeName,"onUpdate:modelValue":h[3]||(h[3]=e=>N.activeName=e),onTabChange:P.handleClick},{default:k((()=>[j(ce,{label:"全部订单",name:"all"},{label:k((()=>[w("span",null,[S(" 全部订单 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.all),1)])),_:1})])])),_:1}),j(ce,{label:"待付款",name:"payment"},{label:k((()=>[w("span",null,[S(" 待付款 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.payment),1)])),_:1})])])),_:1}),j(ce,{label:"待使用",name:"process"},{label:k((()=>[w("span",null,[S("待使用 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.process),1)])),_:1})])])),_:1}),j(ce,{label:"已取消",name:"cancel"},{label:k((()=>[w("span",null,[S("已取消 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.cancel),1)])),_:1})])])),_:1}),j(ce,{label:"已退款",name:"refund"},{label:k((()=>[w("span",null,[S("已退款 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.refund),1)])),_:1})])])),_:1}),j(ce,{label:"已完成",name:"complete"},{label:k((()=>[w("span",null,[S("已完成 "),j(ue,{size:"mini"},{default:k((()=>[S(V(N.order_count.complete),1)])),_:1})])])),_:1})])),_:1},8,["modelValue","onTabChange"])):D("",!0),F((b(),z(he,{size:"small",data:N.tableData.data,"span-method":P.arraySpanMethod,border:"",style:{width:"100%"}},{default:k((()=>[j(_e,{prop:"order_no",label:"订单信息",width:"400"},{default:k((e=>[e.row.is_top_row?(b(),v("div",B,[w("span",E,"订单号："+V(e.row.order_no),1),w("span",$,"下单时间："+V(e.row.create_time),1)])):(b(!0),v(C,{key:1},x(e.row.product,((e,a)=>(b(),v("div",{class:"product-info",key:a},[w("div",A,[F(w("img",G,null,512),[[fe,e.image.file_path]])]),w("div",Q,[w("div",W,[w("span",null,V(e.group_name),1)])]),w("div",X,[w("div",H,"￥ "+V(e.group_price),1),w("div",J,"x"+V(e.total_num),1)])])))),128))])),_:1}),j(_e,{prop:"pay_price",label:"实付款"},{default:k((e=>[e.row.is_top_row?D("",!0):(b(),v("div",K,[w("div",O,V(e.row.pay_price),1)]))])),_:1}),j(_e,{prop:"",label:"买家"},{default:k((e=>[!e.row.is_top_row&&e.row.user?(b(),v("div",R,[w("div",null,V(e.row.user.nickName),1),w("div",Z,"ID：("+V(e.row.user.user_id)+")",1)])):D("",!0)])),_:1}),j(_e,{prop:"supplier.name",label:"使用门店"}),j(_e,{prop:"state_text",label:"交易状态"},{default:k((e=>[e.row.is_top_row?D("",!0):(b(),v("div",ee,V(e.row.state_text),1))])),_:1}),j(_e,{prop:"pay_type.text",label:"支付方式"},{default:k((e=>[e.row.is_top_row?D("",!0):(b(),v("div",ae,[w("span",te,V(e.row.pay_type.text),1)]))])),_:1}),j(_e,{fixed:"right",label:"操作",width:"160"},{default:k((e=>[e.row.is_top_row?D("",!0):(b(),v("div",le,[F((b(),z(de,{onClick:a=>P.addClick(e.row),type:"text",size:"small"},{default:k((()=>[S("订单详情 ")])),_:2},1032,["onClick"])),[[ye,"/store/order/detail"]])]))])),_:1})])),_:1},8,["data","span-method"])),[[be,N.loading]])]),w("div",re,[j(ge,{onSizeChange:P.handleSizeChange,onCurrentChange:P.handleCurrentChange,background:"","current-page":N.curPage,"page-size":N.pageSize,layout:"total, prev, pager, next, jumper",total:N.totalDataNumber},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])])])}]]);export{se as default};
