import{n as e,h as t,d as s,i as a,R as r,m as l,o,p as n,q as u}from"./element-plus-33e0d8cc.js";import{_ as i}from"./_plugin-vue_export-helper-1b428a4d.js";import{o as m,c as d,P as p,S as c,T as h,W as _,X as f,Y as k,a as g,Q as y,a8 as w,ag as b}from"./@vue-e72ffbb6.js";import{l as z}from"./index-2a70ce31.js";import"./@vueuse-0fb12a45.js";import"./lodash-es-cce4393d.js";import"./async-validator-cf877c1f.js";import"./@element-plus-4b00147d.js";import"./dayjs-34225b3b.js";import"./call-bind-2971450c.js";import"./get-intrinsic-d8eb8ca0.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-afbcd6f2.js";import"./has-719bcddc.js";import"./escape-html-1935ddb3.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-bf98ca95.js";import"./pinia-72b16af9.js";import"./vue-demi-71ba0ef2.js";import"./axios-85bcd05e.js";import"./qs-a8eee860.js";import"./side-channel-052d4c61.js";import"./object-inspect-dd55f836.js";import"./pinia-plugin-persistedstate-35ef556e.js";import"./vue-ueditor-wrap-e5a15ab3.js";import"./vue-i18n-73a1cd16.js";import"./@intlify-28c65249.js";const v=i({inject:["form"]},[["render",function(s,a,r,l,o,n){const u=e,i=t;return m(),d("div",null,[p(i,{label:s.$t("商品价格："),width:"80",rules:[{required:!0,message:s.$t("请填写商品价格")}],prop:"model.sku[0].product_price"},{default:c((()=>[p(u,{min:0,max:1e6,controls:!1,modelValue:n.form.model.sku[0].product_price,"onUpdate:modelValue":a[0]||(a[0]=e=>n.form.model.sku[0].product_price=e),placeholder:s.$t("请填写商品价格"),class:"max-w460"},null,8,["modelValue","placeholder"])])),_:1},8,["label","rules"]),p(i,{label:s.$t("库存数量："),rules:[{required:!0,message:s.$t("请填写库存数量")}],prop:"model.sku[0].stock_num"},{default:c((()=>[p(u,{min:0,max:999,controls:!1,placeholder:s.$t("请填写库存数量"),modelValue:n.form.model.sku[0].stock_num,"onUpdate:modelValue":a[1]||(a[1]=e=>n.form.model.sku[0].stock_num=e),class:"max-w460"},null,8,["placeholder","modelValue"])])),_:1},8,["label","rules"])])}],["__scopeId","data-v-4efb9e93"]]),j=JSON.stringify(z().languageData);const $=i({data:()=>({showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}),inject:["form"],created(){},methods:{onToggleAddGroupForm:function(){let e=this;Array.isArray(e.form.model.sku)||(e.form.model.sku=[]),e.form.model.sku.push({spec_name:JSON.parse(j),product_price:"",bag_price:"",stock_num:"",cost_price:0,is_full:0})},onDeleteGroup:function(e){var t=this;s.confirm("删除后不可恢复，确认删除吗?","提示",{type:"warning"}).then((()=>{t.form.model.spec_many.spec_attr.splice(e,1),t.buildSkulist()}))},onDeleteValue:function(e,t){let a=this;a.form.isSpecLocked?this.$ElMessage({message:"本商品正在参加活动，不能删除规格！",type:"warning"}):s.confirm("删除后不可恢复，确认删除吗?","提示",{type:"warning"}).then((()=>{a.form.model.spec_many.spec_attr[e].spec_items.splice(t,1),a.buildSkulist()}))}}},[["render",function(e,t,s,r,l,o){const n=a;return o.form.isSpecLocked?k("",!0):(m(),h(n,{key:0,size:"small",type:"primary",class:"el-icon-circle-plus",onClick:o.onToggleAddGroupForm},{default:c((()=>[_(f(e.$t("添加规格"))+"+",1)])),_:1},8,["onClick"]))}],["__scopeId","data-v-ea6ec527"]]),S=z().languageList,x={class:"mt16"},V={class:"ww100"},L={label:"",class:"spec-name",style:{"margin-bottom":"0"}};const O=i({components:{Type:$,Table:i({components:{},data:()=>({languageList:S,restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],batchData:{product_price:"",line_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}),inject:["form"],created(){this.form.spec.map(((e,t)=>{this.restaurants_zh.push({value:JSON.parse(e.spec_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.spec_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.spec_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.spec_name).th,index:t})}))},mounted(){},methods:{deleteAttr(e){this.form.model.sku.length>1&&this.form.model.sku.splice(e,1)},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e,t){this.form.model.sku[t].spec_name.zh=this.restaurants_zh[e.index].value,this.form.model.sku[t].spec_name.th=this.restaurants_th[e.index].value,this.form.model.sku[t].spec_name.en=this.restaurants_en[e.index].value,this.form.model.sku[t].spec_name.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(s,n,u,i,b,z){const v=r,j=t,$=l,S=e,O=a,C=o;return m(),d("div",x,[z.form.model.sku.length>0?(m(),h(j,{key:0,label:s.$t("规格明细：")},{default:c((()=>[g("div",V,[p(C,{size:"",data:z.form.model.sku,border:"",style:{width:"100%","margin-top":"20px"}},{default:c((()=>[p($,{label:s.$t("规格名称"),width:"400"},{default:c((e=>[g("div",L,[(m(!0),d(y,null,w(b.languageList,((t,a)=>(m(),h(j,{key:a,prop:`scope.row.spec_name[${t.key}]`,rules:[{validator:()=>!!e.row.spec_name[t.key],message:s.$t("请输入规格名称")}]},{default:c((()=>[p(v,{size:"small",onSelect:t=>z.selectChange(t,e.$index),"fetch-suggestions":(e,s)=>z.querySearch(e,s,t.key),modelValue:e.row.spec_name[t.key],"onUpdate:modelValue":s=>e.row.spec_name[t.key]=s,placeholder:s.$t("请输入")+`(${t.label})`},null,8,["onSelect","fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])))),128))])])),_:1},8,["label"]),p($,{label:s.$t("价格")},{default:c((e=>[p(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.product_price",rules:[{validator:()=>"number"==typeof e.row.product_price&&e.row.product_price>=0,message:s.$t("请输入价格")}]},{default:c((()=>[p(S,{type:"number",placeholder:s.$t("请输入价格"),size:"small",min:0,max:1e6,controls:!1,modelValue:e.row.product_price,"onUpdate:modelValue":t=>e.row.product_price=t},null,8,["placeholder","modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),p($,{label:s.$t("库存")},{default:c((e=>[p(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.stock_num",rules:[{validator:()=>"number"==typeof e.row.stock_num&&e.row.stock_num>=0,message:s.$t("请输入库存")}]},{default:c((()=>[p(S,{type:"number",placeholder:s.$t("请输入库存"),size:"small",min:0,max:999,controls:!1,modelValue:e.row.stock_num,"onUpdate:modelValue":t=>e.row.stock_num=t},null,8,["placeholder","modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),p($,{label:""},{default:c((e=>[p(j,{label:"",style:{"margin-bottom":"0"}},{default:c((()=>[p(O,{type:"primary",link:"",onClick:t=>z.deleteAttr(e.$index)},{default:c((()=>[_(f(s.$t("删除")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])])),_:1},8,["label"])):k("",!0)])}],["__scopeId","data-v-be3edf7f"]])}},[["render",function(e,t,s,a,r,l){const o=b("Type"),n=b("Table");return m(),d("div",null,[p(o),p(n)])}]]),C=z().languageList,N={class:"common-form mt50"},J={key:0,class:"red"};const U=i({components:{Single:v,Many:O},data:()=>({restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],languageList:C}),inject:["form"],watch:{form:{handler(e){this.restaurants_zh=[],this.restaurants_zhtw=[],this.restaurants_en=[],this.restaurants_th=[],e.unit.map(((e,t)=>{JSON.parse(e.unit_name).zh&&JSON.parse(e.unit_name).zhtw&&JSON.parse(e.unit_name).en&&JSON.parse(e.unit_name).th&&(this.restaurants_zh.push({value:JSON.parse(e.unit_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.unit_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.unit_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.unit_name).th,index:t}))}))},deep:!0,immediate:!0}},methods:{changeSpec(e){10==e?this.form.sku={product_price:"",stock_num:"",bag_price:0,cost_price:0,is_full:0}:20==e&&(this.form.sku=[])},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e){this.form.model.product_unit.zh=this.restaurants_zh[e.index].value,this.form.model.product_unit.th=this.restaurants_th[e.index].value,this.form.model.product_unit.en=this.restaurants_en[e.index].value,this.form.model.product_unit.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(e,s,a,l,o,i){const z=n,v=u,j=t,$=r,S=b("Single"),x=b("Many");return m(),d("div",null,[g("div",N,f(e.$t("规格/库存")),1),p(j,{label:e.$t("库存计算方式：")},{default:c((()=>[p(v,{modelValue:i.form.model.deduct_stock_type,"onUpdate:modelValue":s[0]||(s[0]=e=>i.form.model.deduct_stock_type=e)},{default:c((()=>[p(z,{label:10},{default:c((()=>[_(f(e.$t("下单减库存")),1)])),_:1}),p(z,{label:20},{default:c((()=>[_(f(e.$t("付款减库存")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(m(!0),d(y,null,w(o.languageList,((t,a)=>(m(),h(j,{key:a,label:0==a?e.$t("商品单位："):"",rules:[{required:!0,message:e.$t("请填写商品单位")}],prop:`model.product_unit.${t.key}`},{default:c((()=>[p($,{"fetch-suggestions":(e,s)=>i.querySearch(e,s,t.key),onSelect:s[1]||(s[1]=e=>i.selectChange(e)),class:"inline-input",modelValue:i.form.model.product_unit[t.key],"onUpdate:modelValue":e=>i.form.model.product_unit[t.key]=e,placeholder:e.$t("请输入")+`(${t.label})`},null,8,["fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label","rules","prop"])))),128)),p(j,{label:e.$t("商品规格：")},{default:c((()=>[p(v,{modelValue:i.form.model.spec_type,"onUpdate:modelValue":s[2]||(s[2]=e=>i.form.model.spec_type=e),onChange:i.changeSpec},{default:c((()=>[!i.form.isSpecLocked||i.form.isSpecLocked&&10==i.form.model.spec_type?(m(),h(z,{key:0,label:10},{default:c((()=>[_(f(e.$t("单规格")),1)])),_:1})):k("",!0),!i.form.isSpecLocked||i.form.isSpecLocked&&20==i.form.model.spec_type?(m(),h(z,{key:1,label:20},{default:c((()=>[_(f(e.$t("多规格")),1)])),_:1})):k("",!0)])),_:1},8,["modelValue","onChange"]),i.form.isSpecLocked?(m(),d("div",J,f(e.$t("此商品正在参加活动，不能修改规格")),1)):k("",!0)])),_:1},8,["label"]),10==i.form.model.spec_type?(m(),h(S,{key:0})):k("",!0),20==i.form.model.spec_type?(m(),h(x,{key:1})):k("",!0)])}],["__scopeId","data-v-f7ec1083"]]);export{U as default};
