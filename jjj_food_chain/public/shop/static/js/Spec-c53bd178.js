import{n as e,h as t,d as s,i as a,R as r,m as o,o as l,w as n,x as u}from"./element-plus-c8084613.js";import{_ as i}from"./_plugin-vue_export-helper-1b428a4d.js";import{o as m,c as p,O as d,R as c,S as h,V as _,W as f,X as g,a as k,P as y,a7 as w,af as b}from"./@vue-b57a05a6.js";import{l as z}from"./index-1fc657e8.js";import"./lodash-es-234e1c00.js";import"./async-validator-cf877c1f.js";import"./@vueuse-793cab0b.js";import"./@element-plus-ce7ae957.js";import"./dayjs-33a066dd.js";import"./call-bind-912d4e9d.js";import"./get-intrinsic-878e88ff.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-afbcd6f2.js";import"./hasown-c3b72c9b.js";import"./set-function-length-a0a50b12.js";import"./define-data-property-da2cc9a9.js";import"./has-property-descriptors-2aeb73fe.js";import"./gopd-15a2da42.js";import"./@popperjs-b78c3215.js";import"./normalize-wheel-es-3222b0a2.js";import"./@ctrl-91de2ec7.js";import"./vue-router-24c2a4a1.js";import"./pinia-6eed225f.js";import"./axios-b48e0a85.js";import"./qs-49804a56.js";import"./side-channel-7f79a019.js";import"./object-inspect-9ade9731.js";import"./pinia-plugin-persistedstate-35ef556e.js";import"./vue-ueditor-wrap-5c153e91.js";import"./vue-i18n-8b8412df.js";import"./@intlify-658c8624.js";const v=i({inject:["form"]},[["render",function(s,a,r,o,l,n){const u=e,i=t;return m(),p("div",null,[d(i,{label:s.$t("商品价格："),width:"80",rules:[{required:!0,message:s.$t("请填写商品价格")}],prop:"model.sku[0].product_price"},{default:c((()=>[d(u,{min:0,max:1e6,controls:!1,modelValue:n.form.model.sku[0].product_price,"onUpdate:modelValue":a[0]||(a[0]=e=>n.form.model.sku[0].product_price=e),placeholder:s.$t("请填写商品价格"),class:"max-w460"},null,8,["modelValue","placeholder"])])),_:1},8,["label","rules"]),d(i,{label:s.$t("库存数量："),rules:[{required:!0,message:s.$t("请填写库存数量")}],prop:"model.sku[0].stock_num"},{default:c((()=>[d(u,{min:0,max:999,controls:!1,placeholder:s.$t("请填写库存数量"),modelValue:n.form.model.sku[0].stock_num,"onUpdate:modelValue":a[1]||(a[1]=e=>n.form.model.sku[0].stock_num=e),class:"max-w460"},null,8,["placeholder","modelValue"])])),_:1},8,["label","rules"])])}],["__scopeId","data-v-4efb9e93"]]),j=JSON.stringify(z().languageData);const S=i({data:()=>({showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}),inject:["form"],created(){},methods:{onToggleAddGroupForm:function(){let e=this;Array.isArray(e.form.model.sku)||(e.form.model.sku=[]),e.form.model.sku.push({spec_name:JSON.parse(j),product_price:"",bag_price:"",stock_num:"",cost_price:0,is_full:0})},onDeleteGroup:function(e){var t=this;s.confirm("删除后不可恢复，确认删除吗?","提示",{type:"warning"}).then((()=>{t.form.model.spec_many.spec_attr.splice(e,1),t.buildSkulist()}))},onDeleteValue:function(e,t){let a=this;a.form.isSpecLocked?this.$ElMessage({message:"本商品正在参加活动，不能删除规格！",type:"warning"}):s.confirm("删除后不可恢复，确认删除吗?","提示",{type:"warning"}).then((()=>{a.form.model.spec_many.spec_attr[e].spec_items.splice(t,1),a.buildSkulist()}))}}},[["render",function(e,t,s,r,o,l){const n=a;return l.form.isSpecLocked?g("",!0):(m(),h(n,{key:0,size:"small",type:"primary",class:"el-icon-circle-plus",onClick:l.onToggleAddGroupForm},{default:c((()=>[_(f(e.$t("添加规格"))+"+",1)])),_:1},8,["onClick"]))}],["__scopeId","data-v-ea6ec527"]]),x=z().languageList,$={class:"mt16"},V={class:"ww100"},L={label:"",class:"spec-name",style:{"margin-bottom":"0"}};const O=i({components:{Type:S,Table:i({components:{},data:()=>({languageList:x,restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],batchData:{product_price:"",line_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}),inject:["form"],created(){this.form.spec.map(((e,t)=>{this.restaurants_zh.push({value:JSON.parse(e.spec_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.spec_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.spec_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.spec_name).th,index:t})}))},mounted(){},methods:{deleteAttr(e){this.form.model.sku.length>1&&this.form.model.sku.splice(e,1)},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e,t){this.form.model.sku[t].spec_name.zh=this.restaurants_zh[e.index].value,this.form.model.sku[t].spec_name.th=this.restaurants_th[e.index].value,this.form.model.sku[t].spec_name.en=this.restaurants_en[e.index].value,this.form.model.sku[t].spec_name.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(s,n,u,i,b,z){const v=r,j=t,S=o,x=e,O=a,C=l;return m(),p("div",$,[z.form.model.sku.length>0?(m(),h(j,{key:0,label:s.$t("规格明细：")},{default:c((()=>[k("div",V,[d(C,{size:"",data:z.form.model.sku,border:"",style:{width:"100%","margin-top":"20px"}},{default:c((()=>[d(S,{label:s.$t("规格名称"),width:"400"},{default:c((e=>[k("div",L,[(m(!0),p(y,null,w(b.languageList,((t,a)=>(m(),h(j,{key:a,prop:"scope.row.spec_name[".concat(t.key,"]"),rules:[{validator:()=>!!e.row.spec_name[t.key],message:s.$t("请输入规格名称")}]},{default:c((()=>[d(v,{size:"small",onSelect:t=>z.selectChange(t,e.$index),"fetch-suggestions":(e,s)=>z.querySearch(e,s,t.key),modelValue:e.row.spec_name[t.key],"onUpdate:modelValue":s=>e.row.spec_name[t.key]=s,placeholder:s.$t("请输入")+"(".concat(t.label,")")},null,8,["onSelect","fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])))),128))])])),_:1},8,["label"]),d(S,{label:s.$t("价格")},{default:c((e=>[d(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.product_price",rules:[{validator:()=>"number"==typeof e.row.product_price&&e.row.product_price>=0,message:s.$t("请输入价格")}]},{default:c((()=>[d(x,{type:"number",placeholder:s.$t("请输入价格"),size:"small",min:0,max:1e6,controls:!1,modelValue:e.row.product_price,"onUpdate:modelValue":t=>e.row.product_price=t},null,8,["placeholder","modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),d(S,{label:s.$t("库存")},{default:c((e=>[d(j,{label:"",style:{"margin-bottom":"0"},prop:"scope.row.stock_num",rules:[{validator:()=>"number"==typeof e.row.stock_num&&e.row.stock_num>=0,message:s.$t("请输入库存")}]},{default:c((()=>[d(x,{type:"number",placeholder:s.$t("请输入库存"),size:"small",min:0,max:999,controls:!1,modelValue:e.row.stock_num,"onUpdate:modelValue":t=>e.row.stock_num=t},null,8,["placeholder","modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])])),_:1},8,["label"]),d(S,{label:""},{default:c((e=>[d(j,{label:"",style:{"margin-bottom":"0"}},{default:c((()=>[d(O,{type:"primary",link:"",onClick:t=>z.deleteAttr(e.$index)},{default:c((()=>[_(f(s.$t("删除")),1)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])])])),_:1},8,["label"])):g("",!0)])}],["__scopeId","data-v-be3edf7f"]])}},[["render",function(e,t,s,a,r,o){const l=b("Type"),n=b("Table");return m(),p("div",null,[d(l),d(n)])}]]),C=z().languageList,J={class:"common-form mt50"},N={key:0,class:"red"};const U=i({components:{Single:v,Many:O},data:()=>({restaurants:[],restaurants_zh:[],restaurants_zhtw:[],restaurants_en:[],restaurants_th:[],languageList:C}),inject:["form"],watch:{form:{handler(e){this.restaurants_zh=[],this.restaurants_zhtw=[],this.restaurants_en=[],this.restaurants_th=[],e.unit.map(((e,t)=>{JSON.parse(e.unit_name).zh&&JSON.parse(e.unit_name).zhtw&&JSON.parse(e.unit_name).en&&JSON.parse(e.unit_name).th&&(this.restaurants_zh.push({value:JSON.parse(e.unit_name).zh,index:t}),this.restaurants_zhtw.push({value:JSON.parse(e.unit_name).zhtw,index:t}),this.restaurants_en.push({value:JSON.parse(e.unit_name).en,index:t}),this.restaurants_th.push({value:JSON.parse(e.unit_name).th,index:t}))}))},deep:!0,immediate:!0}},methods:{changeSpec(e){10==e?this.form.sku={product_price:"",stock_num:"",bag_price:0,cost_price:0,is_full:0}:20==e&&(this.form.sku=[])},querySearch(e,t,s){let a=[];"th"==s&&(a=this.restaurants_th),"zh"==s&&(a=this.restaurants_zh),"zhtw"==s&&(a=this.restaurants_zhtw),"en"==s&&(a=this.restaurants_en),t(e?a.filter(this.createFilter(e,s)):a)},createFilter(e,t){return"th"==t&&this.restaurants_th,"zh"==t&&this.restaurants_zh,"zhtw"==t&&this.restaurants_zhtw,"en"==t&&this.restaurants_en,t=>0===t.value.toLowerCase().indexOf(e.toLowerCase())},selectChange(e){this.form.model.product_unit.zh=this.restaurants_zh[e.index].value,this.form.model.product_unit.th=this.restaurants_th[e.index].value,this.form.model.product_unit.en=this.restaurants_en[e.index].value,this.form.model.product_unit.zhtw=this.restaurants_zhtw[e.index].value}}},[["render",function(e,s,a,o,l,i){const z=n,v=u,j=t,S=r,x=b("Single"),$=b("Many");return m(),p("div",null,[k("div",J,f(e.$t("规格/库存")),1),d(j,{label:e.$t("库存计算方式：")},{default:c((()=>[d(v,{modelValue:i.form.model.deduct_stock_type,"onUpdate:modelValue":s[0]||(s[0]=e=>i.form.model.deduct_stock_type=e)},{default:c((()=>[d(z,{label:10},{default:c((()=>[_(f(e.$t("下单减库存")),1)])),_:1}),d(z,{label:20},{default:c((()=>[_(f(e.$t("付款减库存")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["label"]),(m(!0),p(y,null,w(l.languageList,((t,a)=>(m(),h(j,{key:a,label:0==a?e.$t("商品单位："):"",rules:[{required:!0,message:e.$t("请填写商品单位")}],prop:"model.product_unit.".concat(t.key)},{default:c((()=>[d(S,{"fetch-suggestions":(e,s)=>i.querySearch(e,s,t.key),onSelect:s[1]||(s[1]=e=>i.selectChange(e)),class:"inline-input",modelValue:i.form.model.product_unit[t.key],"onUpdate:modelValue":e=>i.form.model.product_unit[t.key]=e,placeholder:e.$t("请输入")+"(".concat(t.label,")")},null,8,["fetch-suggestions","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["label","rules","prop"])))),128)),d(j,{label:e.$t("商品规格：")},{default:c((()=>[d(v,{modelValue:i.form.model.spec_type,"onUpdate:modelValue":s[2]||(s[2]=e=>i.form.model.spec_type=e),onChange:i.changeSpec},{default:c((()=>[!i.form.isSpecLocked||i.form.isSpecLocked&&10==i.form.model.spec_type?(m(),h(z,{key:0,label:10},{default:c((()=>[_(f(e.$t("单规格")),1)])),_:1})):g("",!0),!i.form.isSpecLocked||i.form.isSpecLocked&&20==i.form.model.spec_type?(m(),h(z,{key:1,label:20},{default:c((()=>[_(f(e.$t("多规格")),1)])),_:1})):g("",!0)])),_:1},8,["modelValue","onChange"]),i.form.isSpecLocked?(m(),p("div",N,f(e.$t("此商品正在参加活动，不能修改规格")),1)):g("",!0)])),_:1},8,["label"]),10==i.form.model.spec_type?(m(),h(x,{key:0})):g("",!0),20==i.form.model.spec_type?(m(),h($,{key:1})):g("",!0)])}],["__scopeId","data-v-f7ec1083"]]);export{U as default};
