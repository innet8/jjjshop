System.register(["./element-plus-legacy-ce5c473b.js","./product-legacy-6739a9ee.js","./@vue-legacy-8ef99c9b.js","./_plugin-vue_export-helper-legacy-61c4c9d1.js","./Upload-legacy-819b6ef1.js","./index-legacy-1b02d25e.js","./lodash-es-legacy-de50a096.js","./async-validator-legacy-aa1fd2de.js","./@vueuse-legacy-3353583a.js","./@element-plus-legacy-91437698.js","./dayjs-legacy-0ff6bb75.js","./call-bind-legacy-8954b3d2.js","./get-intrinsic-legacy-c0201930.js","./has-symbols-legacy-afcc0593.js","./has-proto-legacy-d280ab1e.js","./function-bind-legacy-a8d405fe.js","./hasown-legacy-8325a62b.js","./set-function-length-legacy-e4fe6823.js","./define-data-property-legacy-290282d7.js","./has-property-descriptors-legacy-1e05bb01.js","./gopd-legacy-0da6a62b.js","./@popperjs-legacy-876caf52.js","./normalize-wheel-es-legacy-13d39621.js","./@ctrl-legacy-33dbca08.js","./file-legacy-db10563c.js","./vue-cropperjs-legacy-7166d149.js","./vue-legacy-ae59173d.js","./cropperjs-legacy-9cfc33ae.js","./vue-router-legacy-a8f66a40.js","./pinia-legacy-e8a51700.js","./axios-legacy-dedee0c6.js","./qs-legacy-334feae6.js","./side-channel-legacy-19dc2798.js","./object-inspect-legacy-a5678b81.js","./pinia-plugin-persistedstate-legacy-01cca48d.js","./vue-ueditor-wrap-legacy-d36ae666.js","./vue-i18n-legacy-a195b753.js","./@intlify-legacy-7f6e5bc9.js"],(function(e,l){"use strict";var t,a,n,o,s,r,u,c,i,p,d,m,f,_,g,h,y,b,v,w,V,x,j,k,G,F,D;return{setters:[function(e){t=e.d,a=e.F,n=e.g,o=e.i,s=e.m,r=e.h,u=e.o},function(e){c=e.P},function(e){i=e.o,p=e.c,d=e.a,m=e.P,f=e.a7,_=e.W,g=e.O,h=e.R,y=e.V,b=e._,v=e.$,w=e.X,V=e.bm,x=e.bk,j=e.an,k=e.S,G=e.af},function(e){F=e._},function(e){D=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".spec-many-type[data-v-e69b65f3]{margin-left:180px;margin-top:16px;padding:20px;border:1px solid #e5ecf4;background:#f6f9fc}.spec-wrap .spec-hd[data-v-e69b65f3]{padding:10px;display:flex;justify-content:space-between;align-items:center;background:#fff;font-weight:700}.spec-wrap .spec-hd .el-icon-delete-solid[data-v-e69b65f3]{font-size:16px;color:#999}.spec-wrap .min-spc[data-v-e69b65f3]{border:1px solid #dfecf8}.spec-wrap .spec-bd[data-v-e69b65f3]{padding:5px;display:flex;justify-content:flex-start;flex-wrap:wrap;border-top:1px solid #dfecf8;background:#ffffff}.spec-wrap .spec-bd .el-tag[data-v-e69b65f3]{color:#333}.spec-wrap .spec-bd .item[data-v-e69b65f3]{position:relative;padding:5px}.spec-wrap .spec-bd .item input[data-v-e69b65f3]{padding-right:30px}.spec-wrap .spec-hd a[data-v-e69b65f3],.spec-wrap .spec-hd .svg-icon[data-v-e69b65f3],.spec-wrap .spec-bd .item .svg-icon[data-v-e69b65f3]{display:block;width:16px;height:16px}.spec-wrap .spec-bd .item a[data-v-e69b65f3]{position:absolute;top:6px;right:5px;width:30px;height:30px;display:flex;justify-content:center;align-items:center}.add-spec .from-box[data-v-e69b65f3]{display:flex;justify-content:flex-start}.add-spec .item[data-v-e69b65f3]{display:flex;justify-content:flex-start;align-items:center;width:200px;margin-right:20px}.add-spec .item .key[data-v-e69b65f3]{display:block;white-space:nowrap}\n",document.head.appendChild(l);var S={data:function(){return{showAddGroupBtn:!0,showAddGroupForm:!1,addGroupFrom:{specName:"",specValue:""},groupLoading:!1}},inject:["form"],created:function(){this.form.model.spec_many&&this.form.model.spec_many.spec_list.length>0&&this.buildSkulist()},methods:{onToggleAddGroupForm:function(){this.showAddGroupBtn=!this.showAddGroupBtn,this.showAddGroupForm=!this.showAddGroupForm},onSubmitAddGroup:function(){var e=this;if(""===e.addGroupFrom.specName||""===e.addGroupFrom.specValue)return this.$ElMessage("请填写规则名或规则值"),!1;e.groupLoading=!0;var l={spec_name:e.addGroupFrom.specName,spec_value:e.addGroupFrom.specValue};c.addSpec(l,!0).then((function(l){e.groupLoading=!1,e.form.model.spec_many.spec_attr.push({group_id:l.data.spec_id,group_name:e.addGroupFrom.specName,spec_items:[{item_id:l.data.spec_value_id,spec_value:e.addGroupFrom.specValue}],tempValue:"",loading:!1}),e.addGroupFrom.specName="",e.addGroupFrom.specValue="",e.onToggleAddGroupForm(),e.buildSkulist()})).catch((function(l){e.groupLoading=!1}))},onSubmitAddValue:function(e){var l=this;if(!e.hasOwnProperty("tempValue")||""===e.tempValue)return this.$ElMessage("规格值不能为空"),!1;e.loading=!0;var t={spec_id:e.group_id,spec_value:e.tempValue};c.addSpecValue(t,!0).then((function(t){e.loading=!1,e.spec_items.push({item_id:t.data.spec_value_id,spec_value:e.tempValue}),e.tempValue="",l.buildSkulist()})).catch((function(l){e.loading=!1}))},buildSkulist:function(){for(var e=this,l=e.form.model.spec_many.spec_attr,t=[],a=0;a<l.length;a++)t.push(l[a].spec_items);for(var n=e.calcDescartes(t),o=[],s=0;s<n.length;s++){var r=[],u=[];Array.isArray(n[s])?r=n[s]:r.push(n[s]);for(var c=0;c<r.length;c++)u.push(r[c].item_id);o.push({product_sku_id:0,spec_sku_id:u.join("_"),rows:r,spec_form:{}})}if(e.form.model.spec_many.spec_list.length>0&&o.length>0)for(var i=function(l){var t=e.form.model.spec_many.spec_list.filter((function(e){return e.spec_sku_id===o[l].spec_sku_id}));t.length>0&&(o[l].spec_form=t[0].spec_form,o[l].product_sku_id=t[0].product_sku_id)},p=0;p<o.length;p++)i(p);e.form.model.spec_many.spec_list=o},calcDescartes:function(e){return e.length<2?e[0]||[]:[].reduce.call(e,(function(e,l){var t=[];return e.forEach((function(e){l.forEach((function(l){var a=[].concat(Array.isArray(e)?e:[e]);a.push(l),t.push(a)}))})),t}))},onDeleteGroup:function(e){var l=this;t.confirm("删除后不可恢复，确认删除吗？","提示",{type:"warning"}).then((function(){l.form.model.spec_many.spec_attr.splice(e,1),l.buildSkulist()}))},onDeleteValue:function(e,l){var a=this;a.form.isSpecLocked?this.$ElMessage({message:"本商品正在参加活动，不能删除规格！",type:"warning"}):t.confirm("删除后不可恢复，确认删除吗？","提示",{type:"warning"}).then((function(){a.form.model.spec_many.spec_attr[e].spec_items.splice(l,1),a.buildSkulist()}))}}},z=function(e){return V("data-v-e69b65f3"),e=e(),x(),e},A={class:"spec-many-type"},C={class:"spec-wrap"},U={class:"spec-hd"},I={class:"input-box"},B=["onClick"],E=[z((function(){return d("i",{class:"Delete"},null,-1)}))],T={class:"spec-bd"},$={class:"item"},L={class:"item"},N={key:0},q={class:"add-spec mb16"},M={class:"from-box"},P={class:"item"},O=z((function(){return d("span",{class:"key"},"规格名：",-1)})),R={class:"item"},J=z((function(){return d("span",{class:"key"},"规格值：",-1)})),W={class:"mt16"},X=["onClick"];e("default",F({components:{Type:F(S,[["render",function(e,l,t,s,r,u){var c=a,V=n,x=o;return i(),p("div",A,[d("div",C,[(i(!0),p(m,null,f(u.form.model.spec_many.spec_attr,(function(e,l){return i(),p("div",{class:"mb16 min-spc",key:e.group_name},[d("div",U,[d("div",I,_(e.group_name),1),d("a",{href:"javascript:void(0);",onClick:function(e){return u.onDeleteGroup(l)}},E,8,B)]),d("div",T,[(i(!0),p(m,null,f(e.spec_items,(function(e,t){return i(),p("div",{class:"item",key:e.spec_value},[g(c,{closable:"",onClose:function(e){return u.onDeleteValue(l,t)}},{default:h((function(){return[y(_(e.spec_value),1)]})),_:2},1032,["onClose"])])})),128)),d("div",$,[g(V,{size:"small",modelValue:e.tempValue,"onUpdate:modelValue":function(l){return e.tempValue=l},style:{width:"160px"}},null,8,["modelValue","onUpdate:modelValue"])]),d("div",L,[g(x,{size:"small",onClick:function(l){return u.onSubmitAddValue(e)},loading:e.loading},{default:h((function(){return[y("添加")]})),_:2},1032,["onClick","loading"])])])])})),128)),u.form.isSpecLocked?w("",!0):(i(),p("div",N,[b(g(x,{size:"small",class:"CirclePlus",onClick:u.onToggleAddGroupForm},{default:h((function(){return[y("添加规格")]})),_:1},8,["onClick"]),[[v,r.showAddGroupBtn]])])),b(d("div",q,[d("div",M,[d("div",P,[O,g(V,{size:"small",modelValue:r.addGroupFrom.specName,"onUpdate:modelValue":l[0]||(l[0]=function(e){return r.addGroupFrom.specName=e}),placeholder:"请输入规格名称"},null,8,["modelValue"])]),d("div",R,[J,g(V,{size:"small",modelValue:r.addGroupFrom.specValue,"onUpdate:modelValue":l[1]||(l[1]=function(e){return r.addGroupFrom.specValue=e}),placeholder:"请输入规格值"},null,8,["modelValue"])]),g(x,{type:"primary",size:"small",loading:r.groupLoading,onClick:u.onSubmitAddGroup,plain:""},{default:h((function(){return[y("确定")]})),_:1},8,["loading","onClick"]),g(x,{size:"small",onClick:u.onToggleAddGroupForm},{default:h((function(){return[y("取消")]})),_:1},8,["onClick"])])],512),[[v,!r.showAddGroupBtn]])])])}],["__scopeId","data-v-e69b65f3"]]),Table:F({components:{Upload:D},data:function(){return{batchData:{product_price:"",line_price:"",stock_num:"",product_weight:""},isupload:!1,spec_index:-1}},inject:["form"],created:function(){},methods:{objectSpanMethod:function(e){e.row,e.column;var l=e.rowIndex,t=e.columnIndex,a=this.form.model.spec_many.spec_attr,n=1;if(t<a.length-1){for(var o=t+1,s=a.length-1,r=o;r<=s;r++)n*=a[r].spec_items.length;return l%n==0?{rowspan:n,colspan:1}:{rowspan:0,colspan:0}}},onSubmitBatchData:function(){var e=this;e.form.model.spec_many.spec_list.forEach((function(l){for(var t in e.batchData)e.batchData.hasOwnProperty(t)&&e.batchData[t]&&(l.spec_form[t]=e.batchData[t])}))},chooseSpecImage:function(e){this.isupload=!0,this.spec_index=e},returnImgsFunc:function(e){this.isupload=!1,this.form.model.spec_many.spec_list[this.spec_index].spec_form.image_id=e[0].file_id,this.form.model.spec_many.spec_list[this.spec_index].spec_form.image_path=e[0].file_path}}},[["render",function(e,l,t,a,c,v){var V=n,x=o,G=s,F=r,S=u,z=D,A=j("img-url");return i(),p("div",W,[v.form.model.spec_many&&v.form.model.spec_many.spec_list.length>0?(i(),k(F,{key:0,label:"规格明细："},{default:h((function(){return[d("div",null,[y(" 批量设置 "),g(V,{size:"small",modelValue:c.batchData.product_price,"onUpdate:modelValue":l[0]||(l[0]=function(e){return c.batchData.product_price=e}),placeholder:"销售价",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),g(V,{size:"small",modelValue:c.batchData.line_price,"onUpdate:modelValue":l[1]||(l[1]=function(e){return c.batchData.line_price=e}),placeholder:"划线价",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),g(V,{size:"small",modelValue:c.batchData.stock_num,"onUpdate:modelValue":l[2]||(l[2]=function(e){return c.batchData.stock_num=e}),placeholder:"库存",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),g(V,{size:"small",modelValue:c.batchData.product_weight,"onUpdate:modelValue":l[3]||(l[3]=function(e){return c.batchData.product_weight=e}),placeholder:"重量",style:{width:"160px","padding-left":"4px"}},null,8,["modelValue"]),g(x,{size:"small",onClick:v.onSubmitBatchData},{default:h((function(){return[y("应用")]})),_:1},8,["onClick"])]),d("div",null,[g(S,{size:"",data:v.form.model.spec_many.spec_list,"span-method":v.objectSpanMethod,border:"",style:{width:"100%","margin-top":"20px"}},{default:h((function(){return[(i(!0),p(m,null,f(v.form.model.spec_many.spec_attr,(function(e,l){return i(),k(G,{label:e.group_name,key:e.group_name},{default:h((function(e){return[y(_(e.row.rows[l].spec_value),1)]})),_:2},1032,["label"])})),128)),g(G,{label:"规格图片"},{default:h((function(e){return[b(d("img",{alt:"",width:"35",height:"35",onClick:function(l){return v.chooseSpecImage(e.$index)}},null,8,X),[[A,e.row.spec_form.image_path]])]})),_:1}),g(G,{label:"产品编码"},{default:h((function(e){return[g(F,{label:"",style:{"margin-bottom":"0"}},{default:h((function(){return[g(V,{size:"small",prop:"product_no",modelValue:e.row.spec_form.product_no,"onUpdate:modelValue":function(l){return e.row.spec_form.product_no=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),g(G,{label:"销售价"},{default:h((function(e){return[g(F,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.product_price",style:{"margin-bottom":"0"}},{default:h((function(){return[g(V,{size:"small",prop:"product_price",modelValue:e.row.spec_form.product_price,"onUpdate:modelValue":function(l){return e.row.spec_form.product_price=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),g(G,{label:"划线价"},{default:h((function(e){return[g(F,{label:"",style:{"margin-bottom":"0"}},{default:h((function(){return[g(V,{size:"small",prop:"line_price",modelValue:e.row.spec_form.line_price,"onUpdate:modelValue":function(l){return e.row.spec_form.line_price=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1024)]})),_:1}),g(G,{label:"库存"},{default:h((function(e){return[g(F,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.stock_num",style:{"margin-bottom":"0"}},{default:h((function(){return[g(V,{size:"small",prop:"stock_num",modelValue:e.row.spec_form.stock_num,"onUpdate:modelValue":function(l){return e.row.spec_form.stock_num=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1}),g(G,{label:"重量(kg)"},{default:h((function(e){return[g(F,{label:"",rules:[{required:!0,message:" "}],prop:"model.spec_many.spec_list."+e.$index+".spec_form.product_weight",style:{"margin-bottom":"0"}},{default:h((function(){return[g(V,{size:"small",prop:"product_weight",modelValue:e.row.spec_form.product_weight,"onUpdate:modelValue":function(l){return e.row.spec_form.product_weight=l}},null,8,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["prop"])]})),_:1})]})),_:1},8,["data","span-method"])])]})),_:1})):w("",!0),c.isupload?(i(),k(z,{key:1,isupload:c.isupload,onReturnImgs:v.returnImgsFunc},{default:h((function(){return[y("上传图片")]})),_:1},8,["isupload","onReturnImgs"])):w("",!0)])}]])}},[["render",function(e,l,t,a,n,o){var s=G("Type"),r=G("Table");return i(),p("div",null,[g(s),g(r)])}]]))}}}));
