import{r as t,H as e,I as l,J as a,d as u,e as s,w as i,j as c,k as d,F as o,l as n,K as r,m as v,t as _,B as p,h as f,L as h,M as m,$ as y,u as b,N as g,y as x,z as k,f as w,O as A,q as I,P as C,s as P,A as T,G as K,Q as S,b as j,n as N,p as U,v as L,x as O,g as R}from"./index-c77b4aac.js";import{a as B,b as E,D,v as F,_ as Q}from"./verify.f5954a34.js";import{$ as H,_ as J,l as Y,m as G,n as V,j as W,o as q,p as M,g as z,c as X,v as $,b as Z,d as tt,a as et,f as lt,h as at}from"./baseinfo.4a8261ee.js";const ut=J({__name:"dish-menu",props:{list:{type:Array,default:()=>[]},menuId:{type:Number,default:null}},emits:["update:menuId"],setup(m,{emit:y}){const b=m,g=t(0),x=t(0),k=t([]);e((()=>b.list),(async t=>{if(await l(),!t||0==t.length)return;const e=a().in(this);if(t.map(((t,l)=>{e.select(`#scroll-item-${l}`).boundingClientRect((t=>{if(!t)return;const e=k.value;e[l]=t.width+10,k.value=e})).exec()})),b.menuId>0){const t=b.list.findIndex((t=>t.category_id==b.menuId));t>-1&&w(t)}}),{deep:!0,immediate:!0});const w=t=>{x.value=t,g.value=k.value.slice(0,t+1).reduce(((t,e)=>t+e),0)-(k.value[t]+100),y("update:menuId",b.list[t].category_id)};return(t,e)=>{const l=p,a=f,m=h;return u(),s(m,{class:"ti-dish-menu","scroll-left":g.value,"scroll-x":"","enable-flex":"","scroll-with-animation":""},{default:i((()=>[c(a,{class:"ti-menu-content"},{default:i((()=>[(u(!0),d(o,null,n(b.list,((e,d)=>(u(),s(a,{key:d,class:r(["ti-menu-item",{active:d==x.value}]),id:`scroll-item-${d}`,onClick:t=>w(d)},{default:i((()=>[c(l,{class:"ti-menu-title"},{default:i((()=>[v(_(0===d?t.$t(e.name_text):e.name_text),1)])),_:2},1024)])),_:2},1032,["id","class","onClick"])))),128))])),_:1})])),_:1},8,["scroll-left"])}}},[["__scopeId","data-v-440ee506"]]),st=J({__name:"dish-category",props:{categoryId:{type:Number,default:null}},emits:["update:categoryId"],setup(l,{emit:a}){const p=t([]),h=t(0),g=t(0),x=m((()=>{let t=(p.value.find((t=>t.category_id==h.value))||{}).child||[];return t&&t.length>0&&(t=[{name_text:y("全部"),category_id:0}].concat(t)),t}));e((()=>h.value),(()=>{a("update:categoryId",h.value),x&&x.length>0&&(g.value=x.value[0].category_id)}));return(async()=>{try{const t=await H("product.category/index");t.data.list&&(p.value=[{name_text:y("全部"),category_id:0}].concat(t.data.list),h.value=p.value[0].category_id)}catch(t){}})(),(t,e)=>{const l=f;return u(),s(l,{class:"ti-category-box"},{default:i((()=>[c(ut,{list:p.value,menuId:h.value,"onUpdate:menuId":e[0]||(e[0]=t=>h.value=t)},null,8,["list","menuId"]),c(l,{class:"ti-dish-secondary"},{default:i((()=>[(u(!0),d(o,null,n(b(x),((t,e)=>(u(),s(l,{key:e,class:r([{active:t.category_id==g.value},"ti-secondary-item"]),onClick:e=>{return l=t.category_id,g.value=l,void a("update:categoryId",g.value>0?g.value:h.value);var l}},{default:i((()=>[v(_(0===e?b(y)(t.name_text):t.name_text),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-9c871ecd"]]);function it(t,e){return H("order.Order/getUnSendKitchen",t,{isLoading:e})}const ct=J({__name:"goods-detail",props:{show:{type:Boolean,default:!1},productId:{type:Number,default:null}},emits:["update:show","success"],setup(l,{emit:a}){const m=l,K=t({}),S=t(!1),j=t(!1),N=t({product_id:null,product_num:1,price:null,product_price:null,product_sku_id:null,attr:[],feed:[],bag_price:0,delivery:g()?30:40,describe:null});e((()=>m.show),(()=>{m.show&&U()}));const U=async()=>{var t,e,l,a,u,s,i,c,d,o;if(!S.value||m.productId)try{S.value=!0;const n=await(o=m.productId,H("product.product/detail",{product_id:o}));K.value=n.data,N.value.product_id=null==(t=K.value)?void 0:t.product_id,N.value.price=null==(e=K.value)?void 0:e.product_price,N.value.product_price=null==(l=K.value)?void 0:l.product_price,(null==(a=K.value)?void 0:a.sku)&&(null==(u=K.value)?void 0:u.sku.length)>0&&(N.value.product_sku_id=null==(s=K.value)?void 0:s.sku[0].product_sku_id),(null==(i=K.value)?void 0:i.product_attr)&&(null==(c=K.value)?void 0:c.product_attr.length)>0&&(null==(d=K.value)||d.product_attr.map(((t,e)=>{(null==t?void 0:t.attribute_value)&&(null==t?void 0:t.attribute_value.length)>0?N.value.attr[e]=0:N.value.attr[e]=null}))),N.value.feed&&N.value.feed.length>0&&(N.value.feed=[])}catch(n){}finally{S.value=!1}},L=async()=>{var t,e,l,u,s,i,c,d,o;if(j.value)return;const n={...N.value};n.attr=n.attr.join(","),n.feed=n.feed.join(",");let r=[];(null==(t=K.value)?void 0:t.sku)&&(null==(e=K.value)?void 0:e.sku.length)>0&&r.push(null==(l=K.value)?void 0:l.sku.find((t=>t.product_sku_id==N.value.product_sku_id)).spec_name_text),(null==(u=K.value)?void 0:u.product_attr)&&(null==(s=K.value)?void 0:s.product_attr.length)&&(null==(i=K.value)||i.product_attr.map(((t,e)=>{(null==t?void 0:t.attribute_value)&&(null==t?void 0:t.attribute_value.length)>0&&(null==t?void 0:t.attribute_value[N.value.attr[e]])&&r.push(null==t?void 0:t.attribute_value[N.value.attr[e]])}))),(null==(c=K.value)?void 0:c.product_feed)&&(null==(d=K.value)?void 0:d.product_feed.length)>0&&(null==(o=K.value)||o.product_feed.map(((t,e)=>{O(e)&&(r.push(t.feed_name_text),n.price=V(n.price,null==t?void 0:t.price))}))),n.describe=r.join(";"),n.delivery=g()?30:40,n.order_id=A(),n.table_id=I();try{j.value=!0;const t=await function(t){return H("order.Order/add",t)}(n);1==t.code&&(C(t.data.order_id),P({title:t.msg,icon:"none"}),a("update:show",!1),setTimeout((()=>{a("success")}),100))}catch(v){}finally{j.value=!1}},O=t=>N.value.feed.indexOf(t)>-1,R=(t,e)=>N.value.attr[t]==e;return(t,e)=>{const l=T,g=f,A=p,I=h,C=x(k("ti-modal"),B);return u(),s(C,{show:m.show,title:b(y)("商品詳情"),cancelText:b(y)("取消"),confirmText:b(y)("確定"),confirmLoading:j.value,onCancel:e[0]||(e[0]=t=>a("update:show",!1)),onConfirm:L},{content:i((()=>[c(g,{class:"ti-dialog-content"},{default:i((()=>[c(g,{class:"ti-detail-box"},{default:i((()=>[c(g,{class:"ti-detail-image"},{default:i((()=>{var t,e,a,i;return[(null==(t=K.value)?void 0:t.image)&&(null==(e=K.value)?void 0:e.image[0])&&(null==(a=K.value)?void 0:a.image[0].file_path)?(u(),s(l,{key:0,src:null==(i=K.value)?void 0:i.image[0].file_path,mode:"widthFix"},null,8,["src"])):w("",!0)]})),_:1}),c(g,{class:"ti-detail-con"},{default:i((()=>[c(g,{class:"ti-detail-title text-ellipsis"},{default:i((()=>{var t;return[v(_(null==(t=K.value)?void 0:t.product_name_text),1)]})),_:1}),c(g,{class:"ti-price-box"},{default:i((()=>[c(A,{class:"ti-detail-unit"},{default:i((()=>[v(_(b(y)("單價：")),1)])),_:1}),c(A,{class:"ti-detail-price"},{default:i((()=>{var t;return[v(_(b(Y)((null==(t=K.value)?void 0:t.product_price)||0)),1)]})),_:1}),c(A,{class:"ti-detail-subPrice"},{default:i((()=>{var t;return[v(_(b(G)((null==(t=K.value)?void 0:t.product_price)||0)),1)]})),_:1})])),_:1}),c(g,{class:"ti-price-box"},{default:i((()=>[c(A,{class:"ti-detail-unit"},{default:i((()=>[v(_(b(y)("單位：")),1)])),_:1}),c(A,{class:"ti-detail-price"},{default:i((()=>{var t;return[v(_(null==(t=K.value)?void 0:t.product_unit_text),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(g,{class:"ti-detail-specs"},{default:i((()=>[c(I,{"scroll-y":""},{default:i((()=>[c(g,{class:"ti-specs-box"},{default:i((()=>{var t,e,l,a,p,f,h;return[(null==(t=K.value)?void 0:t.sku)&&(null==(e=K.value)?void 0:e.sku.length)>0?(u(),s(g,{key:0,class:"ti-specs-item"},{default:i((()=>[c(g,{class:"ti-specs-title"},{default:i((()=>[v(_(b(y)("規格")),1)])),_:1}),c(g,{class:"ti-specs-child"},{default:i((()=>{var t;return[(u(!0),d(o,null,n(null==(t=K.value)?void 0:t.sku,(t=>(u(),s(g,{key:t.product_sku_id,class:r([{active:t.product_sku_id==N.value.product_sku_id},"ti-child-item"]),onClick:e=>{return l=t.product_sku_id,void(N.value.product_sku_id!=l&&(N.value.product_sku_id=l));var l}},{default:i((()=>[c(A,{class:"ti-child-name"},{default:i((()=>[v(_(t.spec_name_text),1)])),_:2},1024),c(A,{class:"ti-child-price"},{default:i((()=>[v(_(b(Y)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024),c(A,{class:"ti-child-subPrice"},{default:i((()=>[v(_(b(G)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):w("",!0),(null==(l=K.value)?void 0:l.product_attr)&&(null==(a=K.value)?void 0:a.product_attr.length)>0?(u(!0),d(o,{key:1},n(null==(p=K.value)?void 0:p.product_attr,((t,e)=>(u(),s(g,{key:e,class:"ti-specs-item"},{default:i((()=>[c(g,{class:"ti-specs-title"},{default:i((()=>[v(_(t.attribute_name_text),1)])),_:2},1024),c(g,{class:"ti-specs-child"},{default:i((()=>[(u(!0),d(o,null,n(null==t?void 0:t.attribute_value,((t,l)=>(u(),s(g,{key:l,class:r([{active:R(e,l)},"ti-child-item"]),onClick:t=>((t,e)=>{N.value.attr[t]=e})(e,l)},{default:i((()=>[c(A,{class:"ti-child-name"},{default:i((()=>[v(_(t),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128)):w("",!0),(null==(f=K.value)?void 0:f.product_feed)&&(null==(h=K.value)?void 0:h.product_feed.length)>0?(u(),s(g,{key:2,class:"ti-specs-item"},{default:i((()=>[c(g,{class:"ti-specs-title"},{default:i((()=>[v(_(b(y)("加料")),1)])),_:1}),c(g,{class:"ti-specs-child"},{default:i((()=>{var t;return[(u(!0),d(o,null,n(null==(t=K.value)?void 0:t.product_feed,((t,e)=>(u(),s(g,{key:e,class:r([{active:O(e)},"ti-child-item"]),onClick:t=>(t=>{const e=N.value.feed.indexOf(t);e>=0?N.value.feed.splice(e,1):N.value.feed.push(t)})(e)},{default:i((()=>[c(A,{class:"ti-child-name"},{default:i((()=>[v(_(t.feed_name_text),1)])),_:2},1024),c(A,{class:"ti-child-price"},{default:i((()=>[v(_(b(Y)((null==t?void 0:t.price)||0)),1)])),_:2},1024),c(A,{class:"ti-child-subPrice"},{default:i((()=>[v(_(b(G)((null==t?void 0:t.price)||0)),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))]})),_:1})])),_:1})):w("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","cancelText","confirmText","confirmLoading"])}}},[["__scopeId","data-v-e39de0f7"]]),dt=J({__name:"dish-car-order-nav",emits:["car","confirm"],setup(e,{expose:l,emit:a}){const d=()=>{a("car")},o=()=>{a("confirm")},n=t(),r=t(!1),h=async()=>{var t;try{const e=await it({table_id:I()},!1);n.value=(null==(t=e.data)?void 0:t.detail)||{},n.value.unSendKitchenProductTotalNum>0?r.value=!0:r.value=!1}catch(e){}};return h(),l({getCarData:h}),(t,e)=>{const l=T,a=p,h=f;return u(),s(h,{class:"ti-car-order"},{default:i((()=>[c(h,{class:"ti-order-total",onClick:d},{default:i((()=>[c(l,{class:"ti-total-image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE9SURBVHgB7ZjxrcIgEMY/Xt4AbvAYwRHc4DmKbuAG6gR1A92g3UA3sE6gTnAesZqG1gLKSf/oL7nQwKV8Be6AAj1DPR6IaMTF6NmgVIlUGDFsR2qSVUJ7I8iQIwWVKF2zWU3UBH2AhexJhtx8dFufPw5NF8gwYTu2jbxLkIYsmV3hEiQdYdoepdSCGn38OpzXbP+Qo2Q7YCAA9aqhyhNbyK6jHe+Zcy9PFrQgec52v11R9o0IayTe1IJKu6JL0B8S4EqM0lztii5BGvIELWoNeU52ReopC4qyAvL472PmWECyZAiF5LJ1Ti9uM8pDlMb9yKnxOWbNHHj/KjDwJs4pq8PTN+VizFb4DHuofxD88qW1MGcx/UPFjFsi5RzLv84nmTr0eBL3OEPNnxGrmP7vCDKXuk2V1Bax/Qd8uQE+N6CHpHz4IAAAAABJRU5ErkJggg=="}),c(a,{class:"ti-total-price"},{default:i((()=>{var t;return[v(_(b(Y)((null==(t=n.value)?void 0:t.unSendKitchenProductTotalPrice)||0)),1)]})),_:1}),c(a,{class:"ti-total-subPrice"},{default:i((()=>{var t;return[v(_(b(G)((null==(t=n.value)?void 0:t.unSendKitchenProductTotalPrice)||0)),1)]})),_:1})])),_:1}),r.value?(u(),s(h,{key:0,class:"ti-total-badge-box"},{default:i((()=>[c(a,{class:"ti-total-badge"},{default:i((()=>{var t;return[v(_(null==(t=n.value)?void 0:t.unSendKitchenProductTotalNum),1)]})),_:1})])),_:1})):w("",!0),c(h,{class:"ti-order-btn",onClick:o},{default:i((()=>[c(a,{class:"ti-btn-text"},{default:i((()=>[v(_(t.$t("下單")),1)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-8e21f0ac"]]),ot=J({__name:"cart-number",props:{productItem:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:l}){const a=e,d=t(!1),o=async t=>{var e,u;const s={order_product_id:null==(e=a.productItem)?void 0:e.order_product_id,product_num:null==(u=a.productItem)?void 0:u.total_num,type:t};"up"==t?s.product_num+=1:s.product_num-=1;try{d.value=!0;const t=await function(t){return H("order.Order/sub",t)}(s);1==t.code&&l("change")}catch(i){}finally{d.value=!1}};return(t,l)=>{const a=f;return u(),s(a,{class:"ti-number-box",onClick:l[2]||(l[2]=K((()=>{}),["stop"]))},{default:i((()=>[c(a,{class:"ti-number-btn ti-number-minus",disabled:!1,onClick:l[0]||(l[0]=t=>o("down"))},{default:i((()=>[c(a,{class:"ti-number-minus-reduce"})])),_:1}),c(a,{class:"ti-number-input"},{default:i((()=>[v(_(e.productItem.total_num),1)])),_:1}),c(a,{class:"ti-number-btn ti-number-plus",disabled:!1,onClick:l[1]||(l[1]=t=>o("up"))},{default:i((()=>[c(a,{class:"ti-number-plus-add"}),c(a,{class:"ti-number-plus-add2"})])),_:1})])),_:1})}}},[["__scopeId","data-v-d611c51e"]]),nt=J({__name:"dish-car-ordering-list",emits:["success","change"],setup(e,{emit:l}){const a=t(!1),r=t(),m=t(),g=t({table_id:""}),A=async t=>{var e;g.table_id=I();try{const t=await it(g,!1);r.value=t.data.detail,m.value=(null==(e=t.data.detail)?void 0:e.unSendKitchenProduct)||[],l("change")}catch(a){}},C=async t=>{try{a.value=!0;const t=await function(t){return H("order.Order/sendKitchen",t)}({table_id:I()});P({title:y(t.msg),icon:"none"}),setTimeout((()=>{l("success")}),500)}catch(e){}finally{a.value=!1}};return A(),(t,e)=>{const l=f,a=p,g=h,I=x(k("ti-button"),W),P=x(k("ti-empty-data"),q);return u(),s(l,{class:"ti-shop-list-box"},{default:i((()=>{var t,p;return[(null==(t=m.value)?void 0:t.length)>0?(u(),s(l,{key:0,class:"ti-shop-list"},{default:i((()=>[c(l,null,{default:i((()=>[c(l,{class:"ti-cart-shop-head"},{default:i((()=>[c(l,{class:"ti-shop-head-title"},{default:i((()=>[v(_(b(y)("商品名稱")),1)])),_:1}),c(l,{class:"ti-shop-head-money"},{default:i((()=>[v(_(b(y)("金額")),1)])),_:1}),c(l,{class:"ti-shop-head-num"},{default:i((()=>[v(_(b(y)("數量")),1)])),_:1})])),_:1})])),_:1}),c(l,{class:"ti-scroll-box"},{default:i((()=>[c(g,{class:"ti-shop-scroll","scroll-y":""},{default:i((()=>[c(l,{class:"ti-shop-box"},{default:i((()=>[(u(!0),d(o,null,n(m.value,((t,d)=>(u(),s(l,{class:"ti-shop-item",key:t},{default:i((()=>[c(l,{class:"ti-shop-item-box"},{default:i((()=>[c(l,{class:"ti-shop-box"},{default:i((()=>[c(l,{class:"ti-shop-body-top"},{default:i((()=>[c(l,{class:"ti-shop-title text-ellipsis"},{default:i((()=>[v(_(t.product_name_text),1)])),_:2},1024),c(l,{class:"ti-shop-spec"},{default:i((()=>[v(_(t.product_attr),1)])),_:2},1024)])),_:2},1024),c(l,{class:"ti-shop-body-money"},{default:i((()=>[c(a,{class:"ti-shop-price"},{default:i((()=>[v(_(b(Y)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024),c(a,{class:"ti-shop-subPrice"},{default:i((()=>[v(_(b(G)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024)])),_:2},1024),c(l,{class:"ti-shop-body-number"},{default:i((()=>[c(ot,{productItem:t,onChange:e[0]||(e[0]=t=>A())},null,8,["productItem"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),c(l,{class:"ti-content-bottom"},{default:i((()=>[c(l,{class:"ti-car-shop-bottom"},{default:i((()=>[c(l,{class:"ti-shop-bottom-item"},{default:i((()=>[c(l,null,{default:i((()=>[c(a,{class:"ti-shop-bottom-text"},{default:i((()=>{var t;return[v(_(b(y)("共")+((null==(t=r.value)?void 0:t.unSendKitchenProductTotalNum)||0)+b(y)("件")),1)]})),_:1})])),_:1}),c(l,null,{default:i((()=>[c(a,{class:"ti-shop-bottom-text"},{default:i((()=>[v(_(b(y)("小計：")),1)])),_:1}),c(a,{class:"ti-shop-bottom-price"},{default:i((()=>{var t;return[v(_(b(Y)((null==(t=r.value)?void 0:t.unSendKitchenProductTotalPrice)||0)),1)]})),_:1}),c(a,{class:"ti-shop-bottom-subPrice"},{default:i((()=>{var t;return[v(_(b(G)((null==(t=r.value)?void 0:t.unSendKitchenProductTotalPrice)||0)),1)]})),_:1})])),_:1})])),_:1})])),_:1}),c(I,{title:b(y)("確認下單"),type:"primary",onClick:C},null,8,["title"])])),_:1})])),_:1})):w("",!0),(null==(p=m.value)?void 0:p.length)<=0?(u(),s(l,{key:1,class:"ti-empty-data-box"},{default:i((()=>[c(P,{title:b(y)("當前無待下單商品")},null,8,["title"])])),_:1})):w("",!0)]})),_:1})}}},[["__scopeId","data-v-508af573"]]),rt=J({__name:"dish-car-ordered-list",setup(e){const l=t([]);(async()=>{try{const e=await(t={table_id:I()},H("order.Order/getSendKitchen",t));l.value=e.data.list||[]}catch(e){}var t})();return(t,e)=>{const a=f,r=p,m=h,g=x(k("ti-empty-data"),q);return u(),s(a,{class:"ti-shop-list"},{default:i((()=>[Object.keys(l.value).length>0?(u(),s(m,{key:0,class:"ti-shop-scroll","scroll-y":""},{default:i((()=>[(u(!0),d(o,null,n(l.value,((t,e)=>(u(),s(a,{class:"ti-shop-item",key:e},{default:i((()=>[c(a,{class:"ti-shop-time-box"},{default:i((()=>[v(_(e+" "+b(y)("下單")),1)])),_:2},1024),(u(!0),d(o,null,n(t,((e,l)=>(u(),s(a,{key:l},{default:i((()=>[c(a,{class:"ti-shop-item-box"},{default:i((()=>[c(a,{class:"ti-shop-box"},{default:i((()=>[c(a,{class:"ti-shop-body-top"},{default:i((()=>[c(a,{class:"ti-shop-title text-ellipsis"},{default:i((()=>[v(_(e.product_name_text),1)])),_:2},1024),c(a,{class:"ti-shop-spec"},{default:i((()=>[v(_(e.product_attr),1)])),_:2},1024)])),_:2},1024),c(a,{class:"ti-shop-body-money"},{default:i((()=>[c(r,{class:"ti-shop-price"},{default:i((()=>[v(_(b(Y)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024),c(r,{class:"ti-shop-subPrice"},{default:i((()=>[v(_(b(G)((null==e?void 0:e.product_price)||0)),1)])),_:2},1024)])),_:2},1024),c(a,{class:"ti-shop-body-state"},{default:i((()=>[c(a,{class:"ti-state-left"},{default:i((()=>[v(_(e.finish_num),1)])),_:2},1024),c(a,{class:"ti-state-line"},{default:i((()=>[v("/")])),_:1}),c(a,{class:"ti-state-right"},{default:i((()=>[v(_(e.total_num),1)])),_:2},1024),c(a,{class:"ti-state-text"},{default:i((()=>{return[v(_((t=e.kitchen_status,y(0===t?"製作中":1===t?"已完成":"未知"))),1)];var t})),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),l!=t.length-1?(u(),s(a,{key:0,class:"ti-shop-item-box-bottom-border"})):w("",!0)])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1})):w("",!0),Object.keys(l.value).length<=0?(u(),s(g,{key:1,class:"ti-empty-data",title:b(y)("當前無已下單商品")},null,8,["title"])):w("",!0)])),_:1})}}},[["__scopeId","data-v-fc39754e"]]),vt=J({__name:"dish-list",emits:["success"],setup(l,{emit:a}){const m=t(!1),g=t({category_id:null,shop_supplier_id:null,page:1,list_rows:30}),A=t([]),I=t(!1),C=t(),K=t(!1);e((()=>g.value.category_id),(()=>{U()}));const j=()=>{V.value.getCarData()},N=()=>{K.value&&(g.value.page+=1,L())},U=()=>{g.value.page=1,g.value.shop_supplier_id=S(),L(!0)},L=async t=>{var e,l,a,u,s,i;if(I.value)return;const c={...g.value};c.category_id||(c.category_id=null);try{t&&(I.value=!0);const d=await function(t){return H("product.product/index",t,{isLoading:!1})}(c);1==g.value.page&&(A.value=[]),A.value=A.value.concat((null==(l=null==(e=d.data)?void 0:e.list)?void 0:l.data)||[]),K.value=(null==(u=null==(a=d.data)?void 0:a.list)?void 0:u.last_page)>(null==(i=null==(s=d.data)?void 0:s.list)?void 0:i.current_page)}catch(d){}finally{t&&(I.value=!1)}};U(),t([]);const O=t(),R=()=>{O.value=!0,F.value=!0},B=()=>{O.value=!0,F.value=!1},D=(t,e)=>{t||(O.value=!1)},F=t(!0),Q=t=>{F.value=t},J=()=>{F.value=!1};F.value=!0;const V=t();return(t,e)=>{const l=x(k("ti-loading"),E),a=T,S=p,U=f,L=x(k("ti-empty-data"),q),H=h,W=x(k("ti-drawer"),M);return u(),d(o,null,[c(U,{class:"ti-dish-box"},{default:i((()=>[c(st,{categoryId:g.value.category_id,"onUpdate:categoryId":e[0]||(e[0]=t=>g.value.category_id=t)},null,8,["categoryId"]),c(U,{class:"ti-dish-list"},{default:i((()=>[c(H,{class:"ti-scroll","scroll-y":"","lower-threshold":50,onScrolltolower:N},{default:i((()=>[I.value?(u(),s(l,{key:0})):A.value&&A.value.length>0?(u(),d(o,{key:1},[c(U,{class:"ti-dish-goods"},{default:i((()=>[(u(!0),d(o,null,n(A.value,((t,e)=>(u(),s(U,{key:e,class:r([{"sold-out":t.product_stock<=0},"ti-goods-item"]),onClick:e=>(t=>{if(t.product_stock<=0)return P({title:y("已售罄"),icon:"none"});m.value=!0,C.value=t.product_id})(t)},{default:i((()=>[c(U,{class:"ti-goods-image"},{default:i((()=>[t.image&&t.image[0]&&t.image[0].file_path?(u(),s(a,{key:0,src:t.image[0].file_path,mode:"widthFix"},null,8,["src"])):w("",!0),c(S,{class:"sold-out-text"},{default:i((()=>[v(_(b(y)("已售罄")),1)])),_:1})])),_:2},1024),c(U,{class:"ti-goods-content"},{default:i((()=>[c(U,{class:"ti-goods-title"},{default:i((()=>[v(_(t.product_name_text),1)])),_:2},1024),c(U,{class:"ti-price-box"},{default:i((()=>[c(S,{class:"ti-goods-price"},{default:i((()=>[v(_(b(Y)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024),c(S,{class:"ti-goods-subPrice"},{default:i((()=>[v(_(b(G)((null==t?void 0:t.product_price)||0)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),c(l,{status:K.value?"loading":"no-more"},null,8,["status"])],64)):(u(),s(L,{key:2}))])),_:1})])),_:1}),c(U,{class:"ti-car-order-nav"},{default:i((()=>[c(dt,{ref_key:"carRef",ref:V,onCar:R,onConfirm:B},null,512)])),_:1})])),_:1}),c(ct,{show:m.value,"onUpdate:show":e[1]||(e[1]=t=>m.value=t),productId:C.value,onSuccess:j},null,8,["show","productId"]),c(W,{show:O.value,width:603.992,title:b(y)("我點的菜"),maskClick:!0,onChange:D},{content:i((()=>[c(U,{class:"ti-drawer-content"},{default:i((()=>[c(U,{class:"ti-content-head"},{default:i((()=>[c(U,{class:"ti-switch-box"},{default:i((()=>[c(U,{class:r(F.value?"ti-switch-on":"ti-switch-off"),onClick:e[2]||(e[2]=t=>Q(!0))},{default:i((()=>[c(S,{class:r(F.value?"ti-switch-text-on":"ti-switch-text-off")},{default:i((()=>[v(_(b(y)("未下單")),1)])),_:1},8,["class"])])),_:1},8,["class"]),c(U,{class:"ti-switch-space"}),c(U,{class:r(F.value?"ti-switch-off":"ti-switch-on"),onClick:e[3]||(e[3]=t=>Q(!1))},{default:i((()=>[c(S,{class:r(F.value?"ti-switch-text-off":"ti-switch-text-on")},{default:i((()=>[v(_(b(y)("已下單")),1)])),_:1},8,["class"])])),_:1},8,["class"])])),_:1})])),_:1}),F.value?(u(),s(nt,{key:0,onSuccess:J,onChange:j})):w("",!0),F.value?w("",!0):(u(),s(rt,{key:1}))])),_:1})])),footer:i((()=>[c(U)])),_:1},8,["show","width","title"])],64)}}},[["__scopeId","data-v-80e91ac4"]]),_t=J({__name:"opentable-index",setup(e){const l=t(!1),a=()=>{J()},d=()=>{j({url:"/pages/index/opentable-index"})},o=t(),n=t("");t([]);const r=t();t();const h=t(),m=t("8080"),g=t=>{h.value=t},w=t=>{m.value=t},A=async()=>{if(h.value)if(m.value)try{let t="";t=h.value.startsWith("http://")||h.value.startsWith("https://")?m.value.length>0?h.value+":"+m.value:h.value:m.value.length>0?"http://"+h.value+":"+m.value:"http://"+h.value,l.value=!0;const e=await $(t);Z(t),N(e.data.app_id),U(e.data.shop_supplier_id),setTimeout((()=>{T()}),300)}catch(t){}finally{l.value=!1}else P({title:y("請輸入服務器端口"),icon:"none"});else P({title:y("請輸入服務器鏈接地址"),icon:"none"})},C=t(!1),T=()=>{C.value=!0},K=t=>{C.value=!1,t&&(r.value=t,n.value=y("已選 : ")+t.table_no)},S=()=>{h.value="",m.value="",n.value="",r.value=""},E=async()=>{if(h.value)if(m.value)if(r.value)try{const t=await tt({table_id:r.value.table_id,old_table_id:I()});L(r.value),o.value=!1,W(),O(!1),j({url:"/pages/index/index"}),P({title:t.msg,icon:"none"})}catch(t){}else P({title:y("請查找桌位"),icon:"none"});else P({title:y("請輸入服務器端口"),icon:"none"});else P({title:y("請輸入服務器鏈接地址"),icon:"none"})},H=t(!1),J=()=>{H.value=!0},Y=async t=>{if(t)try{await F({password:t});o.value=!0,G()}catch(e){}else P({title:y("請輸入密碼"),icon:"none"})},G=()=>{H.value=!1},V=t({name:"",logo:"",tableNo:""}),W=async()=>{try{l.value=!0;const t=await et();V.value.name=t.data.name,V.value.logo=t.data.logo,V.value.tableNo=R().table_no}catch(t){}finally{l.value=!1}};return h.value=z(),(t,e)=>{const l=x(k("ti-layout-head"),Q),r=f,I=p,P=x(k("ti-input"),lt),T=x(k("ti-modal"),B),j=x(k("ti-layout-table-list"),at);return u(),s(r,{class:"ti-page",onClick:e[1]||(e[1]=t=>b(X)())},{default:i((()=>[c(r,null,{default:i((()=>[c(l,{isPay:!0,onDoubleLogo:a,onRefresh:d})])),_:1}),c(D,{show:H.value,title:b(y)("密碼"),password:!0,placeholder:b(y)("請輸入密碼"),onExit:G,onConfirm:Y},null,8,["show","title","placeholder"]),c(vt),c(T,{show:o.value,title:b(y)("設置"),cancelText:b(y)("重置"),confirmText:b(y)("確定"),onCancel:S,onConfirm:E},{content:i((()=>[c(r,{class:"ti-item-input"},{default:i((()=>[c(r,{class:"ti-label-box"},{default:i((()=>[c(r,{class:"ti-label-left"},{default:i((()=>[c(I,{class:"ti-label-server"},{default:i((()=>[v(_(b(y)("服務器連接地址")),1)])),_:1})])),_:1}),c(r,{class:"ti-label-right",onClick:A},{default:i((()=>[c(I,{class:"ti-label-table"},{default:i((()=>[v(_(n.value?n.value:b(y)("查找桌位")),1)])),_:1})])),_:1})])),_:1}),c(r,{class:"ti-input-box"},{default:i((()=>[c(P,{type:"text",onInput:g,value:h.value,clearable:!1},null,8,["value"]),c(r,{class:"ti-colon"},{default:i((()=>[v(":")])),_:1}),c(r,{class:"ti-input-port"},{default:i((()=>[c(P,{type:"number",onInput:w,value:m.value,clearable:!1},null,8,["value"])])),_:1})])),_:1})])),_:1})])),_:1},8,["show","title","cancelText","confirmText"]),c(j,{show:C.value,"onUpdate:show":e[0]||(e[0]=t=>C.value=t),onConfirm:K},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-e4deb9b1"]]);export{_t as default};
