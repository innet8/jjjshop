import{_ as e,m as a,G as l,o as t,c as s,w as u,n as i,e as d,g as n,f as c,b as o,d as _,F as r,r as f,t as m,j as p,a0 as b,I as h,h as g,x as y}from"./index-1a637619.js";import{_ as w}from"./u-parse.466f055c.js";import{r as x}from"./uni-app.es.041617b8.js";import{_ as k}from"./u-icon.19bb138d.js";import{u as q}from"./uni-load-more.934e6c66.js";const D=e({components:{uniLoadMore:q},data:()=>({loading:!0,phoneHeight:0,scrollviewHigh:0,listData:[],last_page:0,page:1,list_rows:10,no_more:!1,shop_supplier_id:0,tableList:[],tableNum:[1,2,3,4,5,6],queue_num:"",mobile:"",table_id:0,type:10,table:{},content:"",detail:null,rule:{}}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onShow(){this.shop_supplier_id=a("selectedId"),this.getData()},methods:{initData(){let e=this;e.page=1,e.listData=[],e.no_more=!1},scrolltolowerFunc(){let e=this;e.no_more||(e.page++,e.page<=e.last_page?e.getData():e.no_more=!0)},cancelFunc(){let e=this;l({title:"提示",content:"确定要取消排队吗？",success(a){a.confirm&&e._post("plus.queue.Record/cancel",{shop_supplier_id:e.shop_supplier_id},(a=>{l({title:"提示",content:a.msg}),e.getData()}))}})},getData(){let e=this;e.loading=!0,e._get("plus.queue.Record/index",{shop_supplier_id:e.shop_supplier_id},(function(a){e.loading=!1,e.detail=a.data.detail,e.tableNum=a.data.tableNum,e.tableList=a.data.tableList,e.content=a.data.rule&&a.data.rule.content,e.rule=a.data.rule}))},submit(){let e=this;""!=e.mobile?""!=e.queue_num?(e.loading=!0,e._get("plus.queue.Record/take",{shop_supplier_id:e.shop_supplier_id,queue_num:e.queue_num,mobile:e.mobile,table_id:e.table_id},(function(a){e.showSuccess("提交成功"),e.getData(),e.loading=!1}),(function(){e.loading=!1}))):e.showError("就餐人数不能为空"):e.showError("手机号不能为空")},changeSelect(e){this.queue_num=this.tableNum[e.detail.value].num,this.table_id=this.tableNum[e.detail.value].table.table_id,this.table=this.tableNum[e.detail.value].table},changeType(e){this.loading||(this.type=e,this.initData(),this.getData())}}},[["render",function(e,a,l,q,D,F){const j=n,v=p,C=b,N=h,L=g,z=x(y("u-parse"),w),S=x(y("u-icon"),k);return D.loading?d("",!0):(t(),s(j,{key:0,"data-theme":e.theme(),class:i([e.theme()||"","pb50"])},{default:u((()=>[null==D.detail?(t(),c(r,{key:0},[o(j,{class:"p-0-20 bg-white mt16"},{default:u((()=>[o(j,{class:"d-b-c top-title border-b"},{default:u((()=>[o(j,{class:"flex-1"},{default:u((()=>[_("餐桌类型")])),_:1}),o(j,{class:"w200 tc"},{default:u((()=>[_("等待桌数")])),_:1}),o(j,{class:"w200 tc"},{default:u((()=>[_("预计等待")])),_:1})])),_:1}),o(j,{class:"p-10-0"},{default:u((()=>[(t(!0),c(r,null,f(D.tableList,((e,a)=>(t(),s(j,{class:"d-b-c top-item",key:a},{default:u((()=>[o(j,{class:"flex-1 f28"},{default:u((()=>[_(m(e.table_name)+" ",1),o(v,{class:"f24"},{default:u((()=>[_("("+m(e.min_num)+"-"+m(e.max_num)+")人",1)])),_:2},1024)])),_:2},1024),o(j,{class:"w200 tc"},{default:u((()=>[o(v,{class:"dominant"},{default:u((()=>[_(m(e.wait_num),1)])),_:2},1024),o(v,{class:"f24"},{default:u((()=>[_("桌")])),_:1})])),_:2},1024),o(j,{class:"w200 tc"},{default:u((()=>[0==e.wait_times?(t(),s(v,{key:0,class:"gray9"},{default:u((()=>[_("无需等待")])),_:1})):(t(),c(r,{key:1},[o(v,{class:"dominant"},{default:u((()=>[_(m(e.wait_times),1)])),_:2},1024),o(v,{class:"f24"},{default:u((()=>[_("分钟")])),_:1})],64))])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1}),o(j,{class:"bg-white mt16"},{default:u((()=>[o(j,{class:"p-0-20"},{default:u((()=>[o(C,{class:"","range-key":"num",onChange:F.changeSelect,range:D.tableNum},{default:u((()=>[o(j,{class:"selectpicker"},{default:u((()=>[o(j,{class:"flex-1"},{default:u((()=>[_("就餐人数")])),_:1}),o(j,{class:"d-c-c"},{default:u((()=>[o(j,{class:"make-item input-box"},{default:u((()=>[_(m(D.queue_num||"请选择")+"人",1)])),_:1}),o(j,{class:"icon iconfont icon-jiantou ml20"})])),_:1})])),_:1})])),_:1},8,["onChange","range"])])),_:1}),D.queue_num?(t(),s(j,{key:0,class:"p-0-20 pb14"},{default:u((()=>[o(j,{class:"p-10-0 f26"},{default:u((()=>[_("餐桌类型")])),_:1}),o(j,{class:"active-box theme-border"},{default:u((()=>[_(m(D.table.table_name+":预计等待"+D.table.wait_num+"桌,"+D.table.wait_times+"分钟"),1)])),_:1})])),_:1})):d("",!0),o(j,{class:"d-b-c p20"},{default:u((()=>[o(j,{class:"f26"},{default:u((()=>[_("手机号")])),_:1}),o(N,{class:"mr10 flex-1 f26 p-10-0 tr",name:"phone",type:"number","placeholder-class":"grary9",modelValue:D.mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>D.mobile=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1})])),_:1}),o(j,{class:"mt24 mb40"},{default:u((()=>[o(L,{type:"default",class:"theme-btn",onClick:F.submit},{default:u((()=>[_("确认取号")])),_:1},8,["onClick"])])),_:1}),D.content?(t(),s(j,{key:0,class:"p20"},{default:u((()=>[o(j,{class:"p20",style:{"border-radius":"15rpx","background-color":"#ededed","font-size":"32rpx","line-height":"1.5"}},{default:u((()=>[o(z,{content:D.content},null,8,["content"])])),_:1})])),_:1})):d("",!0)],64)):(t(),c(r,{key:1},[o(j,{class:"top-text"},{default:u((()=>[o(S,{name:"volume-fill",color:"#FF351A",size:"30rpx"}),o(j,{class:"flex-1 ml10"},{default:u((()=>[_(m(D.rule.notice),1)])),_:1})])),_:1}),o(j,{class:"section d-c"},{default:u((()=>[o(j,{class:"border-b p-40-0"},{default:u((()=>[o(j,{class:"f28 gray3 mb20"},{default:u((()=>[_("我的号码")])),_:1}),o(j,{class:"text-group_1 d-c d-b-s"},{default:u((()=>[o(j,{class:"f48 dominant fb mb20"},{default:u((()=>[_("小桌"+m(D.detail.queue_no),1)])),_:1}),o(j,{class:"f28 gray3 mb20"},{default:u((()=>[o(v,{class:""},{default:u((()=>[_("前方等待桌数")])),_:1}),o(v,{class:"dominant"},{default:u((()=>[_(m(D.detail.wait_num),1)])),_:1}),o(v,{class:""},{default:u((()=>[_("桌")])),_:1})])),_:1})])),_:1}),o(j,{class:"f28 gray6"},{default:u((()=>[_("预计等待时长"+m(D.detail.wait_time)+"分钟",1)])),_:1})])),_:1}),o(j,{class:"paragraph_2 p-30-0 f28 gray6 border-b",style:{"line-height":"1.5"}},{default:u((()=>[o(j,{class:"mb20"},{default:u((()=>[o(v,null,{default:u((()=>[_("已等待：")])),_:1}),o(v,null,{default:u((()=>[_(m(D.detail.await_time)+"分钟",1)])),_:1})])),_:1}),o(j,{class:"mb20"},{default:u((()=>[o(v,null,{default:u((()=>[_("手机号码：")])),_:1}),o(v,null,{default:u((()=>[_(m(D.detail.mobile),1)])),_:1})])),_:1}),o(j,{class:"mb20"},{default:u((()=>[o(v,null,{default:u((()=>[_("取号时间：")])),_:1}),o(v,null,{default:u((()=>[_(m(D.detail.create_time),1)])),_:1})])),_:1}),o(j,null,{default:u((()=>[o(v,null,{default:u((()=>[_("取号渠道：")])),_:1}),o(v,null,{default:u((()=>[_("在线取号")])),_:1})])),_:1})])),_:1}),o(j,{class:"pt20"},{default:u((()=>[o(j,{class:"f28 gray6 d-s-c mb10"},{default:u((()=>[o(S,{size:"34rpx",color:e.getThemeColor(),name:"error-circle-fill"},null,8,["color"]),o(v,{class:"ml10"},{default:u((()=>[_("商家说明")])),_:1})])),_:1}),o(j,{class:"f24 gray6"},{default:u((()=>[_(m(D.rule.explain),1)])),_:1})])),_:1})])),_:1}),o(j,{class:"cancelFunc theme-borderbtn",onClick:F.cancelFunc},{default:u((()=>[_("取消排队")])),_:1},8,["onClick"])],64))])),_:1},8,["data-theme","class"]))}],["__scopeId","data-v-0c6a1e25"]]);export{D as default};
