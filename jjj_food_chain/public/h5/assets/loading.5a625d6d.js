import{_ as t,o as e,c as s,w as o,C as a,e as l,b as i,aa as r,v as d,g as c,d as u,t as n,n as f,f as p,r as h,F as m,h as _,a as k,i as y,j as w,S as b,x as g}from"./index-1a637619.js";import{r as v}from"./uni-app.es.041617b8.js";const C=t({name:"popup-layer",model:{prop:"showPop",event:"change"},props:{showPop:{type:Boolean,default:!1},direction:{type:String,default:"top"},autoClose:{type:Boolean,default:!0}},data:()=>({ifshow:!1,translateValue:-150,timer:null,iftoggle:!1}),computed:{_translate(){return{top:`transform:translateY(${-this.translateValue}%)`,bottom:`transform:translateY(${this.translateValue}%)`,left:`transform:translateX(${-this.translateValue}%)`,right:`transform:translateX(${this.translateValue}%)`}[this.direction]},_location(){return{top:"bottom:env(safe-area-inset-bottom);width:100%;",bottom:"top:0px;width:100%;",left:"right:0px;height:100%;",right:"left:0px;height:100%;"}[this.direction]+this._translate}},mounted(){this.showPop&&this.show()},watch:{showPop(t){t?this.show():this.close()}},methods:{stopMove(t){console.log(t)},show(t){this.ifshow=!0,setTimeout((()=>{this.translateValue=0}),100),setTimeout((()=>{this.iftoggle=!0}),300)},close(){null===this.timer&&this.iftoggle&&(this.translateValue=-100,this.translateValue=-150,this.timer=setTimeout((()=>{this.ifshow=!1,this.timer=null,this.iftoggle=!1,this.$emit("closeCallBack",null),this.$emit("change",!1)}),300))},ableClose(){this.autoClose&&this.close()},stopEvent(t){},doSome(){}}},[["render",function(t,u,n,f,p,h){const m=c;return e(),s(m,null,{default:o((()=>[p.ifshow?(e(),s(m,{key:0,onClick:h.ableClose,onTouchmove:u[0]||(u[0]=a((()=>{}),["stop","prevent"])),class:"popup-layer"},null,8,["onClick"])):l("",!0),i(m,{class:"popup-content",onClick:a(h.stopEvent,["stop"]),style:d(h._location)},{default:o((()=>[r(t.$slots,"content",{},void 0,!0)])),_:3},8,["onClick","style"])])),_:3})}],["__scopeId","data-v-bda4b67f"]]);const S=t({name:"Modal",props:{show:{type:Boolean,default:!1},custom:{type:Boolean,default:!1},width:{type:String,default:"100%"},padding:{type:String,default:"40rpx"},radius:{type:String,default:"24rpx"},title:{type:String,default:""},content:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},shape:{type:String,default:"square"},button:{type:Array,default:function(){return[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red",plain:!1}]}},maskClosable:{type:Boolean,default:!0},fadein:{type:Boolean,default:!1}},data:()=>({}),methods:{handleClick(t){if(!this.show)return;const e=t.currentTarget.dataset;this.$emit("click",{index:Number(e.index)})},handleClickCancel(){this.maskClosable&&this.$emit("cancel")}}},[["render",function(t,k,y,w,b,g){const v=c,C=_;return e(),s(v,{onTouchmove:k[0]||(k[0]=a((()=>{}),["stop","prevent"]))},{default:o((()=>[i(v,{class:f(["modal-box",[y.fadein||y.show?"modal-normal":"modal-scale",y.show?"modal-show":""]]),style:d({width:y.width,padding:y.padding,borderRadius:y.radius})},{default:o((()=>[y.custom?(e(),s(v,{key:0},{default:o((()=>[r(t.$slots,"default",{},void 0,!0)])),_:3})):(e(),s(v,{key:1},{default:o((()=>[y.title?(e(),s(v,{key:0,class:"modal-title"},{default:o((()=>[u(n(y.title),1)])),_:1})):l("",!0),i(v,{class:f(["modal-content",[y.title?"":"mtop"]]),style:d({color:y.color,fontSize:y.size+"rpx"})},{default:o((()=>[r(t.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"]),i(v,{class:f(["modalBtn-box",[2!=y.button.length?"flex-column":""]])},{default:o((()=>[(e(!0),p(m,null,h(y.button,((t,a)=>(e(),s(C,{key:a,class:f(["modal-btn",[(t.type||"primary")+(t.plain?"-outline":""),2!=y.button.length?"btn-width":"",y.button.length>2?"mbtm":"","circle"==y.shape?"circle-btn":"","btn-"+(t.size||"default")]]),"hover-class":(t.plain?"outline":t.type||"primary")+"-hover","data-index":a,onClick:g.handleClick},{default:o((()=>[u(n(t.text||"确定"),1)])),_:2},1032,["class","hover-class","data-index","onClick"])))),128))])),_:1},8,["class"])])),_:3}))])),_:3},8,["style","class"]),i(v,{class:f(["modal-mask",[y.show?"mask-show":""]]),onClick:g.handleClickCancel},null,8,["class","onClick"])])),_:3})}],["__scopeId","data-v-86ab8852"]]);const A=t({components:{modal:S},data:()=>({clock:!1,Visible:!1,form:{attr:[],product_sku_id:[],feed:[],detail:{},show_sku:{sku_image:""},shop_supplier_id:0},stock:0,selectSpec:"",isOpenSpec:!1,type:"",product_price:"",feed_price:0,space_name:"",attr_name:[],feed_name:[],product_lineprice:""}),props:["goodDetailModalVisible","productModel","orderType","bag_type","dinner_type","cart_type","table_id"],computed:{bag_price:function(){return this.form.detail.bag_price*this.form.show_sku.sum},price:function(){return(1*this.feed_price+1*this.product_price)*this.form.show_sku.sum},lineprice:function(){return(1*this.feed_price+1*this.product_lineprice)*this.form.show_sku.sum},isadd:function(){return this.form.show_sku.sum>=this.stock||this.form.show_sku.sum>=this.form.detail.limit_num},issub:function(){return this.form.show_sku.sum<=1}},watch:{goodDetailModalVisible:function(t,e){let s=this;if(t!=e){if(s.Visible=t,s.form=s.productModel,s.space_name="",s.attr_name=[],s.feed_name=[],s.isOpenSpec=!0,s.initShowSku(),s.selecedtSpec(s.form.detail.sku[0],0),""==s.form.detail.product_attr)return;s.form.detail.product_attr.forEach(((t,e)=>{s.form.show_sku.attr[e]||s.selectAttr(t.attribute_value[0],0,e)}))}}},methods:{describe:function(){let t=this.space_name;""!=t&&(t+=";");let e=this.attr_name.join(";");""!=e&&(e+=";");let s=this.feed_name.join(",");return""!=s&&(s+=";"),t+e+s},initShowSku(){this.form.show_sku.sku_image=this.form.detail.product_image,this.form.show_sku.product_price=this.form.detail.product_price,this.form.show_sku.product_sku_id=[],this.form.show_sku.attr=[],this.form.show_sku.feed=[],this.form.show_sku.feed.length=this.form.detail.product_feed.length,this.form.show_sku.line_price=this.form.detail.line_price,this.form.show_sku.stock_num=this.form.detail.product_stock,this.form.show_sku.sum=1,this.stock=this.form.detail.product_stock},closeGoodDetailModal(){this.$emit("closeGoodDetailModal"),this.form={}},selecedtSpec(t,e){let s=this;s.form.detail.sku.forEach(((t,e)=>{t.checked=!1})),t.checked=!0,s.form.show_sku.product_sku_id[0]=t.product_sku_id,s.space_name=t.spec_name,s.$set(s.form.show_sku,"product_price",t.product_price),null!=s.form.show_sku.product_sku_id[0]?s.updateSpecProduct():s.initShowSku()},selectAttr(t,e,s){let o=this;o.$set(o.form.show_sku.attr,s,e),o.attr_name[s]=t,o.updateSpecProduct()},selectFeed(t,e){let s=this;if(s.form.show_sku.feed[e]||0===s.form.show_sku.feed[e]){s.$set(s.form.show_sku.feed,e,null),s.feed_price-=1*t.price;let o=s.feed_name.indexOf(t.feed_name);o>-1&&s.feed_name.splice(o,1)}else s.$set(s.form.show_sku.feed,e,e),s.feed_price+=1*t.price,s.feed_name.push(t.feed_name);s.updateSpecProduct()},updateSpecProduct(){this.product_price=this.form.show_sku.product_price,this.product_lineprice=this.form.show_sku.line_price},add(){this.stock<=0||this.form.show_sku.sum++},sub(){if(!(this.stock<=0))return this.form.show_sku.sum<2?(k({title:"商品数量至少为1",icon:"none",duration:2e3}),!1):void this.form.show_sku.sum--},confirmFunc(){if(!this.clock)if(this.clock=!0,null!=this.form.show_sku.product_sku_id[0]||20!=this.form.detail.spec_type){if(null!=this.form.detail.product_attr)for(let t=0;t<this.form.detail.product_attr.length;t++)if(null==this.form.show_sku.attr[t])return void k({title:"请选择属性",icon:"none",duration:2e3});this.addCart()}else k({title:"请选择规格",icon:"none",duration:2e3})},addCart(){let t=this,e=[];t.form.show_sku.feed.forEach(((t,s)=>{null!=t&&e.push(t)})),e=e.length<=0?"":e.join(",");let s={product_id:t.form.detail.product_id,product_num:t.form.show_sku.sum,product_sku_id:t.form.show_sku.product_sku_id[0],attr:t.form.show_sku.attr.join(","),feed:e,describe:t.describe(),price:1*t.feed_price+1*t.product_price,product_price:1*t.feed_price+1*t.form.show_sku.line_price,bag_price:t.form.detail.bag_price,shop_supplier_id:t.form.shop_supplier_id,cart_type:t.cart_type,dinner_type:t.dinner_type};console.log(this.$props.table_id),this.$props.table_id&&(s.table_id=this.$props.table_id),t._post("order.cart/add",s,(function(e){k({title:e.msg,duration:2e3}),e.data.cartInfo.total_price,e.data.cartInfo.total_bag_price,t.clock=!1,t.$emit("closeGoodDetailModal",t.form.show_sku.sum,e)}),(()=>{t.clock=!1}))}}},[["render",function(t,a,r,d,k,C){const A=y,j=c,P=w,M=b,x=_,z=v(g("modal"),S);return e(),s(j,null,{default:o((()=>[i(z,{show:r.goodDetailModalVisible,class:"good-detail-modal",color:"#5A5B5C",width:"100%",custom:"",padding:"0rpx",radius:"0",onCancel:C.closeGoodDetailModal},{default:o((()=>[i(j,{class:"cover"},{default:o((()=>[k.form.detail.product_image?(e(),s(A,{key:0,src:k.form.detail.product_image,class:"image",mode:"aspectFill"},null,8,["src"])):l("",!0)])),_:1}),i(j,null,{default:o((()=>[i(j,{class:"good_basic"},{default:o((()=>[i(j,{class:"name text-ellipsis"},{default:o((()=>[u(n(k.form.detail.product_name),1)])),_:1})])),_:1})])),_:1}),i(M,{class:"detail","scroll-y":""},{default:o((()=>[i(j,{class:"wrapper"},{default:o((()=>[i(j,{class:"properties"},{default:o((()=>[20==k.form.detail.spec_type?(e(),s(j,{key:0,class:"property"},{default:o((()=>[i(j,{class:"title"},{default:o((()=>[i(P,{class:"name"},{default:o((()=>[u("规格")])),_:1})])),_:1}),i(j,{class:"values"},{default:o((()=>[(e(!0),p(m,null,h(k.form.detail.sku,((t,a)=>(e(),s(j,{class:f(["value",{default:t.checked}]),onClick:e=>C.selecedtSpec(t,a),key:a},{default:o((()=>[u(n(t.spec_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):l("",!0),k.form.detail.product_attr&&k.form.detail.product_attr.length>0?(e(!0),p(m,{key:1},h(k.form.detail.product_attr,((a,r)=>(e(),s(j,{class:"property",key:r},{default:o((()=>[i(j,{class:"title"},{default:o((()=>[i(P,{class:"name"},{default:o((()=>[u(n(a.attribute_name),1)])),_:2},1024)])),_:2},1024),i(j,{class:"values"},{default:o((()=>[""!=t.value?(e(!0),p(m,{key:0},h(a.attribute_value,((t,a)=>(e(),s(j,{class:f(["value",{default:k.form.show_sku.attr[r]==a}]),onClick:e=>C.selectAttr(t,a,r),key:a},{default:o((()=>[u(n(t),1)])),_:2},1032,["onClick","class"])))),128)):l("",!0)])),_:2},1024)])),_:2},1024)))),128)):l("",!0),k.form.detail.product_feed&&k.form.detail.product_feed.length>0?(e(),s(j,{key:2,class:"property"},{default:o((()=>[i(j,{class:"title"},{default:o((()=>[i(P,{class:"name"},{default:o((()=>[u("加料")])),_:1})])),_:1}),i(j,{class:"values"},{default:o((()=>[(e(!0),p(m,null,h(k.form.detail.product_feed,((t,a)=>(e(),s(j,{class:f(["value",{default:null!=k.form.show_sku.feed[a]}]),onClick:e=>C.selectFeed(t,a),key:a},{default:o((()=>[u(" +"+n(t.feed_name),1)])),_:2},1032,["onClick","class"])))),128))])),_:1})])),_:1})):l("",!0)])),_:1})])),_:1})])),_:1}),i(j,{class:"spec-bottom"},{default:o((()=>[i(j,{class:"action"},{default:o((()=>[i(j,{class:"d-c d-a-s"},{default:o((()=>[i(j,{class:"left"},{default:o((()=>[i(j,{class:"price"},{default:o((()=>[i(P,{class:"f22 fb"},{default:o((()=>[u("￥")])),_:1}),i(P,{class:"fb"},{default:o((()=>[u(n(C.price),1)])),_:1}),i(P,{class:"f22 gray9 text-l-t"},{default:o((()=>[u("￥"+n(C.lineprice),1)])),_:1}),i(P,{class:"fb"}),1!=r.bag_type?(e(),s(P,{key:0},{default:o((()=>[i(P,{class:"f24 gray9"},{default:o((()=>[u("(￥"+n(C.bag_price)+")",1)])),_:1})])),_:1})):l("",!0)])),_:1})])),_:1}),i(j,{class:"f22 gray9"},{default:o((()=>[u(n(C.describe()),1)])),_:1})])),_:1}),i(j,{class:"btn-group"},{default:o((()=>[i(x,{type:"default",plain:"",class:"btn theme-borderbtn",size:"min","hover-class":"none",onClick:a[0]||(a[0]=t=>C.sub())},{default:o((()=>[i(j,{class:"icon icon-jian iconfont iconsami-select"})])),_:1}),i(j,{class:"number"},{default:o((()=>[u(n(k.form.show_sku.sum),1)])),_:1}),i(x,{type:"primary",class:"btn theme-btn",size:"min","hover-class":"none",onClick:a[1]||(a[1]=t=>C.add())},{default:o((()=>[i(j,{class:"icon icon-jia iconfont iconadd-select"})])),_:1})])),_:1})])),_:1}),i(j,null,{default:o((()=>[i(j,{class:"add-to-cart-btn",onClick:C.confirmFunc},{default:o((()=>[i(j,null,{default:o((()=>[u("加入购物车")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["show","onCancel"])])),_:1})}],["__scopeId","data-v-264e9a36"]]),j="data:image/png;base64,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",P="/h5/assets/loading-46ffe9ef.gif";export{C as _,j as a,P as b,S as m,A as p};
