import{_ as t,B as a,M as e,G as s,l,p as o,a as i,s as d,o as r,c as n,w as c,n as p,g as u,b as _,d as g,f as h,r as f,F as m,v as y,i as w,k as b,S as D,t as v,e as k,C as x,j as T,h as H}from"./index-1a637619.js";import{u as C}from"./uni-load-more.934e6c66.js";import{_ as F}from"./no-order.6bcf2aa8.js";const S=t({components:{uniLoadMore:C},data:()=>({order_type:0,phoneHeight:0,scrollviewHigh:0,state_active:0,topRefresh:!1,listData:[],dataType:1,order_id:0,last_page:0,page:1,list_rows:10,no_more:!1,loading:!0,isfirst:!1,statusBarHeight:0,titleBarHeight:0,points_name:""}),computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onLoad(t){},mounted(){this.init()},onShow(){this.initData(),this.getData()},methods:{initData(){let t=this;t.page=1,t.listData=[],t.no_more=!1},init(){let t=this;a({success(a){t.phoneHeight=a.windowHeight,e().in(t).select(".top-tabbar").boundingClientRect((a=>{let e=t.phoneHeight-a.height;t.scrollviewHigh=e})).exec()}})},orderStateFunc(t){let a=this;a.loading||a.dataType!=t&&(a.page=1,a.loading=!0,a.listData=[],a.dataType=t,a.getData())},scrolltolowerFunc(){let t=this;t.no_more||(t.page++,t.page<=t.last_page?t.getData():t.no_more=!0)},getData(){let t=this;t.loading=!0,t._get("plus.points.order/lists",{page:t.page,list_rows:t.list_rows,dataType:t.dataType},(function(a){t.loading=!1,t.points_name=a.data.points_name,t.listData=t.listData.concat(a.data.list.data),t.last_page=a.data.list.last_page,a.data.list.last_page<=1?t.no_more=!0:t.no_more=!1,!t.isWeixin()&&a.data.h5_alipay&&(t.showAlipay=!0),t.isfirst=!0}))},gotoOrder(t){this.gotoPage("/pages/plus/points/order/detail?order_id="+t)},orderReceipt(t){let a=this;s({title:"提示",content:"您确定要收货吗?",success:function(e){e.confirm?(l({title:"正在处理"}),a._post("plus.points.order/receipt",{order_id:t},(function(t){o(),i({title:t.msg,duration:2e3,icon:"success"}),a.listData=[],a.getData()}))):i({title:"取消收货",duration:1e3,icon:"none"})}})},addOrder(t,a){d("selectedId",a),this.gotoPage("pages/product/list/store?order_id="+t)}}},[["render",function(t,a,e,s,l,o){const i=u,d=T,C=w,S=H,j=b("uni-load-more"),R=D;return r(),n(i,{"data-theme":t.theme(),class:p(t.theme()||"")},{default:c((()=>[_(i,{class:"top-tabbar"},{default:c((()=>[_(i,{class:"d-a-c ww100 mt24"},{default:c((()=>[_(i,{class:p(1==l.dataType?"tab-item active":"tab-item"),onClick:a[0]||(a[0]=t=>o.orderStateFunc(1))},{default:c((()=>[g("进行中 ")])),_:1},8,["class"]),_(i,{class:p(2==l.dataType?"tab-item active":"tab-item"),onClick:a[1]||(a[1]=t=>o.orderStateFunc(2))},{default:c((()=>[g("已完成 ")])),_:1},8,["class"])])),_:1})])),_:1}),_(R,{"scroll-y":"true",class:"scroll-Y",style:y("height:"+l.scrollviewHigh+"px;"),"lower-threshold":"50",onScrolltolower:o.scrolltolowerFunc},{default:c((()=>[_(i,{class:"order-list"},{default:c((()=>[(r(!0),h(m,null,f(l.listData,((t,a)=>(r(),n(i,{class:"item d-b-s",key:a,onClick:a=>o.gotoOrder(t.order_id)},{default:c((()=>[_(i,{class:"flex-1"},{default:c((()=>[_(i,{class:"d-b-c pb14"},{default:c((()=>[_(i,{class:"state"},{default:c((()=>[_(d,{class:"dominant f26"},{default:c((()=>[g(v(t.state_text),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),_(i,{class:"order-head d-b-c"},{default:c((()=>[_(i,null,{default:c((()=>[_(d,{class:"shop-name flex-1"},{default:c((()=>[g("下单时间："+v(t.create_time),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),_(i,{class:"product-list pr"},{default:c((()=>[_(i,{class:"o-a"},{default:c((()=>[_(i,{class:"list d-s-c pr100"},{default:c((()=>[_(i,{class:"cover mr20"},{default:c((()=>[_(C,{src:t.file_path,mode:"aspectFit"},null,8,["src"]),_(i,{class:"mt10 tc f24 text-ellipsis"},{default:c((()=>[g(v(t.product_name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),_(i,{class:"total-count"},{default:c((()=>[_(i,{class:"price tr"},{default:c((()=>[_(i,null,{default:c((()=>[g(v(t.points_num)+v(l.points_name),1)])),_:2},1024),0!=t.pay_price?(r(),n(i,{key:0},{default:c((()=>[g("¥"+v(t.pay_price),1)])),_:2},1024)):k("",!0)])),_:2},1024),_(i,{class:"count"},{default:c((()=>[g("共"+v(t.total_num)+"件",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),_(i,{class:"order-bts"},{default:c((()=>[20!=t.order_status.value&&20==t.delivery_status.value&&10==t.receipt_status.value?(r(),n(S,{key:0,onClick:x((a=>o.orderReceipt(t.order_id)),["stop"]),class:"theme-borderbtn"},{default:c((()=>[g("确认收货")])),_:2},1032,["onClick"])):k("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128)),0!=l.listData.length||l.loading?(r(),n(j,{key:1,loadingType:o.loadingType},null,8,["loadingType"])):(r(),n(i,{key:0,class:"d-c-c d-c p30"},{default:c((()=>[_(C,{style:{width:"268rpx",height:"263rpx","margin-top":"123rpx"},src:F,mode:"aspectFill"}),_(i,{class:"f26 gray9"},{default:c((()=>[g("暂无记录")])),_:1})])),_:1}))])),_:1})])),_:1},8,["style","onScrolltolower"])])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-5a51fc57"]]);export{S as default};
