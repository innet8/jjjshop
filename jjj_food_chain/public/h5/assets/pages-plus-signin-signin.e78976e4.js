import{_ as t,l as e,p as a,a as s,o as n,c as l,w as i,n as d,g as o,b as u,d as h,t as r,e as y,f as g,r as c,F as f,j as _,h as m}from"./index-1a637619.js";const p=t({data:()=>({loading:!0,weeklist:["日","一","二","三","四","五","六"],daylist:[],year:null,today_year:null,month:null,today_month:null,day:null,today_day:null,list:[],reward:[],days:0,today:0,is_sign:!1,point:[],loadding:!0}),mounted(){this.init(),this.getData()},methods:{getData(){let t=this;e({title:"加载中"}),t._get("plus.sign.sign/index",{},(function(e){t.list=e.data.list[0],t.days=e.data.list[1],t.today=e.data.list[2],t.reward=e.data.arr,t.point=e.data.point,t.list.indexOf(t.day)>=0&&(t.is_sign=!0),t.loadding=!1,a()}))},onSign(){let t=this;if(t.is_sign)return s({title:"今天已签到",duration:2e3}),!1;e({title:"正在提交",mask:!0}),t._get("plus.sign.sign/add",{},(function(e){a(),t.showSuccess(e.data.msg,(function(){t.getData()}))}))},init(){if(null===this.year&&null===this.month&&null===this.day){let t=new Date;this.year=t.getFullYear(),this.today_year=t.getFullYear(),this.month=t.getMonth(),this.today_month=t.getMonth()+1,this.day=t.getDate(),this.today_day=t.getDate()}this.joinDay()},joinDay(){let t=[],e=this.getMonthCount(this.year,this.month),a=this.getPreMonthCount(this.year,this.month),s=this.getNextMonthCount(this.year,this.month),n=this.getWeekday(this.year,this.month),l=[];0!=n&&(l=a.slice(-1*n));let i=s.slice(0,42-e.length-n),d=this.numConvertNode(l,"pre"),o=this.numConvertNode(e,null),u=this.numConvertNode(i,"next");t=[].concat(d,o,u),this.daylist=t},numConvertNode(t,e){let a=0,s=[],n=t.length;null!=e&&("pre"==e?a=-1:(a=1,n>7&&(n-=7)));for(let l=0;l<n;l++){let e={type:a,day:t[l]};s.push(e)}return s},isLeapYear:t=>t%400==0||t%100!=0&&t%4==0,getMonthCount(t,e){let a=[31,null,31,30,31,30,31,31,30,31,30,31][e]||(this.isLeapYear(t)?29:28);return Array.from(new Array(a),((t,e)=>e+1))},getWeekday:(t,e)=>new Date(t,e,1).getDay(),getPreMonthCount(t,e){return 0===e?this.getMonthCount(t-1,11):this.getMonthCount(t,e-1)},getNextMonthCount(t,e){return 11===e?this.getMonthCount(t+1,0):this.getMonthCount(t,e+1)},gotoRuleFunc(){this.gotoPage("/pages/plus/signin/rule/rule")}}},[["render",function(t,e,a,s,p,w){const k=_,C=o,b=m;return n(),l(C,{"data-theme":t.theme(),class:d(t.theme()||"")},{default:i((()=>[p.loadding?y("",!0):(n(),l(C,{key:0,class:"signin-container theme-bg"},{default:i((()=>[u(C,{class:"sigin-title d-c-c"},{default:i((()=>[u(k,null,{default:i((()=>[h("签到有礼")])),_:1})])),_:1}),u(C,{class:"sign-main"},{default:i((()=>[u(C,{class:"sign-main-bg theme-bg"},{default:i((()=>[u(C,{class:"sign-head f28"},{default:i((()=>[p.reward.length>0&&p.reward[0]>=1?(n(),l(C,{key:0,class:"small"},{default:i((()=>[h(" (再签到 "),u(k,{class:"p-0-10 white fb"},{default:i((()=>[h(r(p.reward[0]),1)])),_:1}),h(" 天可得到 "),u(k,{class:"p-0-10 white fb"},{default:i((()=>[h(r(p.point[p.reward[0]]),1)])),_:1}),h(" 积分) ")])),_:1})):y("",!0),p.reward.length>0&&1==p.reward[0]&&!p.is_sign?(n(),l(C,{key:1,class:"small"},{default:i((()=>[h("(今天签到即可得到额外奖励)")])),_:1})):y("",!0)])),_:1}),u(C,{class:"sign-calendar-wrap"},{default:i((()=>[u(C,{class:"date-text dominant"},{default:i((()=>[h(r(p.today_year)+"年"+r(p.today_month)+"月",1)])),_:1}),u(C,{class:"week-list"},{default:i((()=>[(n(!0),g(f,null,c(p.weeklist,((t,e)=>(n(),l(C,{class:"week-item",key:e},{default:i((()=>[h(r(t),1)])),_:2},1024)))),128))])),_:1}),u(C,{class:"date-list-wrap"},{default:i((()=>[(n(!0),g(f,null,c(p.daylist,((t,e)=>(n(),l(C,{class:d(["date-item",0!=t.type?"secondary-date-item":""]),key:e},{default:i((()=>[p.list.indexOf(t.day)>-1&&0==t.type?(n(),l(k,{key:0,class:"icon-box theme-bg"},{default:i((()=>[h(r(t.day),1)])),_:2},1024)):y("",!0),-1==p.list.indexOf(t.day)?(n(),g(f,{key:1},[p.reward.indexOf(t.day-p.today)>-1&&0==t.type?(n(),l(k,{key:0,class:"iconfont icon-libao dominant"})):y("",!0),0==t.type&&-1==p.reward.indexOf(t.day-p.today)?(n(),l(C,{key:1},{default:i((()=>[u(k,null,{default:i((()=>[h(r(t.day),1)])),_:2},1024)])),_:2},1024)):y("",!0)],64)):y("",!0)])),_:2},1032,["class"])))),128))])),_:1})])),_:1})])),_:1}),u(C,{class:"pt30 d-c-c f34 white"},{default:i((()=>[h(" 你已经累计签到 "),u(k,{class:"p-0-10 white fb"},{default:i((()=>[h(r(p.days),1)])),_:1}),h(" 天 ")])),_:1}),u(C,{class:"btns"},{default:i((()=>[p.is_sign?(n(),l(b,{key:1,class:"shadowbtn",type:"primary"},{default:i((()=>[h("今日已签到")])),_:1})):(n(),l(b,{key:0,class:"shadowbtn",type:"primary",onClick:w.onSign},{default:i((()=>[h("立即签到")])),_:1},8,["onClick"]))])),_:1})])),_:1}),u(C,{class:"rule-btn shadowbtn",onClick:w.gotoRuleFunc},{default:i((()=>[h("活动规则")])),_:1},8,["onClick"])])),_:1}))])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-666187e9"]]);export{p as default};
