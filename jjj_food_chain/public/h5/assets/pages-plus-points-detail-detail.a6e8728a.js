import{_ as t,a as s,o as e,c as o,w as a,b as c,C as i,d as l,t as d,f as u,F as n,e as p,n as r,g as _,i as f,j as m,h,l as b,u as k,p as g,k as P}from"./index-1a637619.js";import{P as y}from"./uni-popup.bcc5e38f.js";/* empty css                                                                  */const v=t({components:{spec:t({data:()=>({Visible:!1,form:{},sum:1,stock:0,selectSpec:"",isAll:!1,is_change:!1}),props:["isPopup","productModel"],onLoad(){},mounted(){},computed:{isadd:function(){return this.sum>=this.stock||this.sum>=this.form.limit_num},issub:function(){return this.sum<=1}},watch:{isPopup:function(t,s){t!=s&&(this.Visible=t,this.isOpenSpec||(this.form=this.productModel,this.isOpenSpec=!0))}},methods:{closePopup(){this.$emit("close",this.form.specData,null)},confirmFunc(){null==this.form.specData||this.isAll?this.createdOrder():s({title:"请选择规格",icon:"none",duration:2e3})},updateSpecProduct(){},createdOrder(){let t=this,s=t.form.product_id,e=t.sum;t.gotoPage("/pages/order/points-order?product_num="+e+"&product_id="+s+"&order_type=points")},add(){if(!(this.form.product_stock<=0))return this.sum>=this.form.product_stock?(s({title:"数量超过了库存",icon:"none",duration:2e3}),!1):0!=this.form.limit_num&&this.sum>=this.form.limit_num?(s({title:"数量超过了限购数量",icon:"none",duration:2e3}),!1):void this.sum++},sub(){if(!(this.form.product_stock<=0))return this.sum<2?(s({title:"商品数量至少为1",icon:"none",duration:2e3}),!1):void this.sum--}}},[["render",function(t,s,b,k,g,P){const y=_,v=f,C=m,w=h;return e(),o(y,{"data-theme":t.theme(),class:r(t.theme()||"")},{default:a((()=>[c(y,{class:r(g.Visible?"product-popup open":"product-popup close"),onTouchmove:s[4]||(s[4]=i((()=>{}),["stop","prevent"])),onClick:P.closePopup},{default:a((()=>[c(y,{class:"popup-bg"}),c(y,{class:"main",onClick:s[3]||(s[3]=i((()=>{}),["stop"]))},{default:a((()=>[c(y,{class:"header"},{default:a((()=>[c(v,{src:g.form.file_path,mode:"aspectFit",class:"avt"},null,8,["src"]),c(y,{class:"price d-s-c gray9"},{default:a((()=>[c(C,{class:""},{default:a((()=>[l("所需积分")])),_:1}),c(C,{class:"f30 dominant"},{default:a((()=>[l(d(g.form.product_points*g.sum),1)])),_:1}),g.form.product_price>0?(e(),u(n,{key:0},[c(C,null,{default:a((()=>[l("+")])),_:1}),c(C,{class:"old-price dominant"},{default:a((()=>[l(d(g.form.product_price*g.sum),1)])),_:1}),c(C,null,{default:a((()=>[l("元")])),_:1})],64)):p("",!0)])),_:1}),c(y,{class:"stock"},{default:a((()=>[l("库存："+d(g.form.product_stock),1)])),_:1}),c(y,{class:"close-btn",onClick:P.closePopup},{default:a((()=>[c(C,{class:"icon iconfont icon-jiantoushang"})])),_:1},8,["onClick"])])),_:1}),c(y,{class:"body"},{default:a((()=>[c(y,{class:"level-box count_choose"},{default:a((()=>[c(C,{class:"key"},{default:a((()=>[l("数量")])),_:1}),c(y,{class:"btn-group"},{default:a((()=>[c(w,{type:"default",plain:"",class:"btn theme-borderbtn",size:"min","hover-class":"none",onClick:s[0]||(s[0]=t=>P.sub())},{default:a((()=>[c(y,{class:"icon icon-jian iconfont iconsami-select"})])),_:1}),c(y,{class:"number"},{default:a((()=>[l(d(g.sum),1)])),_:1}),c(w,{type:"primary",class:"btn theme-btn",size:"min","hover-class":"none",onClick:s[1]||(s[1]=t=>P.add())},{default:a((()=>[c(y,{class:"icon icon-jia iconfont iconadd-select"})])),_:1})])),_:1})])),_:1})])),_:1}),c(y,{class:"btns white"},{default:a((()=>[c(w,{class:"theme-btn",onClick:s[2]||(s[2]=t=>P.confirmFunc(g.form))},{default:a((()=>[l("确认")])),_:1})])),_:1})])),_:1})])),_:1},8,["class","onClick"])])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-a00e1ba5"]]),uniPopup:y},data:()=>({phoneHeight:0,scrollviewHigh:0,loadding:!0,product_id:null,detail:{product_sku:{},show_sku:{product_price:"",product_sku_id:0,line_price:"",stock_num:0,sku_image:""},show_point_sku:{}},isPopup:!1,productModel:{},productSku:[],isMpservice:!1,serverList:"",isguarantee:!1,shop_info:{},store_open:1}),onLoad(t){this.product_id=t.product_id},mounted(){this.getData()},methods:{getData(){let t=this,s=t.product_id;b({title:"加载中"}),t._get("plus.points.product/detail",{product_id:s},(function(s){s.data.detail.content=k.format_content(s.data.detail.content),t.detail=s.data.detail,t.loadding=!1,g()}))},openPopup(){this.isPopup=!0},closePopup(t,s){this.isPopup=!1}}},[["render",function(t,s,i,b,k,g){const y=f,v=_,C=m,w=h,M=P("spec");return k.loadding?p("",!0):(e(),o(v,{key:0,class:r(["product-detail",t.theme()||""]),"data-theme":t.theme()},{default:a((()=>[c(v,{class:"product-pic"},{default:a((()=>[c(y,{src:k.detail.file_path,mode:"aspectFit"},null,8,["src"])])),_:1}),c(v,{class:"bg-white"},{default:a((()=>[c(v,{class:"product-name"},{default:a((()=>[l(d(k.detail.product_name),1)])),_:1}),c(v,{class:"price-wrap"},{default:a((()=>[c(v,{class:"flex-1 d-s-s d-c"},{default:a((()=>[c(v,{class:"new-price gray9 f24"},{default:a((()=>[c(C,{class:"dominant f26"},{default:a((()=>[l(d(k.detail.product_points),1)])),_:1}),c(C,null,{default:a((()=>[l(" 积分")])),_:1}),k.detail.product_price>0?(e(),u(n,{key:0},[c(C,{class:"gray9"},{default:a((()=>[l("+")])),_:1}),c(C,{class:"num dominant f26"},{default:a((()=>[l(d(k.detail.product_price),1)])),_:1}),c(C,{class:"gray9"},{default:a((()=>[l(" 元")])),_:1})],64)):p("",!0)])),_:1})])),_:1}),c(v,{class:"already-sale"},{default:a((()=>[l("剩余"),c(C,{class:"dominant"},{default:a((()=>[l(d(k.detail.product_stock),1)])),_:1}),l("件")])),_:1})])),_:1})])),_:1}),c(v,{class:"product-content"},{default:a((()=>[c(v,{class:"group-hd border-b-e"},{default:a((()=>[c(v,{class:"left"},{default:a((()=>[c(C,{class:"min-name"},{default:a((()=>[l("商品介绍")])),_:1})])),_:1})])),_:1}),c(v,{class:"content-box p30",innerHTML:k.detail.content},null,8,["innerHTML"])])),_:1}),c(v,{class:"btns-wrap"},{default:a((()=>[c(w,{type:"primary",class:"theme-btn",onClick:s[0]||(s[0]=t=>g.openPopup())},{default:a((()=>[l("立即抢购")])),_:1})])),_:1}),c(M,{isPopup:k.isPopup,productModel:k.detail,onClose:g.closePopup},null,8,["isPopup","productModel","onClose"])])),_:1},8,["data-theme","class"]))}],["__scopeId","data-v-38bb3343"]]);export{v as default};
