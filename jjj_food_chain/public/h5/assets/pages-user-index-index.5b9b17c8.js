import{_ as e,s as a,J as t,a as s,l as i,p as l,m as n,K as c,o as d,c as o,w as u,n as r,g as p,b as g,C as m,d as f,t as A,e as b,f as h,r as _,F as k,i as y,j as v,h as U,I as D,L as I,k as x}from"./index-1a637619.js";import{U as N}from"./upload.9fbd7ae5.js";import{_ as Z}from"./log-vip.fbbbbf27.js";const P=e({components:{Upload:N},data:()=>({isloadding:!0,sign:{},loadding:!0,indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,menus:[],detail:{balance:0,points:0,grade:{name:""},mobile:""},orderCount:{},coupon:0,setting:{},card_detail:null,sessionKey:"",urldata:"",isPopup:!1,avatarUrl:"",nickName:"",imageList:[],isUpload:!1}),onPullDownRefresh(){this.getData()},onLoad(e){this.isWeixin()&&(this.urldata=window.location.href),e.invitation_id&&a("invitation_id",e.invitation_id),e.referee_id&&a("referee_id",e.referee_id)},onShow(){this.getData()},methods:{changeAvatarUrl(){this.isUpload=!0},changeInfo(){this.avatarUrl=this.detail.avatarUrl,this.nickName=this.detail.nickName,this.isPopup=!0},getData(){let e=this;e.isloadding=!0,e._get("user.index/detail",{url:e.urldata},(function(a){e.detail=a.data.userInfo,e.sign=a.data.sign,e.coupon=a.data.coupon,e.menus=a.data.menus,e.setting=a.data.setting,e.loadding=!1,e.card_detail=a.data.cardDetail,t(),e.isloadding=!1,""!=e.urldata&&(e.jweixin=e.configWxScan(a.data.signPackage))}))},bindMobile(){this.gotoPage("/pages/user/modify-phone/modify-phone")},jumpPage(e){let a=this;a.isloadding||(e.startsWith("/")?a.gotoPage(e):a[e]())},toinvitation(e){0==e?s({title:"暂无活动"}):this.gotoPage("/pages/user/invite/invite?invitation_gift_id="+e)},scanQrcode:function(){this.gotoPage("/pages/user/scan/scan")},receipt:function(){let e=this;this.isWeixin()?e.jweixin.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){window.location.href=e.resultStr},error:function(e){s({title:"扫码失败，请重试"})}}):console.log("H5暂只支持公众号扫码")},getQr(e){for(var a=e.substring(e.indexOf("?")+1).split("&"),t=[],s=0;s<a.length;s++){var i=a[s].split("=");i.length<2?t[i[0]]="":t[i[0]]=i[1]}return"/pages/order/group/receipt?scene="+t.scene},getPhoneNumber(e){var a=this;if("getPhoneNumber:ok"!==e.detail.errMsg)return!1;i({title:"加载中"}),a._post("user.user/bindMobile",{session_key:a.sessionKey,encrypted_data:e.detail.encryptedData,iv:e.detail.iv},(e=>{s({title:"绑定成功"}),a.getData()}),!1,(()=>{l()}))},copyFunc(e){var a=document.createElement("input");a.value=e,document.body.appendChild(a),a.select(),a.setSelectionRange(0,a.value.length),document.execCommand("Copy"),document.body.removeChild(a),s({title:"复制成功",icon:"success",mask:!0,duration:2e3})},onChooseAvatar(e){console.log(e),this.uploadFile([e.detail.avatarUrl])},uploadFile:function(e){let a=this,t=0,s=e.length,d={token:n("token"),app_id:a.getAppId()};i({title:"图片上传中"}),e.forEach((function(e,i){c({url:a.websiteUrl+"/index.php?s=/api/file.upload/image",filePath:e,name:"iFile",formData:d,success:function(e){let t="object"==typeof e.data?e.data:JSON.parse(e.data);1===t.code?a.imageList.push(t.data):a.showError(t.msg)},complete:function(){t++,s===t&&(l(),a.getImgsFunc(a.imageList))}})}))},getImgsFunc(e){if(e&&void 0!==e){let a=this;a.avatarUrl=e[0].file_path,a.isUpload=!1}},changeinput(e){this.nickName=e.target.value},closeFunc(e){this.isPopup=!1},subName(e){let a=this;if(a.loading)return;i({title:"加载中"});let t={avatarUrl:a.avatarUrl,nickName:e.detail.value.nickName};a.loading=!0,a._post("user.user/updateInfo",t,(function(e){a.showSuccess("修改成功",(function(){a.loading=!1,a.isPopup=!1,l(),a.getData()}),(function(e){l(),a.loading=!1,a.isPopup=!1}))}))}}},[["render",function(e,a,t,s,i,l){const n=y,c=p,N=v,P=U,G=D,M=I,C=x("Upload");return d(),o(c,{class:r(["user-index pb60",e.theme()||""]),"data-theme":e.theme()},{default:u((()=>[i.loadding?b("",!0):(d(),o(c,{key:0},{default:u((()=>[g(c,{class:"user-header pr theme-bg"},{default:u((()=>[g(n,{class:"bg-img",src:"/h5/assets/bg-user-7d7e4f6a.png",mode:""}),g(n,{class:"bg-img2",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAAeCAYAAABzEJv6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ppVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDowMTFiZWIxYS1iNWZjLWQwNGYtODBhNy1kN2E5NGJjYjYyNDUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUUxRDgyM0I1OEZEMTFFREI4ODFBN0ZCMjc2MDVFMzQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUUxRDgyM0E1OEZEMTFFREI4ODFBN0ZCMjc2MDVFMzQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoxOTBFMDZFQzU4RkExMUVEQTk0MkMyODFGMjBGREM3MSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxOTBFMDZFRDU4RkExMUVEQTk0MkMyODFGMjBGREM3MSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pqy46EcAAATYSURBVHja7N0LUxNXGMbxTbiYUJSkaICqbbR2erGdafv9v0JnOlN7nU5LLRY1QUKxhIskPa95Tnm7ZheQABvy/8087tkLCAdMnqzLUur3+wkAAACAYiszBQAAAEDxTbfb7UpY7jIVAAAAQGFVpsMf2yE/hXzr8k1Ih/kBAAAALlwt5OuQr0K+VD4ptVqtrIvcV0N+CPku5HvF1jk7DwAAAJydXfnyWchD5QutN4cdnFfchzkM+c2V+Uda/hJywNwDAAAAb5gJ+SjkcyWW9PshUyd9J6ct7ln2Q35OBmfkH2kcs8fXCgAAABPgWsjHLvFMuo1nz/rOR1Xcs/SSwSU3VuB/dGXexs/52gIAAGAMNUI+dQU9jpvJOd618byLe57NIYX+V4Xr6AEAAHCZ7PrzB0q6oNcv4wO6zOKexT6eNVfi09nh+wgAAAAjMOfKeTp3rCsX6YMtYnE/zpOMQv97yBbffwAAAHAWQu5llPPb4/SJjGNxz/NCBX41Gdz9ZlXrcRuX4AAAAFwtdklLU+X8nsb3tbQsXpVP9KoV9+OsZxR622Zn8rmlJQAAQLHYrRRvuzKeLugrkzIRk1bc8/RU7P8I+dNl1Y3bTBMAAMBI3Qy5q3wQ8n5q3Yp5mWlKkmmm4D9lvZrLu9apmyrysdivufUuUwkAAPBa1ZVw+2HPplu/q/Uq03QynHEfPbvN5V8q8eta2voTxcbPmCYAADDmlpLB2XAr5Hbi8z2V8RUtbb3ONI0OZ9xHr648zDlm35X5NRX8xyFPte2Zli+ZTgAAcMHmVcSXtFxOBpevpEv6LFNFcZ8E9o3eVPLsqNSvq9Svu1L/PDk6e2/pMa0AACBDWUV8SaW74cr5isr5svbNMV0Ud5ye/cP5UMlzqCLvS72V/JYSy31cP2RqAQAYe1Mht5RYyuP6SqqcN3Q8xhjXuE+mlstTFf2WK/9xn5X/baYLAIALc12l2xfyhsa2XHb77G4sJaZscnDGfTLFf/AnYb+0akNpq9C3U9s2VPrj+g5TDADA6/85t3K9qNK9qNx0y1tu3VJh2kBxx9uyB5DjbpOZ1nUlPpb9uG6/3XZTSz+25SumGwBQ0L5kN5541y39OKuIc5tDUNxRePZAdUc5jb+HlPmN1Lov/JaO3g4AgOPcCFnIKeB1Fe50Sb/B1IHiDrz5gGppnvLteirwHVfmfbZcwd9y6bgxZ/sBoPidZUGpufGCnjtqbp9P3Y357ZuguAOXzB6I41mTt/WPCvy2Eov+yxNs23bh3vsA8H92T/DrLjU3nnelO2+bFfJ3mEpQ3AEkekIYxZNCP6PMW+Hv6gVCR2PLphvb9h0lvkDoJtzZB8DFsZJcdeV5Tqlpu6XuxjU9dlZ1/LCSzl1PAIo7UEil5Oi3547Stkp8fBGw64r9rra9Uvk/0D57AbCX2revFw9+nx2/xZcOKDw76zyjgnxNhdpK86wK8nRq37yO9/sqrphXXNmuqmgDoLgDOKN49qpxjn9HLPWx+Pdcod/U0or+ofYfuBcAexrnvW081r+f+D8U5qBcLnGpEQqn1+vHApwkR2eQp5KjH1iMRTlxL9qtZJddeZ7TcfHYGe3z7yfrbWM5BzDpxT08UTILABIVg1gOGkwHMMDzJIDCPB4xBQAAAEDx/SvAAIpGdNQNoJCJAAAAAElFTkSuQmCC",mode:""}),""!=i.card_detail?(d(),o(c,{key:0,class:"card-box d-b-c",onClick:a[0]||(a[0]=m((e=>l.jumpPage("/pages/order/card?state_active=1&order_id="+i.card_detail.order_id)),["stop"]))},{default:u((()=>[g(c,{class:"d-s-c"},{default:u((()=>[g(n,{class:"v-log",src:Z,mode:""}),f(" "+A(i.card_detail.card.card_name)+A(i.card_detail.expire_time_text),1)])),_:1}),g(c,{class:"btn-card-box"},{default:u((()=>[f("查看详情"),g(N,{class:"icon iconfont icon-jiantou"})])),_:1})])),_:1})):(d(),o(c,{key:1,class:"card-box d-b-s",onClick:a[1]||(a[1]=m((e=>l.jumpPage("/pages/user/card/list")),["stop"]))},{default:u((()=>[g(c,{class:"d-s-c"},{default:u((()=>[g(n,{class:"v-log",src:Z,mode:""}),f("领取会员卡，各种优惠享不停 ")])),_:1}),g(c,{class:"btn-card-box"},{default:u((()=>[f("立即领取"),g(N,{class:"icon iconfont icon-jiantou"})])),_:1})])),_:1})),g(c,{class:"user-header-inner"},{default:u((()=>[g(c,{class:"user-info"},{default:u((()=>[g(c,{class:"photo",onClick:l.changeInfo},{default:u((()=>[g(n,{src:i.detail.avatarUrl,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"]),g(c,{class:"info d-c d-c-s"},{default:u((()=>[g(c,{class:"d-c-c"},{default:u((()=>[g(c,{class:"name"},{default:u((()=>[f(A(i.detail.nickName),1)])),_:1}),i.detail.grade?(d(),o(N,{key:0,class:"ml10"},{default:u((()=>[f(A(i.detail.grade.name),1)])),_:1})):b("",!0)])),_:1}),g(c,{class:"tel d-s-c"},{default:u((()=>[g(N,{class:"f26"},{default:u((()=>[f("用户ID:"+A(i.detail.user_id),1)])),_:1}),g(N,{class:"copy-btn",onClick:a[2]||(a[2]=e=>l.copyFunc(i.detail.user_id+""))},{default:u((()=>[f("复制")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),g(c,{class:"my-order"},{default:u((()=>[g(c,{class:"order-top"},{default:u((()=>[g(c,{class:"order-title"},{default:u((()=>[f("我的订单")])),_:1}),g(c,{class:"order-all",onClick:a[3]||(a[3]=a=>e.gotoPage("/pages/order/myorder"))},{default:u((()=>[f("全部订单"),g(N,{class:"icon iconfont icon-jiantou"})])),_:1})])),_:1}),g(c,{class:"list d-a-c flex-1"},{default:u((()=>[g(c,{class:"item d-c-c d-c",onClick:a[4]||(a[4]=a=>e.gotoPage("/pages/user/my-wallet/my-wallet"))},{default:u((()=>[g(c,{class:"red_mini"},{default:u((()=>[f(A(i.detail.balance),1)])),_:1}),g(N,{class:"pt16 f28 gray3"},{default:u((()=>[f("金额"),g(N,{class:"f22 gray9"},{default:u((()=>[f("(元)")])),_:1})])),_:1})])),_:1}),g(c,{class:"item d-c-c d-c",onClick:a[5]||(a[5]=a=>e.gotoPage("/pages/user/points/points"))},{default:u((()=>[g(c,{class:"red_mini"},{default:u((()=>[f(A(i.detail.points),1)])),_:1}),g(N,{class:"pt16 f28 gray3"},{default:u((()=>[f(A(i.setting.points_name),1)])),_:1})])),_:1}),g(c,{class:"item d-c-c d-c",onClick:a[6]||(a[6]=a=>e.gotoPage("/pages/user/my-coupon/my-coupon"))},{default:u((()=>[g(c,{class:"red_mini"},{default:u((()=>[f(A(i.coupon),1)])),_:1}),g(N,{class:"pt16 f28 gray3"},{default:u((()=>[f("优惠券")])),_:1})])),_:1})])),_:1})])),_:1}),i.detail.mobile?b("",!0):(d(),o(c,{key:0,class:"bind_phone"},{default:u((()=>[g(c,{class:"bind_content"},{default:u((()=>[g(c,{class:"bind_txt"},{default:u((()=>[f("点击绑定手机号，确保账户安全")])),_:1}),g(P,{class:"bind_btn theme-btn",onClick:l.bindMobile},{default:u((()=>[f("去绑定")])),_:1},8,["onClick"])])),_:1})])),_:1})),g(c,{class:"menu-wrap"},{default:u((()=>[g(c,{class:"order-top"},{default:u((()=>[g(c,{class:"order-title"},{default:u((()=>[f("服务功能")])),_:1})])),_:1}),g(c,{class:"group-bd f-w"},{default:u((()=>[(d(!0),h(k,null,_(i.menus,((e,a)=>(d(),h(k,{key:a},[1==e.status?(d(),o(c,{key:0,class:"item",onClick:a=>l.jumpPage(e.link_url)},{default:u((()=>[g(c,{class:"icon-round d-c-c"},{default:u((()=>[g(n,{class:"icon-round",src:e.image_url,mode:"aspectFit"},null,8,["src"])])),_:2},1024),g(N,{class:"name"},{default:u((()=>[f(A(e.title),1)])),_:2},1024)])),_:2},1032,["onClick"])):b("",!0)],64)))),128))])),_:1})])),_:1})])),_:1})),i.isPopup?(d(),h(k,{key:1},[g(c,{class:"pop-bg",onClick:a[7]||(a[7]=e=>l.closeFunc(null))}),g(c,{class:"pop-input d-c d-c-c"},{default:u((()=>[g(M,{onSubmit:l.subName},{default:u((()=>[g(c,{class:"ww100 flex-1 pop-top"},{default:u((()=>[g(N,{class:"icon iconfont icon-guanbi",onClick:a[8]||(a[8]=e=>l.closeFunc(null))}),g(c,{class:"pop-title tc"},{default:u((()=>[f("资料修改")])),_:1}),g(c,{class:"d-c-c",style:{"margin-bottom":"30rpx"}},{default:u((()=>[g(c,{class:"info-image"},{default:u((()=>[g(c,{class:"d-e-c",onClick:l.changeAvatarUrl},{default:u((()=>[g(n,{src:i.avatarUrl||"/static/login-log.jpg",mode:""},null,8,["src"])])),_:1},8,["onClick"])])),_:1})])),_:1}),g(c,{class:"input-box d-c-c"},{default:u((()=>[f(" 昵称 "),g(G,{type:"nickname",name:"nickName",value:i.nickName,onInput:l.changeinput},null,8,["value","onInput"])])),_:1})])),_:1}),g(P,{class:"d-c-c pop-btn theme-btn","form-type":"submit"},{default:u((()=>[f("确认")])),_:1})])),_:1},8,["onSubmit"])])),_:1})],64)):b("",!0),i.isUpload?(d(),o(C,{key:2,num:1,onGetImgs:l.getImgsFunc},null,8,["onGetImgs"])):b("",!0)])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-8063da5a"]]);export{P as default};
