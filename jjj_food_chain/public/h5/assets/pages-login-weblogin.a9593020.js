import{_ as e,B as s,a as l,l as o,s as t,z as a,p as d,m as i,o as n,c as r,w as u,v as p,g as c,b as _,d as f,t as m,e as g,n as b,j as w,I as h,h as x}from"./index-1a637619.js";const y=e({data:()=>({formData:{mobile:"",code:""},loging_password:"",register:{mobile:"",password:"",repassword:"",code:""},resetpassword:{mobile:"",password:"",repassword:"",code:""},is_send:!1,send_btn_txt:"获取验证码",second:60,ip:"",isShow:!0,is_login:1,is_code:!0,phoneHeight:0,sms_open:!1}),onLoad(){},onShow(){this.getCodeType(),this.init()},methods:{getCodeType(){let e=this;e._post("index/loginSetting",{},(s=>{e.sms_open=s.data.setting.sms_open,e.is_code=e.sms_open}))},init(){let e=this;s({success(s){e.phoneHeight=s.windowHeight}})},formSubmit(){let e=this,s={mobile:e.formData.mobile},i="";if(/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile)){if(e.is_code){if(""==e.formData.code)return void l({title:"验证码不能为空！",duration:2e3,icon:"none"});s.code=e.formData.code,i="user.useropen/smslogin"}else{if(""==e.loging_password)return void l({title:"密码不能为空！",duration:2e3,icon:"none"});s.password=e.loging_password,i="user.useropen/phonelogin"}o({title:"正在提交"}),e._post(i,s,(e=>{t("token",e.data.token),t("user_id",e.data.user_id),a({delta:2})}),!1,(()=>{d()}))}else l({title:"手机有误,请重填！",duration:2e3,icon:"none"})},registerSub(){let e=this;/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile)?""==e.register.code&&e.sms_open?l({title:"验证码不能为空！",duration:2e3,icon:"none"}):e.register.password.length<6?l({title:"密码至少6位数！",duration:2e3,icon:"none"}):e.register.password===e.register.repassword?(e.register.invitation_id=i("invitation_id")||0,e.register.referee_id=i("referee_id")||0,o({title:"正在提交"}),e._post("user.useropen/register",e.register,(s=>{l({title:"注册成功",duration:3e3}),e.formData.mobile=e.register.mobile,e.register={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{d()}))):l({title:"两次密码输入不一致！",duration:2e3,icon:"none"}):l({title:"手机有误,请重填！",duration:2e3,icon:"none"})},resetpasswordSub(){let e=this;/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile)?""!=e.resetpassword.code?e.resetpassword.password.length<6?l({title:"密码至少6位数！",duration:2e3,icon:"none"}):e.resetpassword.password===e.resetpassword.repassword?(o({title:"正在提交"}),e._post("user.useropen/resetpassword",e.resetpassword,(s=>{l({title:"重置成功",duration:3e3}),e.formData.mobile=e.resetpassword.mobile,e.resetpassword={mobile:"",password:"",repassword:"",code:""},e.second=0,e.changeMsg(),e.is_login=1}),!1,(()=>{d()}))):l({title:"两次密码输入不一致！",duration:2e3,icon:"none"}):l({title:"验证码不能为空！",duration:2e3,icon:"none"}):l({title:"手机有误,请重填！",duration:2e3,icon:"none"})},isCode(){this.is_code?this.$set(this,"is_code",!1):this.$set(this,"is_code",!0)},sendCode(){let e=this;if(1==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.formData.mobile))return void l({title:"手机有误,请重填！",duration:2e3,icon:"none"})}else if(2==e.is_login){if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.register.mobile))return void l({title:"手机有误,请重填！",duration:2e3,icon:"none"})}else if(0==e.is_login&&!/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.resetpassword.mobile))return void l({title:"手机有误,请重填！",duration:2e3,icon:"none"});let s="register",o=e.register.mobile;1==e.is_login?(s="login",o=e.formData.mobile):0==e.is_login&&(s="login",o=e.resetpassword.mobile),e._post("user.useropen/sendCode",{mobile:o,type:s},(s=>{1==s.code&&(l({title:"发送成功"}),e.is_send=!0,e.changeMsg())}))},changeMsg(){this.second>0?(this.send_btn_txt=this.second+"秒",this.second--,setTimeout(this.changeMsg,1e3)):(this.send_btn_txt="获取验证码",this.second=60,this.is_send=!1)}}},[["render",function(e,s,l,o,t,a){const d=c,i=w,y=h,k=x;return n(),r(d,{class:"login-container",style:p("height: "+t.phoneHeight+"px;")},{default:u((()=>[_(d,{class:"skip",onClick:s[0]||(s[0]=s=>e.gotoPage("/pages/index/index"))},{default:u((()=>[f("跳过→")])),_:1}),2==t.is_login?(n(),r(d,{key:0,class:"p-30-75"},{default:u((()=>[_(d,{class:"login_topbpx"},{default:u((()=>[_(d,{class:"login_tit"},{default:u((()=>[f("注册")])),_:1}),_(d,{class:"login_top"},{default:u((()=>[f("已有账户，"),_(i,{class:"red",onClick:s[1]||(s[1]=e=>t.is_login=1)},{default:u((()=>[f("立即登录")])),_:1})])),_:1})])),_:1}),_(d,{class:"group-bd"},{default:u((()=>[_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",modelValue:t.register.mobile,"onUpdate:modelValue":s[2]||(s[2]=e=>t.register.mobile=e),placeholder:"请填写手机号",disabled:t.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",password:"true",modelValue:t.register.password,"onUpdate:modelValue":s[3]||(s[3]=e=>t.register.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1}),_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",password:"true",modelValue:t.register.repassword,"onUpdate:modelValue":s[4]||(s[4]=e=>t.register.repassword=e),placeholder:"请确认密码"},null,8,["modelValue"])])),_:1})])),_:1}),t.sms_open?(n(),r(d,{key:0,class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(y,{class:"flex-1",type:"number",modelValue:t.register.code,"onUpdate:modelValue":s[5]||(s[5]=e=>t.register.code=e),placeholder:"请填写验证码"},null,8,["modelValue"]),_(k,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[f(m(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1})):g("",!0),1==t.is_login?(n(),r(d,{key:1,class:"p-30-75"},{default:u((()=>[_(d,{class:"login_topbpx"},{default:u((()=>[_(d,{class:"login_tit"},{default:u((()=>[f("登录")])),_:1}),_(d,{class:"login_top"},{default:u((()=>[f("还没有账号，"),_(i,{class:"red",onClick:s[6]||(s[6]=e=>t.is_login=2)},{default:u((()=>[f("立即注册")])),_:1})])),_:1})])),_:1}),_(d,{class:"group-bd"},{default:u((()=>[_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",modelValue:t.formData.mobile,"onUpdate:modelValue":s[7]||(s[7]=e=>t.formData.mobile=e),placeholder:"请填写手机号"},null,8,["modelValue"])])),_:1})])),_:1}),t.is_code?g("",!0):(n(),r(d,{key:0,class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",password:"true",modelValue:t.loging_password,"onUpdate:modelValue":s[8]||(s[8]=e=>t.loging_password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1})),t.is_code&&t.sms_open?(n(),r(d,{key:1,class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(y,{class:"flex-1",type:"number",modelValue:t.formData.code,"onUpdate:modelValue":s[9]||(s[9]=e=>t.formData.code=e),placeholder:"请填写验证码"},null,8,["modelValue"]),_(k,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[f(m(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1})):g("",!0),0==t.is_login?(n(),r(d,{key:2,class:"p-30-75"},{default:u((()=>[_(d,{class:"login_topbpx"},{default:u((()=>[_(d,{class:"login_tit"},{default:u((()=>[f("重置密码")])),_:1}),_(d,{class:"login_top"},{default:u((()=>[_(i,{class:"red",onClick:s[10]||(s[10]=e=>t.is_login=1)},{default:u((()=>[f("立即登录")])),_:1})])),_:1})])),_:1}),_(d,{class:"group-bd"},{default:u((()=>[_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",modelValue:t.resetpassword.mobile,"onUpdate:modelValue":s[11]||(s[11]=e=>t.resetpassword.mobile=e),placeholder:"请填写手机号",disabled:t.is_send},null,8,["modelValue","disabled"])])),_:1})])),_:1}),_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",password:"true",modelValue:t.resetpassword.password,"onUpdate:modelValue":s[12]||(s[12]=e=>t.resetpassword.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1}),_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 input_botom"},{default:u((()=>[_(y,{type:"text",password:"true",modelValue:t.resetpassword.repassword,"onUpdate:modelValue":s[13]||(s[13]=e=>t.resetpassword.repassword=e),placeholder:"请确认密码"},null,8,["modelValue"])])),_:1})])),_:1}),_(d,{class:"form-level d-s-c"},{default:u((()=>[_(d,{class:"val flex-1 d-b-c input_botom"},{default:u((()=>[_(y,{class:"flex-1",type:"number",modelValue:t.resetpassword.code,"onUpdate:modelValue":s[14]||(s[14]=e=>t.resetpassword.code=e),placeholder:"请填写验证码"},null,8,["modelValue"]),_(k,{class:"get-code-btn",type:"default",onClick:a.sendCode,disabled:t.is_send},{default:u((()=>[f(m(t.send_btn_txt),1)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})):g("",!0),1==t.is_login?(n(),r(d,{key:3,class:b(["gray6 p-0-75",t.is_code?"d-e-c":"d-b-c"])},{default:u((()=>[t.is_code?g("",!0):(n(),r(d,{key:0,onClick:s[15]||(s[15]=e=>t.is_login=0)},{default:u((()=>[f("忘记密码?")])),_:1})),t.sms_open?(n(),r(d,{key:1,onClick:s[16]||(s[16]=e=>a.isCode())},{default:u((()=>[f(m(t.is_code?"使用密码登录":"使用验证码登录"),1)])),_:1})):g("",!0)])),_:1},8,["class"])):g("",!0),2==t.is_login?(n(),r(d,{key:4,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(k,{type:"default",onClick:a.registerSub},{default:u((()=>[f("注册")])),_:1},8,["onClick"])])),_:1})):g("",!0),1==t.is_login?(n(),r(d,{key:5,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(k,{type:"default",onClick:a.formSubmit},{default:u((()=>[f("登录")])),_:1},8,["onClick"])])),_:1})):g("",!0),0==t.is_login?(n(),r(d,{key:6,style:{"padding-top":"80rpx"},class:"btns p-30-75"},{default:u((()=>[_(k,{type:"default",onClick:a.resetpasswordSub},{default:u((()=>[f("重置密码")])),_:1},8,["onClick"])])),_:1})):g("",!0)])),_:1},8,["style"])}],["__scopeId","data-v-fb242af8"]]);export{y as default};
