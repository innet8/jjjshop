import{_ as a,G as t,o as e,c as s,w as l,n as o,l as i,p as d,g as r,b as c,d as n,f as u,r as p,F as _,j as g,k as y,t as f,e as h,D as m,C as k,i as v,h as D}from"./index-1a637619.js";import{u as C}from"./uni-load-more.934e6c66.js";import{c as b}from"./cashier.070e7102.js";const T=a({components:{uniLoadMore:C,cashier:b},data:()=>({type:0,loading:!0,listData:[],last_page:0,page:1,list_rows:10,no_more:!1,order_id:0}),onShow(){this.page=1,this.listData=[],this.getData()},computed:{loadingType(){return this.loading?1:0!=this.listData.length&&this.no_more?2:0}},onReachBottom(){let a=this;a.page<a.last_page&&(a.page++,a.getData()),a.no_more=!0},methods:{changeType(a){this.loading||a==this.type||(this.type=a,this.listData=[],this.page=1,this.getData())},getData(){let a=this;a.loading=!0,a._get("plus.group.Order/lists",{page:a.page||1,list_rows:a.list_rows,dataType:a.type},(function(t){a.loading=!1,a.listData=a.listData.concat(t.data.list.data),a.last_page=t.data.list.last_page,t.data.list.last_page<=1&&(a.no_more=!0)}))},onPayOrder(a){let t="/pages/order/cashier?order_type=70&order_id="+a;this.gotoPage(t,"reLaunch")},cancellation(a){let e=this;t({title:"提示",content:"确定要取消订单吗？",success(s){s.confirm&&(i({title:"加载中..."}),e._post("plus.group.Order/cancel",{order_id:a},(a=>{t({title:"提示",content:a.msg}),e.listData=[],e.page=1,e.getData()}),!1,(a=>{d()})))}})}}},[["render",function(a,t,i,d,C,b){const T=r,w=v,j=D,x=g,P=y("uni-load-more");return e(),s(T,{"data-theme":a.theme(),class:o(a.theme()||"")},{default:l((()=>[c(T,{class:"top-nav mb20"},{default:l((()=>[c(T,{class:o(["top-nav-item",{active:0==C.type}]),onClick:t[0]||(t[0]=a=>b.changeType(0))},{default:l((()=>[n("全部")])),_:1},8,["class"]),c(T,{class:o(["top-nav-item",{active:1==C.type}]),onClick:t[1]||(t[1]=a=>b.changeType(1))},{default:l((()=>[n("待付款")])),_:1},8,["class"]),c(T,{class:o(["top-nav-item",{active:2==C.type}]),onClick:t[2]||(t[2]=a=>b.changeType(2))},{default:l((()=>[n("待使用")])),_:1},8,["class"]),c(T,{class:o(["top-nav-item",{active:3==C.type}]),onClick:t[3]||(t[3]=a=>b.changeType(3))},{default:l((()=>[n("退款")])),_:1},8,["class"])])),_:1}),c(T,{class:"order-list"},{default:l((()=>[(e(!0),u(_,null,p(C.listData,((t,o)=>(e(),s(T,{class:"order-item",key:o,onClick:e=>a.gotoPage("/pages/order/group/detail?order_id="+t.order_id)},{default:l((()=>[c(T,{class:"order-top pb30"},{default:l((()=>[c(T,{class:"d-b-c p-20-0"},{default:l((()=>[c(T,{class:"f28 gray3 fb text-ellipsis"},{default:l((()=>[n(f(t.product[0].group_name),1)])),_:2},1024),c(T,{class:"f24 gray9"},{default:l((()=>[n(f(t.state_text),1)])),_:2},1024)])),_:2},1024),c(T,{class:"d-b-s"},{default:l((()=>[c(w,{class:"product-image",src:t.product[0].image.file_path,mode:"aspectFill"},null,8,["src"]),c(T,{class:"f24 gray9 flex-1",style:{"line-height":"1.5"}},{default:l((()=>[c(T,null,{default:l((()=>[n("下单时间:"+f(t.create_time),1)])),_:2},1024),10==t.order_status.value&&20==t.pay_status.value?(e(),s(T,{key:0},{default:l((()=>[n("有效期至:"+f(t.end_time||""),1)])),_:2},1024)):h("",!0),c(T,null,{default:l((()=>[n("数量:1")])),_:1}),20==t.pay_status.value?(e(),s(T,{key:1},{default:l((()=>[n("实付:￥"+f(t.pay_price),1)])),_:2},1024)):h("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024),10!=t.order_status.value||10!=t.pay_status.value&&20!=t.pay_status.value?h("",!0):(e(),s(T,{key:0,class:"order-bts border-t"},{default:l((()=>[m("template",null,[10==t.order_status.value&&10==t.pay_status.value?(e(),s(j,{key:0,class:"default",type:"default",onClick:k((a=>b.cancellation(t.order_id)),["stop"])},{default:l((()=>[n(" 取消订单 ")])),_:2},1032,["onClick"])):h("",!0),10==t.order_status.value&&20==t.pay_status.value?(e(),s(j,{key:1,class:"default",type:"default",onClick:k((e=>a.gotoPage("/pages/order/group/qrcode?order_id="+t.order_id)),["stop"])},{default:l((()=>[n(" 查看券码 ")])),_:2},1032,["onClick"])):h("",!0),10==t.order_status.value&&10==t.pay_status.value?(e(),s(j,{key:2,class:"btn-red",onClick:k((a=>b.onPayOrder(t.order_id)),["stop"])},{default:l((()=>[n("去付款")])),_:2},1032,["onClick"])):h("",!0)])])),_:2},1024))])),_:2},1032,["onClick"])))),128)),0!=C.listData.length||C.loading?(e(),s(P,{key:1,loadingType:b.loadingType},null,8,["loadingType"])):(e(),s(T,{key:0,class:"d-c-c p30"},{default:l((()=>[c(x,{class:"iconfont icon-wushuju"}),c(x,{class:"cont"},{default:l((()=>[n("亲，暂无相关记录哦")])),_:1})])),_:1}))])),_:1})])),_:1},8,["data-theme","class"])}],["__scopeId","data-v-31e5ec5b"]]);export{T as default};
