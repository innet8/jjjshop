import{_ as e,m as a,l as s,y as o,s as t,z as i,p as n,o as l,c,w as r,g as d,b as u,d as g,i as _,h as f}from"./index-1a637619.js";const p=e({data:()=>({background:"",listData:[],invitation_id:0}),onShow(){},onLoad(e){this.invitation_id=a("invitation_id")||0},methods:{onNotLogin:function(){this.gotoPage("/pages/index/index")},getUserInfo:function(){let e=this;wx.getUserProfile({lang:"zh_CN",desc:"用于完善会员资料",success:l=>{if("getUserProfile:ok"!==l.errMsg)return!1;s({title:"正在登录",mask:!0}),o({success(s){e._post("user.user/login",{invitation_id:e.invitation_id,code:s.code,user_info:l.rawData,encrypted_data:encodeURIComponent(l.encryptedData),iv:encodeURIComponent(l.iv),signature:l.signature,referee_id:a("referee_id"),source:"wx"},(e=>{t("token",e.data.token),t("user_id",e.data.user_id),i()}),!1,(()=>{n()}))}})}})},onGetAuthorize(e){console.log("开始授权");let a=this;o({provider:"alipay",success:function(e){console.log("sucss"),console.log(e),uni.getUserInfo({provider:"alipay",success:function(s){a.aliPayLogin(e,s)}})},fail(e){console.log(e)}})},aliPayLogin(e,a){console.log(e),console.log(a),s({title:"登录中",mask:!0}),this._post("user.useralipay/login",{code:e.authCode,avatar:a.avatar,nickName:a.nickName},(e=>{t("token",e.data.token),t("user_id",e.data.user_id),i()}),!1,(()=>{n()}))}}},[["render",function(e,a,s,o,t,i){const n=_,p=d,h=f;return l(),c(p,{class:"login-container"},{default:r((()=>[u(p,{class:"wechatapp"},{default:r((()=>[u(n,{class:"m-0-a",style:{width:"190rpx",height:"190rpx"},src:"/h5/assets/logo-188ffa37.png"})])),_:1}),u(p,{class:"auth-title"},{default:r((()=>[g("申请获取以下权限")])),_:1}),u(p,{class:"auth-subtitle"},{default:r((()=>[g("获得你的公开信息（昵称、头像等）")])),_:1}),u(p,{class:"login-btn"}),u(p,{class:"no-login-btn"},{default:r((()=>[u(h,{class:"btn-normal",onClick:i.onNotLogin},{default:r((()=>[g("暂不登录")])),_:1},8,["onClick"])])),_:1})])),_:1})}],["__scopeId","data-v-7e3a42c3"]]);export{p as default};
